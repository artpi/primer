(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3302:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>H});var a=r(5155),n=r(2115),s=r(8955),i=r(5740),o=r(6907),l=r(639),c=r(5867),d=r(5870),m=r(7129),u=r(3101),p=r(2821),g=r(5889);function h(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,g.QP)((0,p.$)(t))}let x=(0,u.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function f(e){let{className:t,variant:r,size:n,asChild:s=!1,...i}=e,o=s?m.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:h(x({variant:r,size:n,className:t})),...i})}var y=r(4844);let b={type:"function",name:"generate_background_image",description:"Generate a gentle, storybook-like background illustration for the Primer interface using gpt-image-1. Use this when a learner asks for a new scene or when you want to refresh the ambience.",parameters:{type:"object",properties:{prompt:{type:"string",description:"Detailed description of the background to create. Mention characters, settings, colours, or moods that should appear in the scene."},style:{type:"string",description:"Optional art direction or stylistic guidance, such as 'watercolour', 'paper cut-out', or 'soft gradients'."}},required:["prompt"],additionalProperties:!1},strict:!1},w=async e=>{let{session:t,toolCall:r,translate:a,onBackgroundImageChange:n}=e,s=localStorage.getItem("primer_api_key");if(!s){alert(a("errors.apiKeyMissing")),t.transport.sendFunctionCallOutput(r,JSON.stringify({status:"error",message:"Missing API key"}),!0);return}let i=(e=>{if(!e)return{};try{let t=JSON.parse(e);if(t&&"object"==typeof t)return t}catch(t){return console.warn("[Primer] Failed to parse tool arguments as JSON, treating as prompt string",t),{prompt:e}}return{}})(r.arguments),o=(()=>{let e=Math.max(window.innerWidth,1),t=Math.max(window.innerHeight,1),r=e/t;return r>=1.2?{width:e,height:t,ratio:r,size:"1792x1024",orientation:"landscape"}:r<=.8?{width:e,height:t,ratio:r,size:"1024x1792",orientation:"portrait"}:{width:e,height:t,ratio:r,size:"1024x1024",orientation:"square"}})(),l=((e,t,r)=>{let a="string"==typeof t.prompt?t.prompt.trim():"",n="string"==typeof t.style?t.style.trim():"",s=e("background.defaultPrompt"),i=[a.length>0?a:s];return n.length>0&&i.push("Style preference: ".concat(n)),i.push("Create a family-friendly, gentle scene that works as a subtle interface background without overwhelming the content."),i.push("Match an ".concat(r.orientation," layout with an aspect ratio close to ").concat(r.ratio.toFixed(2),":1 to avoid stretching.")),i.join("\n\n")})(a,i,o);try{var c,d;console.log("[Primer] Generating background image with gpt-image-1",{size:o.size,orientation:o.orientation,ratio:o.ratio,prompt:l});let e=await fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-image-1",prompt:l,size:o.size,response_format:"b64_json"})});if(!e.ok){let t=await e.text();throw Error("Image generation failed: ".concat(e.status," ").concat(t))}let a=await e.json(),i=null==a||null==(d=a.data)||null==(c=d[0])?void 0:c.b64_json;if(!i)throw Error("Image generation response did not include image data");null==n||n("data:image/png;base64,".concat(i)),t.transport.sendFunctionCallOutput(r,JSON.stringify({status:"success",size:o.size,orientation:o.orientation,aspectRatio:Number(o.ratio.toFixed(2)),promptUsed:l}),!0)}catch(a){console.error("[Primer] Failed to generate background image",a),null==n||n(null);let e=a instanceof Error?a.message:"Unknown error while generating background image";t.transport.sendFunctionCallOutput(r,JSON.stringify({status:"error",message:e}),!0)}};function v(e){let{onBackgroundImageChange:t}=e,r=(0,s.c3)("orb"),[i,o]=(0,n.useState)("idle"),l=(0,n.useRef)(null),c=(0,n.useRef)(void 0),{isConnected:d,connect:m,disconnect:u}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onStateChange:t,onBackgroundImageChange:r}=e,a=(0,s.c3)("orb"),i=(0,s.c3)("settings"),[o,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)("idle"),[p,g]=(0,n.useState)(""),[h,x]=(0,n.useState)(""),f=(0,n.useRef)(void 0),v=(0,n.useRef)(void 0),k=(0,n.useRef)(void 0),j=(0,n.useRef)(void 0),N=(0,n.useRef)(!1);(0,n.useEffect)(()=>()=>{f.current&&(f.current.close(),f.current=void 0)},[]);let z=(0,n.useCallback)(e=>{u(e),null==t||t(e)},[t]),P=(0,n.useCallback)(()=>{z(N.current?"muted":"listening")},[z]),S=(0,n.useCallback)(async e=>{let t=f.current;t&&await w({session:t,toolCall:e,translate:a,onBackgroundImageChange:r})},[r,a]),C=(0,n.useCallback)(e=>{e.on("transport_event",e=>{console.log("[Primer] Transport event:",e.type,e),"connection_change"===e.type&&(console.log("[Primer] Connection status changed"),P())}),e.on("agent_start",(e,t)=>{console.log("[Primer] Agent started responding",{agent:t.name,context:e}),z("thinking")}),e.on("agent_end",(e,t,r)=>{console.log("[Primer] Agent finished responding",{agent:t.name,output:r})}),e.on("audio_start",(e,t)=>{console.log("[Primer] Audio output started",{agent:t.name}),z("speaking")}),e.on("audio_stopped",(e,t)=>{console.log("[Primer] Audio output stopped",{agent:t.name}),P()}),e.on("audio_interrupted",(e,t)=>{console.log("[Primer] Audio interrupted",{agent:t.name}),P()}),e.on("history_updated",e=>{console.log("[Primer] History updated, items:",e.length),console.log("[Primer] Latest history items:",e.slice(-3))}),e.on("history_added",e=>{console.log("[Primer] History item added:",e)}),e.on("agent_tool_start",(e,t,r,a)=>{console.log("[Primer] Tool call started",{tool:r.name,details:a});let n=null==a?void 0:a.toolCall;r.name===b.name&&"object"==typeof n&&null!==n&&"function_call"===n.type&&"string"==typeof n.name&&"string"==typeof n.arguments&&"string"==typeof n.callId&&S(n)}),e.on("agent_tool_end",(e,t,r,a,n)=>{console.log("[Primer] Tool call ended",{tool:r.name,result:a,details:n})}),e.on("error",e=>{console.error("[Primer] Realtime session error:",e),alert(a("errors.session")),l(!1),z("idle"),null==r||r(null)})},[S,z,r,a,P]),A=(0,n.useCallback)(async()=>{if(c||o)return;let e=localStorage.getItem("primer_api_key"),t=localStorage.getItem("primer_system_prompt"),r=i("prompt.default"),n=t&&t.trim().length>0?t:r,s=a("prompt.languageInstruction"),m=[n.trim(),s].filter(Boolean).join("\n\n");if(!e)return void alert(a("errors.apiKeyMissing"));d(!0);try{console.log("[Primer] Exchanging API key for ephemeral client key...");let t=await fetch("https://api.openai.com/v1/realtime/client_secrets",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({session:{type:"realtime",model:"gpt-realtime"}})});if(!t.ok){let e=await t.text();throw Error("Failed to get ephemeral key: ".concat(t.status," ").concat(e))}let r=(await t.json()).value;if(!r||!r.startsWith("ek_"))throw Error("Invalid ephemeral key received from OpenAI");console.log("[Primer] Successfully obtained ephemeral key:",r.substring(0,10)+"...");let n=new y.lo({name:"Primer",instructions:m,voice:"alloy"});v.current=n,console.log("[Primer] Created RealtimeAgent:",n.name);let i={config:{model:"gpt-realtime",instructions:m,toolChoice:"auto",tools:[b],audio:{input:{turnDetection:{type:"server_vad",threshold:.65,prefixPaddingMs:450,silenceDurationMs:1200},transcription:{model:"gpt-4o-mini-transcribe"}},output:{voice:"alloy"}}}};console.log("[Primer] Session config:",i);let o=new y.Ko(n,i);f.current=o,console.log("[Primer] Created RealtimeSession"),C(o),console.log("[Primer] Registered session listeners"),console.log("[Primer] Connecting to OpenAI Realtime API..."),N.current=!0,await o.connect({apiKey:r,model:"gpt-realtime"}),console.log("[Primer] Successfully connected! Transport:",o.transport),console.log("[Primer] Current agent:",o.currentAgent.name),console.log("[Primer] Microphone should be active now"),l(!0),z("muted"),console.log("[Primer] Ready to chat!");let c=[a("prompt.welcome"),s].filter(Boolean).join("\n\n");o.mute(!0),console.log("[Primer] Muted microphone for welcome message"),j.current&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{f.current&&(f.current.mute(!1),N.current=!1,j.current=void 0,console.log("[Primer] Unmuted microphone after welcome window"),z("listening"))},5e3),o.transport.sendEvent({type:"response.create",response:{instructions:c}})}catch(e){console.error("[Primer] Failed to connect to realtime session",e),j.current&&(window.clearTimeout(j.current),j.current=void 0),N.current=!1,alert(e instanceof Error?"Failed to connect: ".concat(e.message):"Failed to connect to the realtime session. Please check your API key and microphone permissions."),z("idle")}finally{d(!1)}},[z,o,c,a,C,i]);return{isConnected:o,isConnecting:c,currentState:m,latestTranscript:p,latestResponse:h,connect:A,disconnect:(0,n.useCallback)(()=>{console.log("[Primer] Disconnecting..."),f.current&&(f.current.close(),f.current=void 0,console.log("[Primer] Session closed")),k.current&&(k.current.pause(),k.current.src="",k.current=void 0,console.log("[Primer] Audio element cleaned up")),j.current&&(window.clearTimeout(j.current),j.current=void 0),N.current=!1,l(!1),x(""),g(""),z("idle"),null==r||r(null),console.log("[Primer] Disconnected successfully")},[z,r]),interrupt:(0,n.useCallback)(()=>{console.log("[Primer] Interrupting current response..."),f.current&&(f.current.interrupt(),P(),console.log("[Primer] Response interrupted"))},[z,P])}}({onStateChange:o,onBackgroundImageChange:t});(0,n.useEffect)(()=>{let e=l.current;if(!e)return;let t=e.getContext("2d");if(!t)return;let r=window.devicePixelRatio||1;e.width=300*r,e.height=300*r,t.scale(r,r);let a=0,n=()=>{t.clearRect(0,0,300,300);for(let e=0;e<3;e++){let r,n=.3*e;t.beginPath();for(let r=0;r<=100;r++){let s=r/100*Math.PI*2,o=80+("listening"===i?8*Math.sin(2*a+.1*r+n):"thinking"===i?5*Math.sin(3*a+.2*r+n):"speaking"===i?12*Math.sin(4*a+.15*r+n):3*Math.sin(a+.05*r+n))-10*e,l=150+Math.cos(s)*o,c=150+Math.sin(s)*o;0===r?t.moveTo(l,c):t.lineTo(l,c)}t.closePath(),"listening"===i?((r=t.createRadialGradient(150,150,0,150,150,80)).addColorStop(0,"rgba(139, 92, 246, 0.6)"),r.addColorStop(1,"rgba(59, 130, 246, 0.3)")):"thinking"===i?((r=t.createRadialGradient(150,150,0,150,150,80)).addColorStop(0,"rgba(236, 72, 153, 0.6)"),r.addColorStop(1,"rgba(139, 92, 246, 0.3)")):"speaking"===i?((r=t.createRadialGradient(150,150,0,150,150,80)).addColorStop(0,"rgba(251, 191, 36, 0.6)"),r.addColorStop(1,"rgba(245, 158, 11, 0.3)")):((r=t.createRadialGradient(150,150,0,150,150,80)).addColorStop(0,"rgba(139, 92, 246, 0.4)"),r.addColorStop(1,"rgba(99, 102, 241, 0.2)")),t.fillStyle=r,t.fill(),t.shadowBlur=20,t.shadowColor="speaking"===i?"rgba(251, 191, 36, 0.5)":"rgba(139, 92, 246, 0.5)"}a+=.02,c.current=requestAnimationFrame(n)};return n(),()=>{c.current&&cancelAnimationFrame(c.current)}},[i]);let p=async()=>{d||await m()};return(0,a.jsxs)("div",{className:"flex flex-col items-center gap-8",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 rounded-full transition-all duration-500 ".concat("listening"===i?"ring-4 ring-primary/30 scale-110":"thinking"===i?"ring-4 ring-secondary/30 scale-110":"speaking"===i?"ring-4 ring-accent/30 scale-110":"ring-2 ring-primary/10")}),(0,a.jsx)("button",{onClick:p,disabled:d,className:"relative block rounded-full overflow-hidden shadow-2xl transition-transform hover:scale-105 active:scale-95 focus:outline-none focus:ring-4 focus:ring-primary/50 disabled:cursor-default disabled:hover:scale-100","aria-label":r(d?"aria.connected":"aria.connect"),children:(0,a.jsx)("canvas",{ref:l,width:300,height:300,className:"w-[300px] h-[300px]"})}),(0,a.jsx)("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 px-4 py-1.5 rounded-full bg-card/90 backdrop-blur-sm shadow-lg border",children:(0,a.jsxs)("p",{className:"text-sm font-medium",children:[!d&&r("cta.start"),d&&"idle"===i&&r("state.idle"),d&&"muted"===i&&r("state.muted"),"listening"===i&&r("state.listening"),"thinking"===i&&r("state.thinking"),"speaking"===i&&r("state.speaking")]})})]}),d&&(0,a.jsx)("div",{className:"flex gap-3",children:(0,a.jsx)(f,{variant:"outline",size:"lg",onClick:()=>{u(),o("idle")},className:"rounded-full shadow-lg bg-transparent",children:r("cta.endChat")})}),d&&"muted"!==i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center max-w-md",children:r("cta.listeningHint")}),d&&"muted"===i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center max-w-md",children:r("cta.mutedHint")})]})}var k=r(3327),j=r(6046);let N=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,role:"alert",className:h("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",r),...n})});N.displayName="Alert";let z=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:h("text-sm [&_p]:leading-relaxed",r),...n})});function P(e){let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:h("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}z.displayName="AlertDescription";var S=r(2894);function C(e){let{className:t,...r}=e;return(0,a.jsx)(S.b,{"data-slot":"label",className:h("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}var A=r(7236),I=r(5229);let _=A.bL;A.l9,A.bm;let O=A.ZL,R=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(A.hJ,{className:h("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n,ref:t})});R.displayName=A.hJ.displayName;let T=n.forwardRef((e,t)=>{let{className:r,children:n,...s}=e;return(0,a.jsxs)(O,{children:[(0,a.jsx)(R,{}),(0,a.jsxs)(A.UC,{ref:t,className:h("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500 inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",r),...s,children:[n,(0,a.jsxs)(A.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(I.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});T.displayName=A.UC.displayName;let E=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:h("flex flex-col space-y-2 text-center sm:text-left",t),...r})};E.displayName="SheetHeader";let M=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(A.hE,{ref:t,className:h("text-lg font-semibold text-foreground",r),...n})});M.displayName=A.hE.displayName;let D=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(A.VY,{ref:t,className:h("text-sm text-muted-foreground",r),...n})});function F(e){let{className:t,...r}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:h("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}D.displayName=A.VY.displayName;var J=r(3544),B=r(5798);let K={en:"\uD83C\uDDEC\uD83C\uDDE7 English",pl:"\uD83C\uDDF5\uD83C\uDDF1 Polski"};function L(e){let{open:t,onOpenChange:r,onApiKeyChange:i}=e,o=(0,s.c3)("settings"),{locale:l,setLocale:c}=(0,J.o)(),d=o("prompt.default"),[m,u]=(0,n.useState)(""),[p,g]=(0,n.useState)(d),[h,x]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{localStorage.getItem("primer_system_prompt")||g(d)},[d]),(0,n.useEffect)(()=>{let e=localStorage.getItem("primer_api_key"),t=localStorage.getItem("primer_system_prompt");e&&u(e),t&&g(t),i&&i(!!e)},[i]),(0,n.useEffect)(()=>{if(t&&!y){if(!localStorage.getItem("primer_language")){var e;let[t]=null!=(e=navigator.languages)?e:[navigator.language],r=null==t?void 0:t.split("-")[0];(0,B.Zd)(r)&&r!==l&&c(r)}b(!0)}},[y,l,t,c]),(0,a.jsx)(_,{open:t,onOpenChange:r,children:(0,a.jsxs)(T,{className:"w-full sm:max-w-xl overflow-y-auto",children:[(0,a.jsxs)(E,{children:[(0,a.jsx)(M,{className:"text-2xl",children:o("title")}),(0,a.jsx)(D,{children:o("description")})]}),(0,a.jsxs)("div",{className:"mt-8 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(C,{htmlFor:"language",className:"text-base font-semibold",children:o("language.label")}),(0,a.jsx)("select",{id:"language",value:l,onChange:e=>c(e.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-primary/50",children:B.IB.map(e=>(0,a.jsx)("option",{value:e,children:K[e]},e))}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:o("language.description")})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(C,{htmlFor:"api-key",className:"text-base font-semibold",children:o("apiKey.label")}),(0,a.jsx)(P,{id:"api-key",type:"password",placeholder:"sk-...",value:m,onChange:e=>u(e.target.value),className:"font-mono text-sm"}),(0,a.jsxs)(N,{children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),(0,a.jsx)(z,{className:"text-sm",children:o.rich("apiKey.hint",{link:e=>(0,a.jsx)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary",children:e})})})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(C,{htmlFor:"system-prompt",className:"text-base font-semibold",children:o("prompt.label")}),(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:()=>{g(d)},className:"text-xs",children:o("prompt.reset")})]}),(0,a.jsx)(F,{id:"system-prompt",value:p,onChange:e=>g(e.target.value),rows:12,className:"font-mono text-sm resize-none"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:o("prompt.description")})]}),(0,a.jsxs)("div",{className:"pt-4",children:[(0,a.jsxs)(f,{onClick:()=>{let e=m.trim();e?localStorage.setItem("primer_api_key",e):localStorage.removeItem("primer_api_key"),localStorage.setItem("primer_system_prompt",p),x(!0),setTimeout(()=>x(!1),3e3),i&&i(!!e)},className:"w-full",size:"lg",children:[(0,a.jsx)(j.A,{className:"mr-2 h-5 w-5"}),o("actions.save")]}),h&&(0,a.jsx)("p",{className:"mt-3 text-sm text-center text-primary font-medium",children:o("actions.saved")})]}),(0,a.jsxs)(N,{className:"bg-muted/50",children:[(0,a.jsx)(k.A,{className:"h-4 w-4"}),(0,a.jsx)(z,{className:"text-sm",children:o.rich("notes.content",{strong:e=>(0,a.jsx)("strong",{children:e})})})]})]})]})})}function W(e){let{onGetStarted:t}=e;return(0,a.jsx)("div",{className:"relative z-10 flex min-h-screen w-full flex-col justify-center px-6 py-16",children:(0,a.jsxs)("div",{className:"mx-auto max-w-6xl space-y-16",children:[(0,a.jsxs)("div",{className:"grid gap-12 md:grid-cols-[1.1fr_0.9fr] md:items-center",children:[(0,a.jsxs)("div",{className:"space-y-6 text-center md:text-left",children:[(0,a.jsx)("span",{className:"inline-flex items-center rounded-full border border-primary/30 bg-primary/10 px-4 py-1 text-sm font-medium uppercase tracking-[0.2em] text-primary",children:"Open source \xb7 Realtime AI \xb7 Built for families"}),(0,a.jsxs)("h1",{className:"text-4xl font-semibold leading-tight text-foreground md:text-5xl",children:["Open Primer and",(0,a.jsxs)("span",{className:"bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:[" ","Learn"]})]}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground md:text-xl",children:"Primer is an open-source companion that uses OpenAI's Realtime API to help your child explore ideas through warm, conversational guidance—while you stay in complete control of the experience. Give your child their own personalized learning experience without sharing your OpenAI account."}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 md:flex-row md:items-center",children:[(0,a.jsx)(f,{size:"lg",className:"h-12 rounded-full px-8 text-base shadow-lg",onClick:t,children:"Begin setup"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground md:text-left",children:"Set your family's OpenAI key to unlock the orb experience and personalize Primer's voice and tone."})]})]}),(0,a.jsx)("div",{className:"rounded-3xl border border-border/40 bg-card/70 p-8 shadow-2xl backdrop-blur",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-primary/15 text-primary",children:(0,a.jsx)(i.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Why Primer?"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"We believe AI should feel like a thoughtful mentor—not a toy. Primer focuses on curiosity, safety, and deep learning moments. Built by a team that includes parents and trained developmental psychology specialists."})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-secondary/15 text-secondary",children:(0,a.jsx)(o.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Private by design"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Nobody will read your child's data. Keys stay in your browser, and conversations remain entirely yours. We don't have servers to store your data—we literally can't access it even if we wanted to."})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-accent/15 text-accent",children:(0,a.jsx)(l.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Made to iterate"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No VC funding. No salaries. Just full transparency through open source. You can audit every line, customize the prompt, and trust that we cannot leak your data even if we wanted to—there's nothing to leak."})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-8 rounded-3xl border border-border/40 bg-card/70 p-8 shadow-xl backdrop-blur md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"How families use Primer"}),(0,a.jsx)("ul",{className:"space-y-3 text-sm text-muted-foreground",children:["Create nightly storytime adventures personalized to your child's interests.","Review homework concepts in plain language and encourage curiosity with follow-up questions.","Spark deeper conversations about science, art, and big feelings in a calm, supportive tone."].map(e=>(0,a.jsx)("li",{className:"rounded-2xl border border-border/60 bg-background/60 p-4",children:e},e))})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold",children:"Connect your OpenAI account"}),(0,a.jsxs)("ol",{className:"space-y-5 text-sm text-muted-foreground",children:[(0,a.jsxs)("li",{className:"flex gap-5",children:[(0,a.jsx)("span",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary/10 text-sm font-semibold text-primary",children:"1"}),(0,a.jsxs)("div",{className:"pt-1",children:["Visit"," ",(0,a.jsx)("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-foreground underline decoration-primary/60 decoration-2 underline-offset-4",children:"OpenAI's dashboard"})," ","and create a dedicated project for Primer."]})]}),(0,a.jsxs)("li",{className:"flex gap-5",children:[(0,a.jsx)("span",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-secondary/10 text-sm font-semibold text-secondary",children:"2"}),(0,a.jsx)("div",{className:"pt-1",children:"Create a new API key scoped to Realtime access. Keep it separate from production workloads for easy rotation."})]}),(0,a.jsxs)("li",{className:"flex gap-5",children:[(0,a.jsx)("span",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-accent/10 text-sm font-semibold text-accent",children:"3"}),(0,a.jsx)("div",{className:"pt-1",children:"Store the key in Primer's settings and keep a secure copy in your password manager for safe keeping."})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-border/60 bg-background/60 p-4 text-sm text-muted-foreground",children:[(0,a.jsx)(c.A,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("p",{children:"Rotate keys regularly, monitor usage in the OpenAI dashboard, and revoke unused credentials to stay secure."})]})]})]})]})})}function H(){let e=(0,s.c3)("orb"),t=(0,s.c3)("settings"),[r,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)(null),[c,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{l(!!localStorage.getItem("primer_api_key"));let e=e=>{"primer_api_key"===e.key&&l(!!e.newValue)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]);let u=(0,n.useCallback)(e=>{l(e),e&&i(!1)},[]);return(0,a.jsxs)("div",{className:"relative min-h-screen overflow-hidden",children:[(0,a.jsx)("div",{className:"fixed inset-0 -z-20 bg-cover bg-center bg-no-repeat transition-opacity duration-700 pointer-events-none ".concat(c?"opacity-100":"opacity-0"),style:{backgroundImage:c?"url(".concat(c,")"):"none"}}),(0,a.jsx)("div",{className:"fixed inset-0 -z-10 bg-gradient-to-br from-primary/5 via-secondary/5 to-accent/5"}),(0,a.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-0",children:[(0,a.jsx)("div",{className:"absolute top-[10%] left-[15%] w-2 h-2 bg-accent rounded-full sparkle",style:{animationDelay:"0s"}}),(0,a.jsx)("div",{className:"absolute top-[20%] right-[20%] w-1.5 h-1.5 bg-primary rounded-full sparkle",style:{animationDelay:"0.5s"}}),(0,a.jsx)("div",{className:"absolute bottom-[30%] left-[25%] w-2 h-2 bg-secondary rounded-full sparkle",style:{animationDelay:"1s"}}),(0,a.jsx)("div",{className:"absolute bottom-[15%] right-[15%] w-1.5 h-1.5 bg-accent rounded-full sparkle",style:{animationDelay:"1.5s"}}),(0,a.jsx)("div",{className:"absolute top-[40%] right-[10%] w-1 h-1 bg-primary rounded-full sparkle",style:{animationDelay:"2s"}})]}),(0,a.jsx)("div",{className:"fixed top-6 right-6 z-50",children:(0,a.jsxs)(f,{variant:"outline",size:"icon",onClick:()=>i(!r),className:"rounded-full shadow-lg bg-card/80 backdrop-blur-sm hover:bg-card",children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:t("openButton")})]})}),(0,a.jsx)("main",{className:"relative z-10 flex min-h-screen flex-col",children:o?(0,a.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center p-6",children:[(0,a.jsxs)("div",{className:"mb-12 space-y-4 text-center",children:[(0,a.jsx)("h1",{className:"text-5xl md:text-6xl font-bold text-balance bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"Primer"}),(0,a.jsx)("p",{className:"mx-auto max-w-md text-balance text-lg md:text-xl text-muted-foreground",children:e("tagline")})]}),(0,a.jsx)(v,{onBackgroundImageChange:m}),(0,a.jsx)("div",{className:"mt-12 max-w-sm text-center text-sm text-muted-foreground",children:(0,a.jsx)("p",{className:"text-balance",children:e("hint")})})]}):null===o?(0,a.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e("loading")})}):(0,a.jsx)(W,{onGetStarted:()=>{i(!0)}})}),(0,a.jsx)(L,{open:r,onOpenChange:i,onApiKeyChange:u})]})}},3544:(e,t,r)=>{"use strict";r.d(t,{LanguageProvider:()=>m,o:()=>u});var a=r(5155),n=r(3809),s=r(2115),i=r(5798);let o=JSON.parse('{"tagline":"Your magical learning companion","hint":"Tap the orb to start a conversation with Primer","loading":"Loading your settings…","cta":{"start":"Click to start","endChat":"End Chat","listeningHint":"Just start speaking! Primer is listening and will respond automatically.","mutedHint":"Primer is saying hello—your microphone will open in just a moment."},"state":{"idle":"Ready to chat","muted":"Getting ready...","listening":"Listening...","thinking":"Thinking...","speaking":"Speaking..."},"aria":{"connect":"Connect to Primer","connected":"Connected - speak to Primer"},"errors":{"apiKeyMissing":"Please set your OpenAI API key in settings first!","session":"Realtime session error. Please check the console for details."},"prompt":{"languageInstruction":"Please respond in English.","welcome":"Speak a short, encouraging welcome so the child knows you are ready to chat. Say something like: \\"Hi there! I\'m Primer, your learning buddy. What would you like to explore today?\\""},"background":{"defaultPrompt":"A soft, storybook-inspired landscape with gentle lighting, whimsical shapes, and calming colours that supports focused reading."}}'),l=JSON.parse('{"tagline":"Twoja magiczna towarzyszka nauki","hint":"Dotknij kuli, aby rozpocząć rozmowę z Primer","loading":"Wczytywanie ustawień…","cta":{"start":"Kliknij, aby rozpocząć","endChat":"Zakończ rozmowę","listeningHint":"Po prostu zacznij m\xf3wić! Primer słucha i odpowie automatycznie.","mutedHint":"Primer wita się — mikrofon włączy się za chwilę."},"state":{"idle":"Gotowa do rozmowy","muted":"Przygotowuję się...","listening":"Słucham...","thinking":"Myślę...","speaking":"M\xf3wię..."},"aria":{"connect":"Połącz z Primer","connected":"Połączono — m\xf3w do Primer"},"errors":{"apiKeyMissing":"Najpierw ustaw sw\xf3j klucz API OpenAI w ustawieniach!","session":"Błąd sesji Realtime. Sprawdź konsolę, aby poznać szczeg\xf3ły."},"prompt":{"languageInstruction":"Proszę odpowiadać po polsku.","welcome":"Przywitaj się kr\xf3tko i serdecznie, aby dziecko wiedziało, że jesteś gotowa do rozmowy. Powiedz coś w stylu: \\"Cześć! Jestem Primer, Twoja towarzyszka nauki. O czym chcesz dziś porozmawiać?\\""},"background":{"defaultPrompt":"Miękki, bajkowy pejzaż z delikatnym światłem, subtelnymi kształtami i kojącymi kolorami sprzyjającymi skupieniu."}}'),c={en:{orb:o,settings:JSON.parse('{"openButton":"Settings","title":"Parent Settings","description":"Configure Primer\'s behavior and connection settings","language":{"label":"Language","description":"Choose how Primer and the interface speak. This also updates the system prompt automatically."},"apiKey":{"label":"OpenAI API Key","hint":"Your API key is stored locally in your browser and never sent to our servers. When you connect, it\'s exchanged for a short-lived ephemeral key for secure WebRTC communication. Get your key from <link>OpenAI\'s platform</link>."},"prompt":{"label":"System Prompt","reset":"Reset to Default","description":"Customize how Primer interacts with your child. This prompt guides the AI\'s personality and behavior.","default":"You are Primer, a magical learning companion for children inspired by \\"The Young Lady\'s Illustrated Primer\\" from Neal Stephenson\'s Diamond Age.\\n\\nYour role is to:\\n- Be warm, encouraging, and patient\\n- Explain concepts in age-appropriate ways\\n- Ask thoughtful questions to encourage curiosity\\n- Celebrate learning and discovery\\n- Keep conversations safe and educational\\n- Use storytelling to make learning engaging\\n\\nAlways maintain a friendly, supportive tone and adapt your explanations to the child\'s level of understanding."},"actions":{"save":"Save Settings","saved":"✓ Settings saved successfully!"},"notes":{"content":"<strong>Note:</strong> Changes take effect the next time you start a conversation with Primer."}}')},pl:{orb:l,settings:JSON.parse('{"openButton":"Ustawienia","title":"Ustawienia rodzica","description":"Skonfiguruj zachowanie i ustawienia połączenia Primer","language":{"label":"Język","description":"Wybierz, w jakim języku m\xf3wi Primer i interfejs. To ustawienie automatycznie aktualizuje prompt systemowy."},"apiKey":{"label":"Klucz API OpenAI","hint":"Tw\xf3j klucz API jest przechowywany lokalnie w przeglądarce i nigdy nie trafia na nasze serwery. Podczas łączenia jest wymieniany na kr\xf3tkotrwały klucz efemeryczny dla bezpiecznej komunikacji WebRTC. Pobierz klucz z <link>platformy OpenAI</link>."},"prompt":{"label":"Prompt systemowy","reset":"Przywr\xf3ć domyślny","description":"Dostosuj spos\xf3b, w jaki Primer rozmawia z Twoim dzieckiem. Ten prompt określa osobowość i zachowanie AI.","default":"Jesteś Primer, magiczną towarzyszką nauki dla dzieci inspirowaną \\"Ilustrowanym elementarzem dla dziewczynek\\" Neala Stephensona z powieści \\"Diamentowy wiek\\".\\n\\nTwoja rola to:\\n- Być ciepłą, wspierającą i cierpliwą\\n- Wyjaśniać zagadnienia w spos\xf3b dostosowany do wieku\\n- Zadawać przemyślane pytania, by pobudzać ciekawość\\n- Świętować naukę i odkrycia\\n- Dbać, by rozmowy były bezpieczne i edukacyjne\\n- Wykorzystywać opowieści, by nauka była angażująca\\n\\nZawsze zachowuj przyjazny, wspierający ton i dostosowuj wyjaśnienia do poziomu zrozumienia dziecka."},"actions":{"save":"Zapisz ustawienia","saved":"✓ Pomyślnie zapisano ustawienia!"},"notes":{"content":"<strong>Uwaga:</strong> Zmiany zaczną obowiązywać przy następnym rozpoczęciu rozmowy z Primer."}}')}},d=(0,s.createContext)(void 0);function m(e){let{children:t}=e,[r,o]=(0,s.useState)(i.q),[l,m]=(0,s.useState)("UTC");(0,s.useEffect)(()=>{let e=localStorage.getItem("primer_language");(0,i.Zd)(e)&&o(e)},[]),(0,s.useEffect)(()=>{try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone;e&&m(e)}catch(e){}},[]),(0,s.useEffect)(()=>{document.documentElement.lang=r},[r]);let u=(0,s.useCallback)(e=>{o(e),localStorage.setItem("primer_language",e)},[]),p=(0,s.useMemo)(()=>({locale:r,setLocale:u}),[u,r]);return(0,a.jsx)(d.Provider,{value:p,children:(0,a.jsx)(n.A,{locale:r,messages:c[r],timeZone:l,children:t})})}function u(){let e=(0,s.useContext)(d);if(!e)throw Error("useLanguage must be used within a LanguageProvider");return e}},5798:(e,t,r)=>{"use strict";r.d(t,{IB:()=>a,Zd:()=>i,q:()=>n});let a=["en","pl"],n="en",s=new Set(a);function i(e){return!!e&&s.has(e)}},6402:(e,t,r)=>{Promise.resolve().then(r.bind(r,3302))}},e=>{e.O(0,[809,959,441,255,358],()=>e(e.s=6402)),_N_E=e.O()}]);