(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[343],{1847:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(2115);let a=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:u="",children:d,iconNode:c,...p}=e;return(0,r.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:n,strokeWidth:l?24*Number(o)/Number(i):o,className:a("lucide",u),...p},[...c.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let n=(0,r.forwardRef)((n,s)=>{let{className:o,...l}=n;return(0,r.createElement)(i,{ref:s,iconNode:t,className:a("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...l})});return n.displayName="".concat(e),n}},2821:(e,t,n)=>{"use strict";function r(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=function e(t){var n,r,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(n=0;n<s;n++)t[n]&&(r=e(t[n]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}(e))&&(r&&(r+=" "),r+=t);return r}n.d(t,{$:()=>r})},2894:(e,t,n)=>{"use strict";n.d(t,{b:()=>l});var r=n(2115);n(7650);var a=n(7129),s=n(5155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let n=r.forwardRef((e,n)=>{let{asChild:r,...i}=e,o=r?a.DX:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(o,{...i,ref:n})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),o=r.forwardRef((e,t)=>(0,s.jsx)(i.label,{...e,ref:t,onMouseDown:t=>{var n;t.target.closest("button, input, select, textarea")||(null==(n=e.onMouseDown)||n.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var l=o},3101:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var r=n(2821);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=r.$,i=(e,t)=>n=>{var r;if((null==t?void 0:t.variants)==null)return s(e,null==n?void 0:n.class,null==n?void 0:n.className);let{variants:i,defaultVariants:o}=t,l=Object.keys(i).map(e=>{let t=null==n?void 0:n[e],r=null==o?void 0:o[e];if(null===t)return null;let s=a(t)||a(r);return i[e][s]}),u=n&&Object.entries(n).reduce((e,t)=>{let[n,r]=t;return void 0===r||(e[n]=r),e},{});return s(e,l,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:n,className:r,...a}=t;return Object.entries(a).every(e=>{let[t,n]=e;return Array.isArray(n)?n.includes({...o,...u}[t]):({...o,...u})[t]===n})?[...e,n,r]:e},[]),null==n?void 0:n.class,null==n?void 0:n.className)}},3327:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(1847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},4844:(e,t,n)=>{"use strict";let r,a,s,i,o;n.d(t,{lo:()=>r5,Ko:()=>so});let l={version:"0.1.10"};async function u(e){try{return[null,await e()]}catch(e){return[e,null]}}class d extends Error{}class c extends d{constructor(e,t,n,r){super(`${c.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.requestID=r?.get("x-request-id"),this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,n){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new p({message:n,cause:(e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)})(t)});let a=t?.error;return 400===e?new m(e,a,n,r):401===e?new h(e,a,n,r):403===e?new f(e,a,n,r):404===e?new g(e,a,n,r):409===e?new y(e,a,n,r):422===e?new _(e,a,n,r):429===e?new v(e,a,n,r):e>=500?new b(e,a,n,r):new c(e,a,n,r)}}class p extends c{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class m extends c{}class h extends c{}class f extends c{}class g extends c{}class y extends c{}class _ extends c{}class v extends c{}class b extends c{}let w=Symbol("Let zodToJsonSchema decide on which parser to use"),x={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},S=e=>"_def"in e?e._def:e;!function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let n of e)t[n]=n;return t},e.getValidEnumValues=t=>{let n=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),r={};for(let e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(let n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(tb||(tb={})),(tw||(tw={})).mergeShapes=(e,t)=>({...e,...t});let I=tb.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),k=e=>{switch(typeof e){case"undefined":return I.undefined;case"string":return I.string;case"number":return Number.isNaN(e)?I.nan:I.number;case"boolean":return I.boolean;case"function":return I.function;case"bigint":return I.bigint;case"symbol":return I.symbol;case"object":if(Array.isArray(e))return I.array;if(null===e)return I.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return I.promise;if("undefined"!=typeof Map&&e instanceof Map)return I.map;if("undefined"!=typeof Set&&e instanceof Set)return I.set;if("undefined"!=typeof Date&&e instanceof Date)return I.date;return I.object;default:return I.unknown}},A=tb.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class T extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(let a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(r);else if("invalid_return_type"===a.code)r(a.returnTypeError);else if("invalid_arguments"===a.code)r(a.argumentsError);else if(0===a.path.length)n._errors.push(t(a));else{let e=n,r=0;for(;r<a.path.length;){let n=a.path[r];r===a.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(a))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof T))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,tb.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},n=[];for(let r of this.issues)if(r.path.length>0){let n=r.path[0];t[n]=t[n]||[],t[n].push(e(r))}else n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}T.create=e=>new T(e);let C=(e,t)=>{let n;switch(e.code){case A.invalid_type:n=e.received===I.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case A.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,tb.jsonStringifyReplacer)}`;break;case A.unrecognized_keys:n=`Unrecognized key(s) in object: ${tb.joinValues(e.keys,", ")}`;break;case A.invalid_union:n="Invalid input";break;case A.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${tb.joinValues(e.options)}`;break;case A.invalid_enum_value:n=`Invalid enum value. Expected ${tb.joinValues(e.options)}, received '${e.received}'`;break;case A.invalid_arguments:n="Invalid function arguments";break;case A.invalid_return_type:n="Invalid function return type";break;case A.invalid_date:n="Invalid date";break;case A.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:tb.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case A.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case A.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case A.custom:n="Invalid input";break;case A.invalid_intersection_types:n="Intersection results could not be merged";break;case A.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case A.not_finite:n="Number must be finite";break;default:n=t.defaultError,tb.assertNever(e)}return{message:n}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(tx||(tx={}));let E=e=>{let{data:t,path:n,errorMaps:r,issueData:a}=e,s=[...n,...a.path||[]],i={...a,path:s};if(void 0!==a.message)return{...a,path:s,message:a.message};let o="";for(let e of r.filter(e=>!!e).slice().reverse())o=e(i,{data:t,defaultError:o}).message;return{...a,path:s,message:o}};function O(e,t){let n=E({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,C,void 0].filter(e=>!!e)});e.common.issues.push(n)}class N{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let r of t){if("aborted"===r.status)return R;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let e of t){let t=await e.key,r=await e.value;n.push({key:t,value:r})}return N.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let r of t){let{key:t,value:a}=r;if("aborted"===t.status||"aborted"===a.status)return R;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==a.value||r.alwaysSet)&&(n[t.value]=a.value)}return{status:e.value,value:n}}}let R=Object.freeze({status:"aborted"}),P=e=>({status:"dirty",value:e}),j=e=>({status:"valid",value:e}),M=e=>"undefined"!=typeof Promise&&e instanceof Promise;class D{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let $=(e,t)=>{if("valid"===t.status)return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new T(e.common.issues);return this._error=t,this._error}}};function F(e){if(!e)return{};let{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:a}:{errorMap:(t,a)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??a.defaultError}:void 0===a.data?{message:s??r??a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:s??n??a.defaultError}},description:a}}class L{get description(){return this._def.description}_getType(e){return k(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:k(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new N,ctx:{common:e.parent.common,data:e.data,parsedType:k(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(M(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){let n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:k(e)},r=this._parseSync({data:e,path:n.path,parent:n});return $(n,r)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:k(e)};if(!this["~standard"].async)try{let n=this._parseSync({data:e,path:[],parent:t});return"valid"===n.status?{value:n.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>"valid"===e.status?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:k(e)},r=this._parse({data:e,path:n.path,parent:n});return $(n,await (M(r)?r:Promise.resolve(r)))}refine(e,t){return this._refinement((n,r)=>{let a=e(n),s=()=>r.addIssue({code:A.custom,..."string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(n):t});return"undefined"!=typeof Promise&&a instanceof Promise?a.then(e=>!!e||(s(),!1)):!!a||(s(),!1)})}refinement(e,t){return this._refinement((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1))}_refinement(e){return new eR({schema:this,typeName:tS.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return eP.create(this,this._def)}nullable(){return ej.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ef.create(this)}promise(){return eN.create(this,this._def)}or(e){return ey.create([this,e],this._def)}and(e){return eb.create(this,e,this._def)}transform(e){return new eR({...F(this._def),schema:this,typeName:tS.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new eM({...F(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:tS.ZodDefault})}brand(){return new eF({typeName:tS.ZodBranded,type:this,...F(this._def)})}catch(e){return new eD({...F(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:tS.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return eL.create(this,e)}readonly(){return eZ.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let Z=/^c[^\s-]{8,}$/i,z=/^[0-9a-z]+$/,U=/^[0-9A-HJKMNP-TV-Z]{26}$/i,J=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,W=/^[a-z0-9_-]{21}$/i,q=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,G=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,B=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,K=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,V=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,H=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Y=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,X=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Q=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ee="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",et=RegExp(`^${ee}$`);function en(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}class er extends L{_parse(e){var t,n,a,s;let i;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==I.string){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.string,received:t.parsedType}),R}let o=new N;for(let l of this._def.checks)if("min"===l.kind)e.data.length<l.value&&(O(i=this._getOrReturnCtx(e,i),{code:A.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("max"===l.kind)e.data.length>l.value&&(O(i=this._getOrReturnCtx(e,i),{code:A.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),o.dirty());else if("length"===l.kind){let t=e.data.length>l.value,n=e.data.length<l.value;(t||n)&&(i=this._getOrReturnCtx(e,i),t?O(i,{code:A.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):n&&O(i,{code:A.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),o.dirty())}else if("email"===l.kind)B.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"email",code:A.invalid_string,message:l.message}),o.dirty());else if("emoji"===l.kind)r||(r=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),r.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"emoji",code:A.invalid_string,message:l.message}),o.dirty());else if("uuid"===l.kind)J.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"uuid",code:A.invalid_string,message:l.message}),o.dirty());else if("nanoid"===l.kind)W.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"nanoid",code:A.invalid_string,message:l.message}),o.dirty());else if("cuid"===l.kind)Z.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"cuid",code:A.invalid_string,message:l.message}),o.dirty());else if("cuid2"===l.kind)z.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"cuid2",code:A.invalid_string,message:l.message}),o.dirty());else if("ulid"===l.kind)U.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"ulid",code:A.invalid_string,message:l.message}),o.dirty());else if("url"===l.kind)try{new URL(e.data)}catch{O(i=this._getOrReturnCtx(e,i),{validation:"url",code:A.invalid_string,message:l.message}),o.dirty()}else"regex"===l.kind?(l.regex.lastIndex=0,l.regex.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"regex",code:A.invalid_string,message:l.message}),o.dirty())):"trim"===l.kind?e.data=e.data.trim():"includes"===l.kind?e.data.includes(l.value,l.position)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),o.dirty()):"toLowerCase"===l.kind?e.data=e.data.toLowerCase():"toUpperCase"===l.kind?e.data=e.data.toUpperCase():"startsWith"===l.kind?e.data.startsWith(l.value)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:{startsWith:l.value},message:l.message}),o.dirty()):"endsWith"===l.kind?e.data.endsWith(l.value)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:{endsWith:l.value},message:l.message}),o.dirty()):"datetime"===l.kind?(function(e){let t=`${ee}T${en(e)}`,n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,RegExp(`^${t}$`)})(l).test(e.data)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:"datetime",message:l.message}),o.dirty()):"date"===l.kind?et.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:"date",message:l.message}),o.dirty()):"time"===l.kind?RegExp(`^${en(l)}$`).test(e.data)||(O(i=this._getOrReturnCtx(e,i),{code:A.invalid_string,validation:"time",message:l.message}),o.dirty()):"duration"===l.kind?G.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"duration",code:A.invalid_string,message:l.message}),o.dirty()):"ip"===l.kind?(t=e.data,!(("v4"===(n=l.version)||!n)&&K.test(t)||("v6"===n||!n)&&H.test(t))&&1&&(O(i=this._getOrReturnCtx(e,i),{validation:"ip",code:A.invalid_string,message:l.message}),o.dirty())):"jwt"===l.kind?!function(e,t){if(!q.test(e))return!1;try{let[n]=e.split(".");if(!n)return!1;let r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));if("object"!=typeof a||null===a||"typ"in a&&a?.typ!=="JWT"||!a.alg||t&&a.alg!==t)return!1;return!0}catch{return!1}}(e.data,l.alg)&&(O(i=this._getOrReturnCtx(e,i),{validation:"jwt",code:A.invalid_string,message:l.message}),o.dirty()):"cidr"===l.kind?(a=e.data,!(("v4"===(s=l.version)||!s)&&V.test(a)||("v6"===s||!s)&&Y.test(a))&&1&&(O(i=this._getOrReturnCtx(e,i),{validation:"cidr",code:A.invalid_string,message:l.message}),o.dirty())):"base64"===l.kind?X.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"base64",code:A.invalid_string,message:l.message}),o.dirty()):"base64url"===l.kind?Q.test(e.data)||(O(i=this._getOrReturnCtx(e,i),{validation:"base64url",code:A.invalid_string,message:l.message}),o.dirty()):tb.assertNever(l);return{status:o.value,value:e.data}}_regex(e,t,n){return this.refinement(t=>e.test(t),{validation:t,code:A.invalid_string,...tx.errToObj(n)})}_addCheck(e){return new er({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...tx.errToObj(e)})}url(e){return this._addCheck({kind:"url",...tx.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...tx.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...tx.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...tx.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...tx.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...tx.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...tx.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...tx.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...tx.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...tx.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...tx.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...tx.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...tx.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...tx.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...tx.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...tx.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...tx.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...tx.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...tx.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...tx.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...tx.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...tx.errToObj(t)})}nonempty(e){return this.min(1,tx.errToObj(e))}trim(){return new er({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new er({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new er({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}er.create=e=>new er({checks:[],typeName:tS.ZodString,coerce:e?.coerce??!1,...F(e)});class ea extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==I.number){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.number,received:t.parsedType}),R}let n=new N;for(let r of this._def.checks)"int"===r.kind?tb.isInteger(e.data)||(O(t=this._getOrReturnCtx(e,t),{code:A.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty()):"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty()):"multipleOf"===r.kind?0!==function(e,t){let n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}(e.data,r.value)&&(O(t=this._getOrReturnCtx(e,t),{code:A.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(O(t=this._getOrReturnCtx(e,t),{code:A.not_finite,message:r.message}),n.dirty()):tb.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,tx.toString(t))}gt(e,t){return this.setLimit("min",e,!1,tx.toString(t))}lte(e,t){return this.setLimit("max",e,!0,tx.toString(t))}lt(e,t){return this.setLimit("max",e,!1,tx.toString(t))}setLimit(e,t,n,r){return new ea({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:tx.toString(r)}]})}_addCheck(e){return new ea({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:tx.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:tx.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:tx.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:tx.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:tx.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:tx.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:tx.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:tx.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:tx.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&tb.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks)if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;else"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value);return Number.isFinite(t)&&Number.isFinite(e)}}ea.create=e=>new ea({checks:[],typeName:tS.ZodNumber,coerce:e?.coerce||!1,...F(e)});class es extends L{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==I.bigint)return this._getInvalidInput(e);let n=new N;for(let r of this._def.checks)"min"===r.kind?(r.inclusive?e.data<r.value:e.data<=r.value)&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"max"===r.kind?(r.inclusive?e.data>r.value:e.data>=r.value)&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty()):"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(O(t=this._getOrReturnCtx(e,t),{code:A.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):tb.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.bigint,received:t.parsedType}),R}gte(e,t){return this.setLimit("min",e,!0,tx.toString(t))}gt(e,t){return this.setLimit("min",e,!1,tx.toString(t))}lte(e,t){return this.setLimit("max",e,!0,tx.toString(t))}lt(e,t){return this.setLimit("max",e,!1,tx.toString(t))}setLimit(e,t,n,r){return new es({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:tx.toString(r)}]})}_addCheck(e){return new es({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:tx.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:tx.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:tx.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:tx.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:tx.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}es.create=e=>new es({checks:[],typeName:tS.ZodBigInt,coerce:e?.coerce??!1,...F(e)});class ei extends L{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==I.boolean){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.boolean,received:t.parsedType}),R}return j(e.data)}}ei.create=e=>new ei({typeName:tS.ZodBoolean,coerce:e?.coerce||!1,...F(e)});class eo extends L{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==I.date){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.date,received:t.parsedType}),R}if(Number.isNaN(e.data.getTime()))return O(this._getOrReturnCtx(e),{code:A.invalid_date}),R;let n=new N;for(let r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(O(t=this._getOrReturnCtx(e,t),{code:A.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):tb.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new eo({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:tx.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:tx.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}eo.create=e=>new eo({checks:[],coerce:e?.coerce||!1,typeName:tS.ZodDate,...F(e)});class el extends L{_parse(e){if(this._getType(e)!==I.symbol){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.symbol,received:t.parsedType}),R}return j(e.data)}}el.create=e=>new el({typeName:tS.ZodSymbol,...F(e)});class eu extends L{_parse(e){if(this._getType(e)!==I.undefined){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.undefined,received:t.parsedType}),R}return j(e.data)}}eu.create=e=>new eu({typeName:tS.ZodUndefined,...F(e)});class ed extends L{_parse(e){if(this._getType(e)!==I.null){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.null,received:t.parsedType}),R}return j(e.data)}}ed.create=e=>new ed({typeName:tS.ZodNull,...F(e)});class ec extends L{constructor(){super(...arguments),this._any=!0}_parse(e){return j(e.data)}}ec.create=e=>new ec({typeName:tS.ZodAny,...F(e)});class ep extends L{constructor(){super(...arguments),this._unknown=!0}_parse(e){return j(e.data)}}ep.create=e=>new ep({typeName:tS.ZodUnknown,...F(e)});class em extends L{_parse(e){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.never,received:t.parsedType}),R}}em.create=e=>new em({typeName:tS.ZodNever,...F(e)});class eh extends L{_parse(e){if(this._getType(e)!==I.undefined){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.void,received:t.parsedType}),R}return j(e.data)}}eh.create=e=>new eh({typeName:tS.ZodVoid,...F(e)});class ef extends L{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==I.array)return O(t,{code:A.invalid_type,expected:I.array,received:t.parsedType}),R;if(null!==r.exactLength){let e=t.data.length>r.exactLength.value,a=t.data.length<r.exactLength.value;(e||a)&&(O(t,{code:e?A.too_big:A.too_small,minimum:a?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(O(t,{code:A.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(O(t,{code:A.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((e,n)=>r.type._parseAsync(new D(t,e,t.path,n)))).then(e=>N.mergeArray(n,e));let a=[...t.data].map((e,n)=>r.type._parseSync(new D(t,e,t.path,n)));return N.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new ef({...this._def,minLength:{value:e,message:tx.toString(t)}})}max(e,t){return new ef({...this._def,maxLength:{value:e,message:tx.toString(t)}})}length(e,t){return new ef({...this._def,exactLength:{value:e,message:tx.toString(t)}})}nonempty(e){return this.min(1,e)}}ef.create=(e,t)=>new ef({type:e,minLength:null,maxLength:null,exactLength:null,typeName:tS.ZodArray,...F(t)});class eg extends L{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=tb.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==I.object){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.object,received:t.parsedType}),R}let{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),s=[];if(!(this._def.catchall instanceof em&&"strip"===this._def.unknownKeys))for(let e in n.data)a.includes(e)||s.push(e);let i=[];for(let e of a){let t=r[e],a=n.data[e];i.push({key:{status:"valid",value:e},value:t._parse(new D(n,a,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof em){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)i.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)s.length>0&&(O(n,{code:A.unrecognized_keys,keys:s}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s){let r=n.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new D(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of i){let n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e}).then(e=>N.mergeObjectSync(t,e)):N.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return tx.errToObj,new eg({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{let r=this._def.errorMap?.(t,n).message??n.defaultError;return"unrecognized_keys"===t.code?{message:tx.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new eg({...this._def,unknownKeys:"strip"})}passthrough(){return new eg({...this._def,unknownKeys:"passthrough"})}extend(e){return new eg({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new eg({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:tS.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new eg({...this._def,catchall:e})}pick(e){let t={};for(let n of tb.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new eg({...this._def,shape:()=>t})}omit(e){let t={};for(let n of tb.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new eg({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof eg){let n={};for(let r in t.shape){let a=t.shape[r];n[r]=eP.create(e(a))}return new eg({...t._def,shape:()=>n})}if(t instanceof ef)return new ef({...t._def,type:e(t.element)});if(t instanceof eP)return eP.create(e(t.unwrap()));if(t instanceof ej)return ej.create(e(t.unwrap()));if(t instanceof ew)return ew.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let n of tb.objectKeys(this.shape)){let r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new eg({...this._def,shape:()=>t})}required(e){let t={};for(let n of tb.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof eP;)e=e._def.innerType;t[n]=e}return new eg({...this._def,shape:()=>t})}keyof(){return eC(tb.objectKeys(this.shape))}}eg.create=(e,t)=>new eg({shape:()=>e,unknownKeys:"strip",catchall:em.create(),typeName:tS.ZodObject,...F(t)}),eg.strictCreate=(e,t)=>new eg({shape:()=>e,unknownKeys:"strict",catchall:em.create(),typeName:tS.ZodObject,...F(t)}),eg.lazycreate=(e,t)=>new eg({shape:e,unknownKeys:"strip",catchall:em.create(),typeName:tS.ZodObject,...F(t)});class ey extends L{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map(async e=>{let n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;let n=e.map(e=>new T(e.ctx.common.issues));return O(t,{code:A.invalid_union,unionErrors:n}),R});{let e,r=[];for(let a of n){let n={...t,common:{...t.common,issues:[]},parent:null},s=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let a=r.map(e=>new T(e));return O(t,{code:A.invalid_union,unionErrors:a}),R}}get options(){return this._def.options}}ey.create=(e,t)=>new ey({options:e,typeName:tS.ZodUnion,...F(t)});let e_=e=>{if(e instanceof eA)return e_(e.schema);if(e instanceof eR)return e_(e.innerType());if(e instanceof eT)return[e.value];if(e instanceof eE)return e.options;if(e instanceof eO)return tb.objectValues(e.enum);else if(e instanceof eM)return e_(e._def.innerType);else if(e instanceof eu)return[void 0];else if(e instanceof ed)return[null];else if(e instanceof eP)return[void 0,...e_(e.unwrap())];else if(e instanceof ej)return[null,...e_(e.unwrap())];else if(e instanceof eF)return e_(e.unwrap());else if(e instanceof eZ)return e_(e.unwrap());else if(e instanceof eD)return e_(e._def.innerType);else return[]};class ev extends L{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==I.object)return O(t,{code:A.invalid_type,expected:I.object,received:t.parsedType}),R;let n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(O(t,{code:A.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),R)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let r=new Map;for(let n of t){let t=e_(n.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of t){if(r.has(a))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);r.set(a,n)}}return new ev({typeName:tS.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...F(n)})}}class eb extends L{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if("aborted"===e.status||"aborted"===r.status)return R;let a=function e(t,n){let r=k(t),a=k(n);if(t===n)return{valid:!0,data:t};if(r===I.object&&a===I.object){let r=tb.objectKeys(n),a=tb.objectKeys(t).filter(e=>-1!==r.indexOf(e)),s={...t,...n};for(let r of a){let a=e(t[r],n[r]);if(!a.valid)return{valid:!1};s[r]=a.data}return{valid:!0,data:s}}if(r===I.array&&a===I.array){if(t.length!==n.length)return{valid:!1};let r=[];for(let a=0;a<t.length;a++){let s=e(t[a],n[a]);if(!s.valid)return{valid:!1};r.push(s.data)}return{valid:!0,data:r}}if(r===I.date&&a===I.date&&+t==+n)return{valid:!0,data:t};return{valid:!1}}(e.value,r.value);return a.valid?(("dirty"===e.status||"dirty"===r.status)&&t.dirty(),{status:t.value,value:a.data}):(O(n,{code:A.invalid_intersection_types}),R)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([e,t])=>r(e,t)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}eb.create=(e,t,n)=>new eb({left:e,right:t,typeName:tS.ZodIntersection,...F(n)});class ew extends L{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==I.array)return O(n,{code:A.invalid_type,expected:I.array,received:n.parsedType}),R;if(n.data.length<this._def.items.length)return O(n,{code:A.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),R;!this._def.rest&&n.data.length>this._def.items.length&&(O(n,{code:A.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let r=[...n.data].map((e,t)=>{let r=this._def.items[t]||this._def.rest;return r?r._parse(new D(n,e,n.path,t)):null}).filter(e=>!!e);return n.common.async?Promise.all(r).then(e=>N.mergeArray(t,e)):N.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new ew({...this._def,rest:e})}}ew.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new ew({items:e,typeName:tS.ZodTuple,rest:null,...F(t)})};class ex extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==I.object)return O(n,{code:A.invalid_type,expected:I.object,received:n.parsedType}),R;let r=[],a=this._def.keyType,s=this._def.valueType;for(let e in n.data)r.push({key:a._parse(new D(n,e,n.path,e)),value:s._parse(new D(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?N.mergeObjectAsync(t,r):N.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new ex(t instanceof L?{keyType:e,valueType:t,typeName:tS.ZodRecord,...F(n)}:{keyType:er.create(),valueType:e,typeName:tS.ZodRecord,...F(t)})}}class eS extends L{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==I.map)return O(n,{code:A.invalid_type,expected:I.map,received:n.parsedType}),R;let r=this._def.keyType,a=this._def.valueType,s=[...n.data.entries()].map(([e,t],s)=>({key:r._parse(new D(n,e,n.path,[s,"key"])),value:a._parse(new D(n,t,n.path,[s,"value"]))}));if(n.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let n of s){let r=await n.key,a=await n.value;if("aborted"===r.status||"aborted"===a.status)return R;("dirty"===r.status||"dirty"===a.status)&&t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}})}{let e=new Map;for(let n of s){let r=n.key,a=n.value;if("aborted"===r.status||"aborted"===a.status)return R;("dirty"===r.status||"dirty"===a.status)&&t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}}}eS.create=(e,t,n)=>new eS({valueType:t,keyType:e,typeName:tS.ZodMap,...F(n)});class eI extends L{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==I.set)return O(n,{code:A.invalid_type,expected:I.set,received:n.parsedType}),R;let r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(O(n,{code:A.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(O(n,{code:A.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());let a=this._def.valueType;function s(e){let n=new Set;for(let r of e){if("aborted"===r.status)return R;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}let i=[...n.data.values()].map((e,t)=>a._parse(new D(n,e,n.path,t)));return n.common.async?Promise.all(i).then(e=>s(e)):s(i)}min(e,t){return new eI({...this._def,minSize:{value:e,message:tx.toString(t)}})}max(e,t){return new eI({...this._def,maxSize:{value:e,message:tx.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}eI.create=(e,t)=>new eI({valueType:e,minSize:null,maxSize:null,typeName:tS.ZodSet,...F(t)});class ek extends L{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==I.function)return O(t,{code:A.invalid_type,expected:I.function,received:t.parsedType}),R;function n(e,n){return E({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,C,C].filter(e=>!!e),issueData:{code:A.invalid_arguments,argumentsError:n}})}function r(e,n){return E({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,C,C].filter(e=>!!e),issueData:{code:A.invalid_return_type,returnTypeError:n}})}let a={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof eN){let e=this;return j(async function(...t){let i=new T([]),o=await e._def.args.parseAsync(t,a).catch(e=>{throw i.addIssue(n(t,e)),i}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,a).catch(e=>{throw i.addIssue(r(l,e)),i})})}{let e=this;return j(function(...t){let i=e._def.args.safeParse(t,a);if(!i.success)throw new T([n(t,i.error)]);let o=Reflect.apply(s,this,i.data),l=e._def.returns.safeParse(o,a);if(!l.success)throw new T([r(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ek({...this._def,args:ew.create(e).rest(ep.create())})}returns(e){return new ek({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ek({args:e||ew.create([]).rest(ep.create()),returns:t||ep.create(),typeName:tS.ZodFunction,...F(n)})}}class eA extends L{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}eA.create=(e,t)=>new eA({getter:e,typeName:tS.ZodLazy,...F(t)});class eT extends L{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return O(t,{received:t.data,code:A.invalid_literal,expected:this._def.value}),R}return{status:"valid",value:e.data}}get value(){return this._def.value}}function eC(e,t){return new eE({values:e,typeName:tS.ZodEnum,...F(t)})}eT.create=(e,t)=>new eT({value:e,typeName:tS.ZodLiteral,...F(t)});class eE extends L{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),n=this._def.values;return O(t,{expected:tb.joinValues(n),received:t.parsedType,code:A.invalid_type}),R}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return O(t,{received:t.data,code:A.invalid_enum_value,options:n}),R}return j(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return eE.create(e,{...this._def,...t})}exclude(e,t=this._def){return eE.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}eE.create=eC;class eO extends L{_parse(e){let t=tb.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==I.string&&n.parsedType!==I.number){let e=tb.objectValues(t);return O(n,{expected:tb.joinValues(e),received:n.parsedType,code:A.invalid_type}),R}if(this._cache||(this._cache=new Set(tb.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=tb.objectValues(t);return O(n,{received:n.data,code:A.invalid_enum_value,options:e}),R}return j(e.data)}get enum(){return this._def.values}}eO.create=(e,t)=>new eO({values:e,typeName:tS.ZodNativeEnum,...F(t)});class eN extends L{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==I.promise&&!1===t.common.async?(O(t,{code:A.invalid_type,expected:I.promise,received:t.parsedType}),R):j((t.parsedType===I.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}eN.create=(e,t)=>new eN({type:e,typeName:tS.ZodPromise,...F(t)});class eR extends L{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===tS.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:e=>{O(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===r.type){let e=r.transform(n.data,a);if(n.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return R;let r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?R:"dirty"===r.status||"dirty"===t.value?P(r.value):r});{if("aborted"===t.value)return R;let r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?R:"dirty"===r.status||"dirty"===t.value?P(r.value):r}}if("refinement"===r.type){let e=e=>{let t=r.refinement(e,a);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(n=>"aborted"===n.status?R:("dirty"===n.status&&t.dirty(),e(n.value).then(()=>({status:t.value,value:n.value}))));{let r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?R:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}}if("transform"===r.type)if(!1!==n.common.async)return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(e=>"valid"!==e.status?R:Promise.resolve(r.transform(e.value,a)).then(e=>({status:t.value,value:e})));else{let e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if("valid"!==e.status)return R;let s=r.transform(e.value,a);if(s instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}tb.assertNever(r)}}eR.create=(e,t,n)=>new eR({schema:e,typeName:tS.ZodEffects,effect:t,...F(n)}),eR.createWithPreprocess=(e,t,n)=>new eR({schema:t,effect:{type:"preprocess",transform:e},typeName:tS.ZodEffects,...F(n)});class eP extends L{_parse(e){return this._getType(e)===I.undefined?j(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}eP.create=(e,t)=>new eP({innerType:e,typeName:tS.ZodOptional,...F(t)});class ej extends L{_parse(e){return this._getType(e)===I.null?j(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ej.create=(e,t)=>new ej({innerType:e,typeName:tS.ZodNullable,...F(t)});class eM extends L{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===I.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}eM.create=(e,t)=>new eM({innerType:e,typeName:tS.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...F(t)});class eD extends L{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return M(r)?r.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new T(n.common.issues)},input:n.data})})):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new T(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}eD.create=(e,t)=>new eD({innerType:e,typeName:tS.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...F(t)});class e$ extends L{_parse(e){if(this._getType(e)!==I.nan){let t=this._getOrReturnCtx(e);return O(t,{code:A.invalid_type,expected:I.nan,received:t.parsedType}),R}return{status:"valid",value:e.data}}}e$.create=e=>new e$({typeName:tS.ZodNaN,...F(e)}),Symbol("zod_brand");class eF extends L{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class eL extends L{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?R:"dirty"===e.status?(t.dirty(),P(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{let e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?R:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new eL({in:e,out:t,typeName:tS.ZodPipeline})}}class eZ extends L{_parse(e){let t=this._def.innerType._parse(e),n=e=>("valid"===e.status&&(e.value=Object.freeze(e.value)),e);return M(t)?t.then(e=>n(e)):n(t)}unwrap(){return this._def.innerType}}eZ.create=(e,t)=>new eZ({innerType:e,typeName:tS.ZodReadonly,...F(t)}),eg.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(tS||(tS={}));let ez=er.create,eU=ea.create;e$.create,es.create;let eJ=ei.create;eo.create,el.create,eu.create,ed.create;let eW=ec.create;ep.create,em.create,eh.create;let eq=ef.create,eG=eg.create;eg.strictCreate;let eB=ey.create,eK=ev.create;eb.create,ew.create;let eV=ex.create;eS.create,eI.create,ek.create;let eH=eA.create,eY=eT.create,eX=eE.create;function eQ(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function e0(e,t,n,r,a){e[t]=n,eQ(e,t,r,a)}eO.create,eN.create,eR.create,eP.create,ej.create,eR.createWithPreprocess,eL.create;let e1={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===a&&(a=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),a),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function e2(e,t){let n={type:"string"};function r(e){return"escape"===t.patternStrategy?e3(e):e}if(e.checks)for(let a of e.checks)switch(a.kind){case"min":e0(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t);break;case"max":e0(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":e9(n,"email",a.message,t);break;case"format:idn-email":e9(n,"idn-email",a.message,t);break;case"pattern:zod":e4(n,e1.email,a.message,t)}break;case"url":e9(n,"uri",a.message,t);break;case"uuid":e9(n,"uuid",a.message,t);break;case"regex":e4(n,a.regex,a.message,t);break;case"cuid":e4(n,e1.cuid,a.message,t);break;case"cuid2":e4(n,e1.cuid2,a.message,t);break;case"startsWith":e4(n,RegExp(`^${r(a.value)}`),a.message,t);break;case"endsWith":e4(n,RegExp(`${r(a.value)}$`),a.message,t);break;case"datetime":e9(n,"date-time",a.message,t);break;case"date":e9(n,"date",a.message,t);break;case"time":e9(n,"time",a.message,t);break;case"duration":e9(n,"duration",a.message,t);break;case"length":e0(n,"minLength","number"==typeof n.minLength?Math.max(n.minLength,a.value):a.value,a.message,t),e0(n,"maxLength","number"==typeof n.maxLength?Math.min(n.maxLength,a.value):a.value,a.message,t);break;case"includes":e4(n,RegExp(r(a.value)),a.message,t);break;case"ip":"v6"!==a.version&&e9(n,"ipv4",a.message,t),"v4"!==a.version&&e9(n,"ipv6",a.message,t);break;case"emoji":e4(n,e1.emoji,a.message,t);break;case"ulid":e4(n,e1.ulid,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":e9(n,"binary",a.message,t);break;case"contentEncoding:base64":e0(n,"contentEncoding","base64",a.message,t);break;case"pattern:zod":e4(n,e1.base64,a.message,t)}break;case"nanoid":e4(n,e1.nanoid,a.message,t)}return n}let e3=e=>Array.from(e).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),e9=(e,t,n,r)=>{e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):e0(e,"format",t,n,r)},e4=(e,t,n,r)=>{e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:e6(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):e0(e,"pattern",e6(t,r),n,r)},e6=(e,t)=>{let n="function"==typeof e?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;let r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},a=r.i?n.source.toLowerCase():n.source,s="",i=!1,o=!1,l=!1;for(let e=0;e<a.length;e++){if(i){s+=a[e],i=!1;continue}if(r.i){if(o){if(a[e].match(/[a-z]/)){l?(s+=a[e],s+=`${a[e-2]}-${a[e]}`.toUpperCase(),l=!1):"-"===a[e+1]&&a[e+2]?.match(/[a-z]/)?(s+=a[e],l=!0):s+=`${a[e]}${a[e].toUpperCase()}`;continue}}else if(a[e].match(/[a-z]/)){s+=`[${a[e]}${a[e].toUpperCase()}]`;continue}}if(r.m){if("^"===a[e]){s+=`(^|(?<=[\r
]))`;continue}else if("$"===a[e]){s+=`($|(?=[\r
]))`;continue}}if(r.s&&"."===a[e]){s+=o?`${a[e]}\r
`:`[${a[e]}\r
]`;continue}s+=a[e],"\\"===a[e]?i=!0:o&&"]"===a[e]?o=!1:o||"["!==a[e]||(o=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return s};function e5(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===tS.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((n,r)=>({...n,[r]:te(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",r]})??{}}),{}),additionalProperties:!1};let n={type:"object",additionalProperties:te(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return n;if(e.keyType?._def.typeName===tS.ZodString&&e.keyType._def.checks?.length){let r=Object.entries(e2(e.keyType._def,t)).reduce((e,[t,n])=>"type"===t?e:{...e,[t]:n},{});return{...n,propertyNames:r}}return e.keyType?._def.typeName===tS.ZodEnum?{...n,propertyNames:{enum:e.keyType._def.values}}:n}let e7={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},e8=(e,t)=>{let n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,n)=>te(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${n}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return n.length?{anyOf:n}:void 0};function te(e,t,n=!1){let r=t.seen.get(e);if(t.override){let a=t.override?.(e,t,r,n);if(a!==w)return a}if(r&&!n){let e=tt(r,t);if(void 0!==e)return"$ref"in e&&t.seenRefs.add(e.$ref),e}let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);let s=tr(e,e.typeName,t,n);return s&&ta(e,t,s),a.jsonSchema=s,s}let tt=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":let n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&"duplicate-ref"===t.nameStrategy&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:tn(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,n)=>t.currentPath[n]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},tn=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},tr=(e,t,n,r)=>{switch(t){case tS.ZodString:return e2(e,n);case tS.ZodNumber:return function(e,t){let n={type:"number"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"int":n.type="integer",eQ(n,"type",r.message,t);break;case"min":"jsonSchema7"===t.target?r.inclusive?e0(n,"minimum",r.value,r.message,t):e0(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),e0(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?e0(n,"maximum",r.value,r.message,t):e0(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),e0(n,"maximum",r.value,r.message,t));break;case"multipleOf":e0(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case tS.ZodObject:return function(e,t){let n={type:"object",...Object.entries(e.shape()).reduce((e,[n,r])=>{if(void 0===r||void 0===r._def)return e;let a=[...t.currentPath,"properties",n],s=te(r._def,{...t,currentPath:a,propertyPath:a});if(void 0===s)return e;if(t.openaiStrictMode&&r.isOptional()&&!r.isNullable()&&void 0===r._def?.defaultValue)throw Error(`Zod field at \`${a.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:{...e.properties,[n]:s},required:r.isOptional()&&!t.openaiStrictMode?e.required:[...e.required,n]}},{properties:{},required:[]}),additionalProperties:"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:te(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:te(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0};return n.required.length||delete n.required,n}(e,n);case tS.ZodBigInt:return function(e,t){let n={type:"integer",format:"int64"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"min":"jsonSchema7"===t.target?r.inclusive?e0(n,"minimum",r.value,r.message,t):e0(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),e0(n,"minimum",r.value,r.message,t));break;case"max":"jsonSchema7"===t.target?r.inclusive?e0(n,"maximum",r.value,r.message,t):e0(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),e0(n,"maximum",r.value,r.message,t));break;case"multipleOf":e0(n,"multipleOf",r.value,r.message,t)}return n}(e,n);case tS.ZodBoolean:return{type:"boolean"};case tS.ZodDate:return function e(t,n,r){let a=r??n.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((r,a)=>e(t,n,r))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var s=t,i=n;let o={type:"integer",format:"unix-time"};if("openApi3"===i.target)return o;for(let e of s.checks)switch(e.kind){case"min":e0(o,"minimum",e.value,e.message,i);break;case"max":e0(o,"maximum",e.value,e.message,i)}return o}}(e,n);case tS.ZodUndefined:return{not:{}};case tS.ZodNull:return"openApi3"===n.target?{enum:["null"],nullable:!0}:{type:"null"};case tS.ZodArray:return function(e,t){let n={type:"array"};return e.type?._def?.typeName!==tS.ZodAny&&(n.items=te(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&e0(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&e0(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(e0(n,"minItems",e.exactLength.value,e.exactLength.message,t),e0(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}(e,n);case tS.ZodUnion:case tS.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return e8(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(e=>e._def.typeName in e7&&(!e._def.checks||!e._def.checks.length))){let e=n.reduce((e,t)=>{let n=e7[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e},[]);return{type:e.length>1?e:e[0]}}if(n.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=n.reduce((e,t)=>{let n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===n.length){let t=e.filter((e,t,n)=>n.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:n.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(n.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:n.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return e8(e,t)}(e,n);case tS.ZodIntersection:return function(e,t){let n=[te(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),te(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return n.forEach(e=>{if((!("type"in e)||"string"!==e.type)&&"allOf"in e)a.push(...e.allOf),void 0===e.unevaluatedProperties&&(r=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:n,...r}=e;t=r}else r=void 0;a.push(t)}}),a.length?{allOf:a,...r}:void 0}(e,n);case tS.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,n)=>te(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:te(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,n)=>te(e._def,{...t,currentPath:[...t.currentPath,"items",`${n}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,n);case tS.ZodRecord:return e5(e,n);case tS.ZodLiteral:return function(e,t){let n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case tS.ZodEnum:return{type:"string",enum:[...e.values]};case tS.ZodNativeEnum:return function(e){let t=e.values,n=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),r=Array.from(new Set(n.map(e=>typeof e)));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case tS.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target||"property"===t.nullableStrategy?{type:e7[e.innerType._def.typeName],nullable:!0}:{type:[e7[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){let n=te(e.innerType._def,{...t,currentPath:[...t.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}let n=te(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}(e,n);case tS.ZodOptional:return((e,t)=>{if(t.propertyPath&&t.currentPath.slice(0,t.propertyPath.length).toString()===t.propertyPath.toString())return te(e.innerType._def,{...t,currentPath:t.currentPath});let n=te(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}})(e,n);case tS.ZodMap:return function(e,t){return"record"===t.mapStrategy?e5(e,t):{type:"array",maxItems:125,items:{type:"array",items:[te(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},te(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,n);case tS.ZodSet:return function(e,t){let n={type:"array",uniqueItems:!0,items:te(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&e0(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&e0(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case tS.ZodLazy:return te(e.getter()._def,n);case tS.ZodPromise:return te(e.type._def,n);case tS.ZodNaN:case tS.ZodNever:return{not:{}};case tS.ZodEffects:return function(e,t,n){return"input"===t.effectStrategy?te(e.schema._def,t,n):{}}(e,n,r);case tS.ZodAny:case tS.ZodUnknown:return{};case tS.ZodDefault:return function(e,t){return{...te(e.innerType._def,t),default:e.defaultValue()}}(e,n);case tS.ZodBranded:return te(e.type._def,n);case tS.ZodReadonly:case tS.ZodCatch:return te(e.innerType._def,n);case tS.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return te(e.in._def,t);if("output"===t.pipeStrategy)return te(e.out._def,t);let n=te(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=te(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(e=>void 0!==e)}})(e,n);case tS.ZodFunction:case tS.ZodVoid:case tS.ZodSymbol:default:return}},ta=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n);function ts(e,t){return((e,t)=>{let n=(e=>{let t,n="string"==typeof(t=e)?{...x,basePath:["#"],definitions:{},name:t}:{...x,basePath:["#"],definitions:{},...t},r=void 0!==n.name?[...n.basePath,n.definitionPath,n.name]:n.basePath;return{...n,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(n.definitions).map(([e,t])=>[S(t),{def:S(t),path:[...n.basePath,n.definitionPath,e],jsonSchema:void 0}]))}})(t),r="string"==typeof t?t:t?.nameStrategy==="title"?void 0:t?.name,a=te(e._def,void 0===r?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},s="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(a.title=s);let i=(()=>{if(function(e){if(!e)return!0;for(let t in e)return!1;return!0}(n.definitions))return;let e={},t=new Set;for(let r=0;r<500;r++){let r=Object.entries(n.definitions).filter(([e])=>!t.has(e));if(0===r.length)break;for(let[a,s]of r)e[a]=te(S(s),{...n,currentPath:[...n.basePath,n.definitionPath,a]},!0)??{},t.add(a)}return e})(),o=void 0===r?i?{...a,[n.definitionPath]:i}:a:"duplicate-ref"===n.nameStrategy?{...a,...i||n.seenRefs.size?{[n.definitionPath]:{...i,...n.seenRefs.size?{[r]:a}:void 0}}:void 0}:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...i,[r]:a}};return"jsonSchema7"===n.target?o.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===n.target&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o})(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}class ti extends Error{state;constructor(e,t){super(e),this.state=t}}class to extends ti{}class tl extends ti{}class tu extends ti{}class td extends ti{}class tc extends ti{error;constructor(e,t,n){super(e,n),this.error=t}}class tp extends ti{error;constructor(e,t,n){super(e,n),this.error=t}}class tm extends ti{result;constructor(e,t,n){super(e,n),this.result=t}}class th extends ti{result;constructor(e,t,n){super(e,n),this.result=t}}function tf(e){return"object"==typeof e&&null!==e&&"_def"in e&&"object"==typeof e._def&&null!==e._def&&"typeName"in e._def&&"ZodObject"===e._def.typeName}function tg(e){if(0===(e=(e=e.replace(/\s/g,"_")).replace(/[^a-zA-Z0-9]/g,"_")).length)throw Error("Tool name cannot be empty");return e}function ty(e,t){if(tf(e)){var n;let r=function(e,{parser:t,callback:n}){let r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}({type:"function",name:(n={name:t,parameters:e,function:()=>{},description:""}).name,parameters:ts(n.parameters,{name:n.name}),strict:!0,...n.description?{description:n.description}:void 0},{callback:n.function,parser:e=>n.parameters.parse(JSON.parse(e))});return{schema:r.parameters,parser:r.$parseRaw}}if("object"==typeof e&&null!==e)return{schema:e,parser:e=>JSON.parse(e)};throw new td("Input type is not a ZodObject or a valid JSON schema")}function t_(e){if("text"===e)return"text";if(tf(e)){var t;let n=(t="output",function(e,t){let n={...e};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}({type:"json_schema",...void 0,name:t,strict:!0,schema:ts(e,{name:t})},t=>e.parse(JSON.parse(t))));return{type:n.type,name:n.name,strict:n.strict||!1,schema:n.schema}}return e}var tv,tb,tw,tx,tS,tI=n(7062);function tk(e){let t={};return void 0!==t&&("true"===t[e]||"1"===t[e])}let tA={get disabled(){1;return!0}},tT={get dontLogModelData(){return tk("OPENAI_AGENTS_DONT_LOG_MODEL_DATA")},get dontLogToolData(){return tk("OPENAI_AGENTS_DONT_LOG_TOOL_DATA")}},tC=tT.dontLogModelData,tE=tT.dontLogToolData;function tO(e="openai-agents"){return{namespace:e,debug:tI(e),error:console.error,warn:console.warn,dontLogModelData:tC,dontLogToolData:tE}}let tN=tO("openai-agents:core");function tR(e){if(null==e);else if("string"==typeof e)return e;else if("object"==typeof e)try{return JSON.stringify(e)}catch(e){return"[object with circular references]"}return String(e)}function tP(e,t){let n=t instanceof Error?t.toString():String(t);return`An error occurred while running the tool. Please try again. Error: ${n}`}function tj(e){let t=e.name?tg(e.name):tg(e.execute.name),n=void 0===e.errorFunction?tP:e.errorFunction;if(!t)throw Error("Tool name cannot be empty. Either name your function or provide a name in the options.");let r=e.strict??!0;if(!r&&tf(e.parameters))throw new td("Strict mode is required for Zod parameters");let{parser:a,schema:s}=ty(e.parameters,t);async function i(n,r,s){let[i,o]=await u(()=>a(r));if(null!==i)throw tN.dontLogToolData?tN.debug(`Invalid JSON input for tool ${t}`):tN.debug(`Invalid JSON input for tool ${t}: ${r}`),new tu("Invalid JSON input for tool");tN.dontLogToolData?tN.debug(`Invoking tool ${t}`):tN.debug(`Invoking tool ${t} with input ${r}`);let l=await e.execute(o,n,s),d=tR(l);return tN.dontLogToolData?tN.debug(`Tool ${t} completed`):tN.debug(`Tool ${t} returned: ${d}`),l}async function o(e,r,a){return i(e,r,a).catch(r=>{if(n){let a=rR();return a?.setError({message:"Error running tool (non-fatal)",data:{tool_name:t,error:r.toString()}}),n(e,r)}throw r})}let l="function"==typeof e.needsApproval?e.needsApproval:async()=>"boolean"==typeof e.needsApproval&&e.needsApproval,d="function"==typeof e.isEnabled?async(t,n)=>{let r=e.isEnabled;return!!await r({runContext:t,agent:n})}:async()=>"boolean"!=typeof e.isEnabled||e.isEnabled;return{type:"function",name:t,description:e.description,parameters:s,strict:r,invoke:o,needsApproval:l,isEnabled:d}}eG({name:ez(),description:ez().optional(),inputSchema:eG({type:eY("object"),properties:eV(ez(),eW()),required:eq(ez()),additionalProperties:eJ()})});let tM={};async function tD({server:e,convertSchemasToStrict:t,runContext:n,agent:r}){return e.cacheToolsList&&tM[e.name]?tM[e.name].map(n=>tF(n,e,t)):nK(async a=>{let s=await e.listTools(),i=s;if(n&&r){let t={runContext:n,agent:r,serverName:e.name},a=[];for(let n of s){let r=e.toolFilter;if(r)if("function"==typeof r){if(!await r(t,n)){tN.debug(`MCP Tool (server: ${e.name}, tool: ${n.name}) is blocked by the callable filter.`);continue}}else{let t=r.allowedToolNames??[],a=r.blockedToolNames??[];if(t.length>0||a.length>0){let r=!(t.length>0)||t.includes(n.name),s=a.length>0&&a.includes(n.name);if(!r||s){s?tN.debug(`MCP Tool (server: ${e.name}, tool: ${n.name}) is blocked by the static filter.`):r||tN.debug(`MCP Tool (server: ${e.name}, tool: ${n.name}) is not allowed by the static filter.`);continue}}}a.push(n)}i=a}a.spanData.result=i.map(e=>e.name);let o=i.map(n=>tF(n,e,t));return e.cacheToolsList&&(tM[e.name]=i),o},{data:{server:e.name}})}async function t$(e,t,n,r=!1){let{mcpServers:a,convertSchemasToStrict:s=!1,runContext:i,agent:o}=Array.isArray(e)?{mcpServers:e,runContext:t,agent:n,convertSchemasToStrict:r}:e,l=[],u=new Set;for(let e of a){let t=await tD({server:e,convertSchemasToStrict:s,runContext:i,agent:o}),n=[...new Set(t.map(e=>e.name))].filter(e=>u.has(e));if(n.length>0)throw new td(`Duplicate tool names found across MCP servers: ${n.join(", ")}`);for(let e of t)u.add(e.name),l.push(e)}return l}function tF(e,t,n){async function r(n,r){let a={};"string"==typeof n&&n?a=JSON.parse(n):"object"==typeof n&&null!=n&&(a=n);let s=rR();s&&(s.spanData.mcp_data={server:t.name});let i=await t.callTool(e.name,a);return 1===i.length?i[0]:i}let a={...e.inputSchema,type:e.inputSchema?.type??"object",properties:e.inputSchema?.properties??{},required:e.inputSchema?.required??[],additionalProperties:e.inputSchema?.additionalProperties??!1};if(n||!0===a.additionalProperties)try{let t=function(e){let t={...e,additionalProperties:!1};return t.required||(t.required=[]),t}(a);return tj({name:e.name,description:e.description||"",parameters:t,strict:!0,execute:r})}catch(e){tN.warn(`Error converting MCP schema to strict mode: ${e}`)}let s={...a,additionalProperties:!0};return tj({name:e.name,description:e.description||"",parameters:s,strict:!1,execute:r})}class tL{#e=new EventTarget;#t=new Map;on(e,t){let n=this.#t.get(e);n||(n=new Map,this.#t.set(e,n));let r=n.get(t);r||(r=new Set,n.set(t,r));let a=e=>t(...e.detail??[]);return r.add(a),this.#e.addEventListener(e,a),this}off(e,t){let n=this.#t.get(e),r=n?.get(t);if(r?.size){for(let t of r)this.#e.removeEventListener(e,t);n?.delete(t),n?.size===0&&this.#t.delete(e)}return this}emit(e,...t){let n=new CustomEvent(e,{detail:t});return this.#e.dispatchEvent(n)}once(e,t){let n=(...r)=>{this.off(e,n),t(...r)};return this.on(e,n),this}}let tZ=()=>"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),tz=class{constructor(){}pipeTo(e,t){}pipeThrough(e,t){}},tU=globalThis.ReadableStream;globalThis.ReadableStreamDefaultController;let tJ=globalThis.TransformStream;class tW{context=null;constructor(){}run(e,t){return this.context=e,t()}getStore(){return this.context}enterWith(e){this.context=e}}class tq{constructor(){}setTimeout(e,t){let n=setTimeout(e,t);return n.ref="function"==typeof n.ref?n.ref:()=>n,n.unref="function"==typeof n.unref?n.unref:()=>n,n.hasRef="function"==typeof n.hasRef?n.hasRef:()=>!0,n.refresh="function"==typeof n.refresh?n.refresh:()=>n,n}clearTimeout(e){window.clearTimeout(e)}}let tG=new tq;class tB{on(e,t){return this.eventEmitter.on(e,t),this.eventEmitter}off(e,t){return this.eventEmitter.off(e,t),this.eventEmitter}emit(e,...t){return this.eventEmitter.emit(e,...t)}once(e,t){return this.eventEmitter.once(e,t),this.eventEmitter}}class tK extends tB{eventEmitter=new tL}class tV extends tB{eventEmitter=new tL}function tH(e){return!e.startsWith("gpt-5-chat")&&e.startsWith("gpt-5")}function tY(){return({}).OPENAI_DEFAULT_MODEL?.toLowerCase()??"gpt-4.1"}function tX(e){return JSON.stringify({assistant:e.name})}class tQ{toolName;toolDescription;inputJsonSchema={type:"object",properties:{},required:[],additionalProperties:!1};strictJsonSchema=!0;onInvokeHandoff;agentName;inputFilter;agent;getHandoffAsFunctionTool(){return{type:"function",name:this.toolName,description:this.toolDescription,parameters:this.inputJsonSchema,strict:this.strictJsonSchema}}isEnabled=async()=>!0;constructor(e,t){this.agentName=e.name,this.onInvokeHandoff=t,this.toolName=`transfer_to_${tg(e.name)}`,this.toolDescription=function(e){return`Handoff to the ${e.name} agent to handle the request. ${e.handoffDescription??""}`}(e),this.agent=e}}function t0(e,t={}){let n,r=!!t.onHandoff;if(!!t.inputType!==r)throw new td("You must provide either both `onHandoff` and `inputType` or neither.");async function a(r,a){if(n){if(!a)throw rF({message:`Handoff function expected non empty input but got: ${a}`,data:{details:"input is empty"}}),new tu("Handoff function expected non empty input");try{let e=await n(a);t.onHandoff&&await t.onHandoff(r,e)}catch(e){throw rF({message:"Invalid JSON provided",data:{}}),tN.dontLogToolData||tN.error(`Invalid JSON when parsing: ${a}. Error: ${e}`),new tu("Invalid JSON provided")}}else await t.onHandoff?.(r);return e}let s=new tQ(e,a);if("function"==typeof t.isEnabled){let e=t.isEnabled;s.isEnabled=async({runContext:t,agent:n})=>!!await e({runContext:t,agent:n})}else"boolean"==typeof t.isEnabled&&(s.isEnabled=async()=>t.isEnabled);if(t.inputType){let e=ty(t.inputType,s.toolName);s.inputJsonSchema=e.schema,s.strictJsonSchema=!0,n=e.parser}return t.toolNameOverride&&(s.toolName=t.toolNameOverride),t.toolDescriptionOverride&&(s.toolDescription=t.toolDescriptionOverride),t.inputFilter&&(s.inputFilter=t.inputFilter),s}function t1(e){if("message"!==e.type||"assistant"!==e.role)return;let t=e.content[e.content.length-1];if("output_text"===t.type)return t.text}let t2=new WeakMap,t3=eG({input:ez()});class t9 extends tK{static create(e){return new t9({...e,handoffs:e.handoffs,outputType:e.outputType,handoffOutputTypeWarningEnabled:!1})}static DEFAULT_MODEL_PLACEHOLDER="";name;instructions;prompt;handoffDescription;handoffs;model;modelSettings;tools;mcpServers;inputGuardrails;outputGuardrails;outputType="text";toolUseBehavior;resetToolChoice;constructor(e){if(super(),"string"!=typeof e.name||""===e.name.trim())throw new td("Agent must have a name.");if(this.name=e.name,this.instructions=e.instructions??t9.DEFAULT_MODEL_PLACEHOLDER,this.prompt=e.prompt,this.handoffDescription=e.handoffDescription??"",this.handoffs=e.handoffs??[],this.model=e.model??"",this.modelSettings=e.modelSettings??(tH((void 0)??tY())?{reasoning:{effort:"low"},text:{verbosity:"low"}}:{}),this.tools=e.tools??[],this.mcpServers=e.mcpServers??[],this.inputGuardrails=e.inputGuardrails??[],this.outputGuardrails=e.outputGuardrails??[],e.outputType&&(this.outputType=e.outputType),this.toolUseBehavior=e.toolUseBehavior??"run_llm_again",this.resetToolChoice=e.resetToolChoice??!0,void 0!==e.model&&tH(tY())&&("string"!=typeof e.model||!tH(e.model))&&void 0===e.modelSettings&&(this.modelSettings={}),(void 0===e.handoffOutputTypeWarningEnabled||e.handoffOutputTypeWarningEnabled)&&this.handoffs&&this.outputType){let e=new Set([JSON.stringify(this.outputType)]);for(let t of this.handoffs)"outputType"in t&&t.outputType?e.add(JSON.stringify(t.outputType)):"agent"in t&&t.agent.outputType&&e.add(JSON.stringify(t.agent.outputType));e.size>1&&tN.warn(`[Agent] Warning: Handoff agents have different output types: ${Array.from(e).join(", ")}. You can make it type-safe by using Agent.create({ ... }) method instead.`)}}get outputSchemaName(){if("text"===this.outputType)return"text";if(tf(this.outputType))return"ZodOutput";if("object"==typeof this.outputType)return this.outputType.name;throw Error(`Unknown output type: ${this.outputType}`)}clone(e){return new t9({...this,...e})}asTool(e){let{toolName:t,toolDescription:n,customOutputExtractor:r,needsApproval:a,runConfig:s,runOptions:i,isEnabled:o}=e;return tj({name:t??tg(this.name),description:n??"",parameters:t3,strict:!0,needsApproval:a,isEnabled:o,execute:async(e,t,n)=>{var a,o;if(!("object"==typeof e&&null!==e&&"input"in e&&"string"==typeof e.input))throw new tu("Agent tool called with invalid input");let l=new rI(s??{}),u=await l.run(this,e.input,{context:t,...i??{}}),d="object"==typeof this.toolUseBehavior&&null!==this.toolUseBehavior&&"stopAtToolNames"in this.toolUseBehavior;"function"!=typeof r&&d&&tN.debug(`You're passing the agent (name: ${this.name}) with toolUseBehavior.stopAtToolNames configured as a tool to a different agent; this may not work as you expect. You may want to have a wrapper function tool to consistently return the final output.`);let c="function"==typeof r?await r(u):0===(a=u.rawResponses[u.rawResponses.length-1]).output.length?"":t1(a.output[a.output.length-1])||"";return n?.toolCall&&(o=n.toolCall,o&&t2.set(o,u)),c}})}async getSystemPrompt(e){return"function"==typeof this.instructions?await this.instructions(e,this):this.instructions}async getPrompt(e){return"function"==typeof this.prompt?await this.prompt(e,this):this.prompt}async getMcpTools(e){return this.mcpServers.length>0?t$({mcpServers:this.mcpServers,runContext:e,agent:this,convertSchemasToStrict:!1}):[]}async getAllTools(e){let t=await this.getMcpTools(e),n=[];for(let t of this.tools){if("function"===t.type){let n=t.isEnabled;if(!("function"==typeof n?await n(e,this):"boolean"!=typeof n||n))continue}n.push(t)}return[...t,...n]}async getEnabledHandoffs(e){let t=this.handoffs?.map(e=>e instanceof tQ?e:t0(e))??[],n=[];for(let r of t)await r.isEnabled({runContext:e,agent:this})&&n.push(r);return n}processFinalOutput(e){if("text"===this.outputType)return e;if("object"==typeof this.outputType){let t=JSON.parse(e);return tf(this.outputType)?this.outputType.parse(t):t}throw Error(`Unknown output type: ${this.outputType}`)}toJSON(){return{name:this.name}}}function t4({name:e,execute:t}){return{type:"input",name:e,guardrailFunction:t,run:async n=>({guardrail:{type:"input",name:e},output:await t(n)})}}function t6({name:e,execute:t}){return{type:"output",name:e,guardrailFunction:t,run:async n=>({guardrail:{type:"output",name:e},agent:n.agent,agentOutput:n.agentOutput,output:await t(n)})}}let t5=eG({providerData:eV(ez(),eW()).optional()}),t7=t5.extend({id:ez().optional()}),t8=t5.extend({type:eY("refusal"),refusal:ez()}),ne=t5.extend({type:eY("output_text"),text:ez()}),nt=t5.extend({type:eY("input_text"),text:ez()}),nn=t5.extend({type:eY("reasoning_text"),text:ez()}),nr=t5.extend({type:eY("input_image"),image:ez().or(eG({id:ez()})).describe("Could be a URL, base64 or an object with a file ID.")}),na=t5.extend({type:eY("input_file"),file:ez().describe("Either base64 encoded file data or a publicly accessible file URL").or(eG({id:ez().describe("OpenAI file ID")})).or(eG({url:ez().describe("Publicly accessible PDF file URL")})).describe("Contents of the file or an object with a file ID.")}),ns=t5.extend({type:eY("audio"),audio:ez().or(eG({id:ez()})).describe("Base64 encoded audio data or file id"),format:ez().nullable().optional(),transcript:ez().nullable().optional()}),ni=t5.extend({type:eY("image"),image:ez().describe("Base64 encoded image data")}),no=t5.extend({type:eY("text"),text:ez()}),nl=t5.extend({type:eY("image"),data:ez().describe("Base64 encoded image data"),mediaType:ez().describe("IANA media type of the image")}),nu=t5.extend({type:eY("computer_screenshot"),data:ez().describe("Base64 encoded image data or URL")}),nd=eK("type",[eG({type:eY("screenshot")}),eG({type:eY("click"),x:eU(),y:eU(),button:eX(["left","right","wheel","back","forward"])}),eG({type:eY("double_click"),x:eU(),y:eU()}),eG({type:eY("scroll"),x:eU(),y:eU(),scroll_x:eU(),scroll_y:eU()}),eG({type:eY("type"),text:ez()}),eG({type:eY("wait")}),eG({type:eY("move"),x:eU(),y:eU()}),eG({type:eY("keypress"),keys:eq(ez())}),eG({type:eY("drag"),path:eq(eG({x:eU(),y:eU()}))})]),nc=eK("type",[ne,t8,ns,ni]),np=t7.extend({type:eY("message").optional()}),nm=np.extend({role:eY("assistant"),status:eX(["in_progress","completed","incomplete"]),content:eq(nc)}),nh=eK("type",[nt,nr,na,ns]),nf=np.extend({role:eY("user"),content:eq(nh).or(ez())}),ng=np.extend({role:eY("system"),content:ez()});eK("role",[ng,nm,nf]);let ny=t7.extend({type:eY("hosted_tool_call"),name:ez().describe("The name of the hosted tool"),arguments:ez().describe("The arguments of the hosted tool call").optional(),status:ez().optional(),output:ez().optional()}),n_=t7.extend({type:eY("function_call"),callId:ez().describe("The ID of the tool call"),name:ez().describe("The name of the function"),status:eX(["in_progress","completed","incomplete"]).optional(),arguments:ez()}),nv=t7.extend({type:eY("function_call_result"),name:ez().describe("The name of the tool"),callId:ez().describe("The ID of the tool call"),status:eX(["in_progress","completed","incomplete"]),output:eK("type",[no,nl])}),nb=t7.extend({type:eY("computer_call"),callId:ez().describe("The ID of the computer call"),status:eX(["in_progress","completed","incomplete"]),action:nd}),nw=t7.extend({type:eY("computer_call_result"),callId:ez().describe("The ID of the computer call"),output:nu}),nx=eK("type",[nb,n_,ny]),nS=t5.extend({id:ez().optional(),type:eY("reasoning"),content:eq(nt),rawContent:eq(nn).optional()}),nI=t7.extend({type:eY("unknown")}),nk=eK("type",[nm,ny,n_,nb,nS,nI]),nA=eB([nf,nm,ng,ny,n_,nb,nv,nw,nS,nI]),nT=eG({requests:eU().optional(),inputTokens:eU(),outputTokens:eU(),totalTokens:eU(),inputTokensDetails:eV(ez(),eU()).optional(),outputTokensDetails:eV(ez(),eU()).optional()}),nC=t5.extend({type:eY("output_text_delta"),delta:ez()}),nE=t5.extend({type:eY("response_started")}),nO=t5.extend({type:eY("response_done"),response:t5.extend({id:ez(),usage:nT,output:eq(nk)})});eK("type",[nC,nO,nE,t5.extend({type:eY("model"),event:eW().describe("The event from the model")})]);class nN{requests;inputTokens;outputTokens;totalTokens;inputTokensDetails=[];outputTokensDetails=[];constructor(e){if(void 0===e)this.requests=0,this.inputTokens=0,this.outputTokens=0,this.totalTokens=0,this.inputTokensDetails=[],this.outputTokensDetails=[];else{this.requests=e?.requests??1,this.inputTokens=e?.inputTokens??e?.input_tokens??0,this.outputTokens=e?.outputTokens??e?.output_tokens??0,this.totalTokens=e?.totalTokens??e?.total_tokens??0;let t=e?.inputTokensDetails??e?.input_tokens_details;this.inputTokensDetails=t?[t]:[];let n=e?.outputTokensDetails??e?.output_tokens_details;this.outputTokensDetails=n?[n]:[]}}add(e){this.requests+=e.requests,this.inputTokens+=e.inputTokens,this.outputTokens+=e.outputTokens,this.totalTokens+=e.totalTokens,e.inputTokensDetails&&this.inputTokensDetails.push(...e.inputTokensDetails),e.outputTokensDetails&&this.outputTokensDetails.push(...e.outputTokensDetails)}}class nR{context;usage;#n;constructor(e={}){this.context=e,this.usage=new nN,this.#n=new Map}_rebuildApprovals(e){this.#n=new Map(Object.entries(e))}isToolApproved(e){let{toolName:t,callId:n}=e,r=this.#n.get(t);if(r?.approved===!0&&!0===r.rejected)return tN.warn("Tool is permanently approved and rejected at the same time. Approval takes precedence"),!0;if(r?.approved===!0)return!0;if(r?.rejected===!0)return!1;let a=!!Array.isArray(r?.approved)&&r.approved.includes(n),s=!!Array.isArray(r?.rejected)&&r.rejected.includes(n);return a&&s?(tN.warn(`Tool call ${n} is both approved and rejected at the same time. Approval takes precedence`),!0):!!a||!s&&void 0}approveTool(e,{alwaysApprove:t=!1}={}){let n=e.rawItem.name;if(t)return void this.#n.set(n,{approved:!0,rejected:[]});let r=this.#n.get(n)??{approved:[],rejected:[]};if(Array.isArray(r.approved)){let t="callId"in e.rawItem?e.rawItem.callId:e.rawItem.id;r.approved.push(t)}this.#n.set(n,r)}rejectTool(e,{alwaysReject:t=!1}={}){let n=e.rawItem.name;if(t)return void this.#n.set(n,{approved:!1,rejected:!0});let r=this.#n.get(n)??{approved:[],rejected:[]};if(Array.isArray(r.rejected)){let t="callId"in e.rawItem?e.rawItem.callId:e.rawItem.id;r.rejected.push(t)}this.#n.set(n,r)}toJSON(){return{context:this.context,usage:this.usage,approvals:Object.fromEntries(this.#n.entries())}}}function nP(e){return"function"===e.type?{type:"function",name:e.name,description:e.description,parameters:e.parameters,strict:e.strict}:"computer"===e.type?{type:"computer",name:e.name,environment:e.computer.environment,dimensions:e.computer.dimensions}:{type:"hosted_tool",name:e.name,providerData:e.providerData}}function nj(e){return{toolName:e.toolName,toolDescription:e.toolDescription,inputJsonSchema:e.inputJsonSchema,strictJsonSchema:e.strictJsonSchema}}class nM{type="base_item";rawItem;toJSON(){return{type:this.type,rawItem:this.rawItem}}}class nD extends nM{rawItem;agent;type="message_output_item";constructor(e,t){super(),this.rawItem=e,this.agent=t}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}get content(){let e="";for(let t of this.rawItem.content)"output_text"===t.type&&(e+=t.text);return e}}class n$ extends nM{rawItem;agent;type="tool_call_item";constructor(e,t){super(),this.rawItem=e,this.agent=t}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class nF extends nM{rawItem;agent;output;type="tool_call_output_item";constructor(e,t,n){super(),this.rawItem=e,this.agent=t,this.output=n}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON(),output:tR(this.output)}}}class nL extends nM{rawItem;agent;type="reasoning_item";constructor(e,t){super(),this.rawItem=e,this.agent=t}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class nZ extends nM{rawItem;agent;type="handoff_call_item";constructor(e,t){super(),this.rawItem=e,this.agent=t}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}class nz extends nM{rawItem;sourceAgent;targetAgent;type="handoff_output_item";constructor(e,t,n){super(),this.rawItem=e,this.sourceAgent=t,this.targetAgent=n}toJSON(){return{...super.toJSON(),sourceAgent:this.sourceAgent.toJSON(),targetAgent:this.targetAgent.toJSON()}}}class nU extends nM{rawItem;agent;type="tool_approval_item";constructor(e,t){super(),this.rawItem=e,this.agent=t}toJSON(){return{...super.toJSON(),agent:this.agent.toJSON()}}}function nJ(e){return async(t,...n)=>rL(async()=>{let r=e(...n);rD(r);try{return r.start(),await t(r)}catch(e){throw r.setError({message:e.message,data:e.data}),e}finally{r.end(),r$()}})}function nW(e,t){return r1().createSpan({...e,data:{type:"agent",name:e?.data?.name??"Agent",...e?.data}},t)}nJ(function(e,t){return e={},r1().createSpan({...e,data:{type:"response",...e.data}},t)}),nJ(nW);let nq=nJ(function(e,t){return r1().createSpan({...e,data:{type:"function",input:e?.data?.input??"",output:e?.data?.output??"",...e?.data}},t)}),nG=nJ(function(e,t){return r1().createSpan({...e,data:{type:"handoff",...e?.data}},t)});nJ(function(e,t){return r1().createSpan({...e,data:{type:"generation",...e?.data}},t)}),nJ(function(e,t){return r1().createSpan({...e,data:{type:"custom",data:{},...e?.data}},t)});let nB=nJ(function(e,t){return r1().createSpan({...e,data:{type:"guardrail",triggered:!1,...e?.data}},t)});nJ(function(e,t){return r1().createSpan({...e,data:{type:"transcription",...e.data}},t)}),nJ(function(e,t){return r1().createSpan({...e,data:{type:"speech",...e.data}},t)}),nJ(function(e,t){return r1().createSpan({...e,data:{type:"speech_group",...e?.data}},t)});let nK=nJ(function(e,t){return r1().createSpan({...e,data:{type:"mcp_tools",...e?.data}},t)});class nV{data;type="raw_model_stream_event";constructor(e){this.data=e}}class nH{name;item;type="run_item_stream_event";constructor(e,t){this.name=e,this.item=t}}class nY{agent;type="agent_updated_stream_event";constructor(e){this.agent=e}}function nX(e,t,n,r){let a=[],s=[],i=[],o=[],l=[],u=[],d=new Map(r.map(e=>[e.toolName,e])),c=new Map(n.filter(e=>"function"===e.type).map(e=>[e.name,e])),p=n.find(e=>"computer"===e.type),m=new Map(n.filter(e=>"hosted_tool"===e.type&&e.providerData?.type==="mcp").map(e=>e).map(e=>[e.providerData.server_label,e]));for(let n of e.output){if("message"===n.type)"assistant"===n.role&&a.push(new nD(n,t));else if("hosted_tool_call"===n.type){a.push(new n$(n,t));let e=n.name;if(u.push(e),n.providerData?.type==="mcp_approval_request"||"mcp_approval_request"===n.name){let e=n.providerData,r=e.server_label,s=m.get(r);if(void 0===s){let e=`MCP server (${r}) not found in Agent (${t.name})`;throw rF({message:e,data:{mcp_server_label:r}}),new tu(e)}let i=new nU({type:"hosted_tool_call",name:e.name,id:e.id,status:"in_progress",providerData:e},t);l.push({requestItem:i,mcpTool:s}),s.providerData.on_approval||a.push(i)}}else if("reasoning"===n.type)a.push(new nL(n,t));else if("computer_call"===n.type){if(a.push(new n$(n,t)),u.push("computer_use"),!p)throw rF({message:"Model produced computer action without a computer tool.",data:{agent_name:t.name}}),new tu("Model produced computer action without a computer tool.");o.push({toolCall:n,computer:p})}if("function_call"!==n.type)continue;u.push(n.name);let e=d.get(n.name);if(e)a.push(new nZ(n,t)),s.push({toolCall:n,handoff:e});else{let e=c.get(n.name);if(!e)throw rF({message:`Tool ${n.name} not found in agent ${t.name}.`,data:{tool_name:n.name,agent_name:t.name}}),new tu(`Tool ${n.name} not found in agent ${t.name}.`);a.push(new n$(n,t)),i.push({toolCall:n,tool:e})}}return{newItems:a,handoffs:s,functions:i,computerActions:o,mcpApprovalRequests:l,toolsUsed:u,hasToolsOrApprovalsToRun:()=>s.length>0||i.length>0||l.length>0||o.length>0}}let nQ=eK("type",[eG({type:eY("next_step_handoff"),newAgent:eW()}),eG({type:eY("next_step_final_output"),output:ez()}),eG({type:eY("next_step_run_again")}),eG({type:eY("next_step_interruption"),data:eV(ez(),eW())})]);class n0{originalInput;modelResponse;preStepItems;newStepItems;nextStep;constructor(e,t,n,r,a){this.originalInput=e,this.modelResponse=t,this.preStepItems=n,this.newStepItems=r,this.nextStep=a}get generatedItems(){return this.preStepItems.concat(this.newStepItems)}}function n1(e,t,n){return e.resetToolChoice&&t.hasUsedTools(e)?{...n,toolChoice:void 0}:n}async function n2(e,t,n,r,a,s,i){let o=n.filter(e=>e instanceof nU&&"callId"in e.rawItem&&"function_call"===e.rawItem.type).map(e=>e.rawItem.callId),l=a.functions.filter(e=>o.includes(e.toolCall.callId)),u=await n4(e,l,s,i),d=u.map(e=>e.runItem);for(let t of a.mcpApprovalRequests.filter(e=>"tool_approval_item"===e.requestItem.type&&"hosted_tool_call"===e.requestItem.rawItem.type&&e.requestItem.rawItem.providerData?.type==="mcp_approval_request")){let n=t.requestItem.rawItem.id,r=i._context.isToolApproved({toolName:t.requestItem.rawItem.name,callId:n});if(void 0!==r){let t={approve:r,approval_request_id:n,reason:void 0};d.push(new n$({type:"hosted_tool_call",name:"mcp_approval_response",providerData:t},e))}}let c=await re(e,u,i),p=n.filter(e=>!(e instanceof nU));return c.isFinalOutput?(s.emit("agent_end",i._context,e,c.finalOutput),e.emit("agent_end",i._context,c.finalOutput),new n0(t,r,p,d,{type:"next_step_final_output",output:c.finalOutput})):c.isInterrupted?new n0(t,r,p,d,{type:"next_step_interruption",data:{interruptions:c.interruptions}}):new n0(t,r,p,d,{type:"next_step_run_again"})}async function n3(e,t,n,r,a,s,i){let o=a.newItems,[l,d]=await Promise.all([n4(e,a.functions,s,i),n5(e,a.computerActions,s,i._context)]);if(o=(o=o.concat(l.map(e=>e.runItem))).concat(d),a.mcpApprovalRequests.length>0)for(let t of a.mcpApprovalRequests){let n=t.mcpTool.providerData,r=t.requestItem.rawItem.providerData;if(n.on_approval){let a=await n.on_approval(i._context,t.requestItem),s={approve:a.approve,approval_request_id:r.id,reason:a.reason};o.push(new n$({type:"hosted_tool_call",name:"mcp_approval_response",providerData:s},e))}else{o.push(t.requestItem);let n={type:"hosted_mcp_tool_approval",tool:t.mcpTool,runItem:new nU({type:"hosted_tool_call",name:r.name,id:r.id,arguments:r.arguments,status:"in_progress",providerData:r},e)};l.push(n)}}if(a.handoffs.length>0)return await n7(e,t,n,o,r,a.handoffs,s,i._context);let c=await re(e,l,i);if(c.isFinalOutput)return s.emit("agent_end",i._context,e,c.finalOutput),e.emit("agent_end",i._context,c.finalOutput),new n0(t,r,n,o,{type:"next_step_final_output",output:c.finalOutput});if(c.isInterrupted)return new n0(t,r,n,o,{type:"next_step_interruption",data:{interruptions:c.interruptions}});if((a.functions?.length??0)>0||(a.computerActions?.length??0)>0||(a.mcpApprovalRequests?.length??0)>0||(a.handoffs?.length??0)>0)return new n0(t,r,n,o,{type:"next_step_run_again"});let p=o.filter(e=>e instanceof nD),m=p.length>0?t1(p[p.length-1].rawItem):void 0;if(void 0===m)return new n0(t,r,n,o,{type:"next_step_run_again"});if(!l.some(e=>e.runItem instanceof nU)){if("text"===e.outputType)return new n0(t,r,n,o,{type:"next_step_final_output",output:m});if("text"!==e.outputType&&m){let{parser:a}=ty(e.outputType,"final_output"),[s]=await u(()=>a(m));if(s)throw rF({message:"Invalid output type",data:{error:String(s)}}),new tu("Invalid output type");return new n0(t,r,n,o,{type:"next_step_final_output",output:m})}}return new n0(t,r,n,o,{type:"next_step_run_again"})}function n9(e,t){return{type:"function_call_result",name:e.name,callId:e.callId,status:"completed",output:{type:"text",text:tR(t)}}}async function n4(e,t,n,r){async function a(t){let a=t.toolCall.arguments;if(t.tool.parameters&&(a=tf(t.tool.parameters)?t.tool.parameters.parse(a):JSON.parse(a)),await t.tool.needsApproval(r._context,a,t.toolCall.callId)){let n=r._context.isToolApproved({toolName:t.tool.name,callId:t.toolCall.callId});if(!1===n)return nq(async n=>{let r="Tool execution was not approved.";return n.setError({message:r,data:{tool_name:t.tool.name,error:`Tool execution for ${t.toolCall.callId} was manually rejected by user.`}}),n.spanData.output=r,{type:"function_output",tool:t.tool,output:r,runItem:new nF(n9(t.toolCall,r),e,r)}},{data:{name:t.tool.name}});if(!0!==n)return{type:"function_approval",tool:t.tool,runItem:new nU(t.toolCall,e)}}return nq(async a=>{n.config.traceIncludeSensitiveData&&(a.spanData.input=t.toolCall.arguments);try{n.emit("agent_tool_start",r._context,e,t.tool,{toolCall:t.toolCall}),e.emit("agent_tool_start",r._context,t.tool,{toolCall:t.toolCall});let s=await t.tool.invoke(r._context,t.toolCall.arguments,{toolCall:t.toolCall}),i=tR(s);n.emit("agent_tool_end",r._context,e,t.tool,i,{toolCall:t.toolCall}),e.emit("agent_tool_end",r._context,t.tool,i,{toolCall:t.toolCall}),n.config.traceIncludeSensitiveData&&(a.spanData.output=i);let o={type:"function_output",tool:t.tool,output:s,runItem:new nF(n9(t.toolCall,s),e,s)},l=function(e){let t=t2.get(e);return t&&t2.delete(e),t}(t.toolCall);if(l){o.agentRunResult=l;let e=l.interruptions;e.length>0&&(o.interruptions=e)}return o}catch(e){throw a.setError({message:"Error running tool",data:{tool_name:t.tool.name,error:String(e)}}),e}},{data:{name:t.tool.name}})}try{return await Promise.all(t.map(a))}catch(e){throw new tp(`Failed to run function tools: ${e}`,e,r)}}async function n6(e,t){let n,r=t.action;switch(r.type){case"click":await e.click(r.x,r.y,r.button);break;case"double_click":await e.doubleClick(r.x,r.y);break;case"drag":await e.drag(r.path.map(e=>[e.x,e.y]));break;case"keypress":await e.keypress(r.keys);break;case"move":await e.move(r.x,r.y);break;case"screenshot":n=await e.screenshot();break;case"scroll":await e.scroll(r.x,r.y,r.scroll_x,r.scroll_y);break;case"type":await e.type(r.text);break;case"wait":await e.wait()}if(void 0!==n||"function"==typeof e.screenshot&&void 0!==(n=await e.screenshot()))return n;throw Error("Computer does not implement screenshot()")}async function n5(e,t,n,r,a){let s=a??tN,i=[];for(let a of t){let t,o=a.computer.computer,l=a.toolCall;n.emit("agent_tool_start",r,e,a.computer,{toolCall:l}),"function"==typeof e.emit&&e.emit("agent_tool_start",r,a.computer,{toolCall:l});try{t=await n6(o,l)}catch(e){s.error("Failed to execute computer action:",e),t=""}n.emit("agent_tool_end",r,e,a.computer,t,{toolCall:l}),"function"==typeof e.emit&&e.emit("agent_tool_end",r,a.computer,t,{toolCall:l});let u=t?`data:image/png;base64,${t}`:"",d={type:"computer_call_result",callId:l.callId,output:{type:"computer_screenshot",data:u}};i.push(new nF(d,e,u))}return i}async function n7(e,t,n,r,a,s,i,o){if(r=[...r],0===s.length)return tN.warn("Incorrectly called executeHandoffCalls with no handoffs. This should not happen. Moving on."),new n0(t,a,n,r,{type:"next_step_run_again"});if(s.length>1){let t="Multiple handoffs detected, ignoring this one.";for(let n=1;n<s.length;n++)r.push(new nF(n9(s[n].toolCall,t),e,t))}let l=s[0];return nG(async u=>{let d=l.handoff,c=await d.onInvokeHandoff(o,l.toolCall.arguments);if(u.spanData.to_agent=c.name,s.length>1){let e=s.map(e=>e.handoff.agentName);u.setError({message:"Multiple handoffs requested",data:{requested_agents:e}})}r.push(new nz(n9(l.toolCall,tX(c)),e,c)),i.emit("agent_handoff",o,e,c),e.emit("agent_handoff",o,c);let p=d.inputFilter??i.config.handoffInputFilter;if(p){tN.debug("Filtering inputs for handoff"),"function"!=typeof p&&u.setError({message:"Invalid input filter",data:{details:"not callable"}});let e=p({inputHistory:Array.isArray(t)?[...t]:t,preHandoffItems:[...n],newItems:[...r],runContext:o});t=e.inputHistory,n=e.preHandoffItems,r=e.newItems}return new n0(t,a,n,r,{type:"next_step_handoff",newAgent:c})},{data:{from_agent:e.name}})}let n8={isFinalOutput:!1,isInterrupted:void 0};async function re(e,t,n){if(0===t.length)return n8;let r=[];for(let e of t)if(e.runItem instanceof nU&&r.push(e.runItem),"function_output"===e.type){if(Array.isArray(e.interruptions))r.push(...e.interruptions);else if(e.agentRunResult){let t=e.agentRunResult.interruptions;t.length>0&&r.push(...t)}}if(r.length>0)return{isFinalOutput:!1,isInterrupted:!0,interruptions:r};if("run_llm_again"===e.toolUseBehavior)return n8;let a=t[0];if("stop_on_first_tool"===e.toolUseBehavior)return a?.type==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:tR(a.output)}:n8;let s=e.toolUseBehavior;if("object"==typeof s){let e=t.find(e=>s.stopAtToolNames.includes(e.tool.name));return e?.type==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:tR(e.output)}:n8}if("function"==typeof s)return s(n._context,t);throw new td(`Invalid toolUseBehavior: ${s}`,n)}function rt(e,t){let n=t instanceof nD?"message_output_created":t instanceof nZ?"handoff_requested":t instanceof nz?"handoff_occurred":t instanceof n$?"tool_called":t instanceof nF?"tool_output":t instanceof nL?"reasoning_item_created":t instanceof nU?"tool_approval_requested":void 0;if(!n)return void tN.warn("Unknown item type: ",t);e._addItem(new nH(n,t))}function rn(e,t,n){let r=n?.skipItems;for(let n of t.newStepItems)r?.has(n)||rt(e,n)}class rr{#r=new Map;addToolUse(e,t){this.#r.set(e,t)}hasUsedTools(e){return this.#r.has(e)}toJSON(){return Object.fromEntries(Array.from(this.#r.entries()).map(([e,t])=>[e.name,t]))}}let ra=eY("1.0"),rs=eG({name:ez()}),ri=eG({object:eY("trace.span"),id:ez(),trace_id:ez(),parent_id:ez().nullable(),started_at:ez().nullable(),ended_at:ez().nullable(),error:eG({message:ez(),data:eV(ez(),eW()).optional()}).nullable(),span_data:eV(ez(),eW())}).extend({previous_span:eH(()=>ri).optional()}),ro=eG({requests:eU(),inputTokens:eU(),outputTokens:eU(),totalTokens:eU()}),rl=eG({usage:ro,output:eq(nk),responseId:ez().optional(),providerData:eV(ez(),eW()).optional()}),ru=eK("type",[eG({type:eY("message_output_item"),rawItem:nm,agent:rs}),eG({type:eY("tool_call_item"),rawItem:nx.or(ny),agent:rs}),eG({type:eY("tool_call_output_item"),rawItem:nv,agent:rs,output:ez()}),eG({type:eY("reasoning_item"),rawItem:nS,agent:rs}),eG({type:eY("handoff_call_item"),rawItem:n_,agent:rs}),eG({type:eY("handoff_output_item"),rawItem:nv,sourceAgent:rs,targetAgent:rs}),eG({type:eY("tool_approval_item"),rawItem:n_.or(ny),agent:rs})]),rd=eG({object:eY("trace"),id:ez(),workflow_name:ez(),group_id:ez().nullable(),metadata:eV(ez(),eW())}),rc=eG({newItems:eq(ru),toolsUsed:eq(ez()),handoffs:eq(eG({toolCall:eW(),handoff:eW()})),functions:eq(eG({toolCall:eW(),tool:eW()})),computerActions:eq(eG({toolCall:eW(),computer:eW()})),mcpApprovalRequests:eq(eG({requestItem:eG({rawItem:eG({type:eY("hosted_tool_call"),name:ez(),arguments:ez().optional(),status:ez().optional(),output:ez().optional(),providerData:eV(ez(),eW()).nullable().optional()})}),mcpTool:eG({type:eY("hosted_tool"),name:eY("hosted_mcp"),providerData:eV(ez(),eW())})})).optional()}),rp=eG({tripwireTriggered:eJ(),outputInfo:eW()}),rm=eG({guardrail:eG({type:eY("input"),name:ez()}),output:rp}),rh=eG({guardrail:eG({type:eY("output"),name:ez()}),agentOutput:eW(),agent:rs,output:rp}),rf=eG({$schemaVersion:ra,currentTurn:eU(),currentAgent:rs,originalInput:ez().or(eq(nA)),modelResponses:eq(rl),context:eG({usage:ro,approvals:eV(ez(),eG({approved:eq(ez()).or(eJ()),rejected:eq(ez()).or(eJ())})),context:eV(ez(),eW())}),toolUseTracker:eV(ez(),eq(ez())),maxTurns:eU(),currentAgentSpan:ri.nullable().optional(),noActiveAgentRun:eJ(),inputGuardrailResults:eq(rm),outputGuardrailResults:eq(rh),currentStep:nQ.optional(),lastModelResponse:rl.optional(),generatedItems:eq(ru),lastProcessedResponse:rc.optional(),trace:rd.nullable()});class rg{_currentTurn=0;_currentAgent;_originalInput;_modelResponses;_currentAgentSpan;_context;_toolUseTracker;_generatedItems;_maxTurns;_noActiveAgentRun=!0;_lastTurnResponse;_inputGuardrailResults;_outputGuardrailResults;_currentStep=void 0;_lastProcessedResponse=void 0;_trace=null;constructor(e,t,n,r){this._context=e,this._originalInput=structuredClone(t),this._modelResponses=[],this._currentAgentSpan=void 0,this._currentAgent=n,this._toolUseTracker=new rr,this._generatedItems=[],this._maxTurns=r,this._inputGuardrailResults=[],this._outputGuardrailResults=[],this._trace=rN()}get history(){return rS(this._originalInput,this._generatedItems)}getInterruptions(){return this._currentStep?.type!=="next_step_interruption"?[]:this._currentStep.data.interruptions}approve(e,t={alwaysApprove:!1}){this._context.approveTool(e,t)}reject(e,t={alwaysReject:!1}){this._context.rejectTool(e,t)}toJSON(){let e={$schemaVersion:"1.0",currentTurn:this._currentTurn,currentAgent:{name:this._currentAgent.name},originalInput:this._originalInput,modelResponses:this._modelResponses.map(e=>({usage:{requests:e.usage.requests,inputTokens:e.usage.inputTokens,outputTokens:e.usage.outputTokens,totalTokens:e.usage.totalTokens},output:e.output,responseId:e.responseId,providerData:e.providerData})),context:this._context.toJSON(),toolUseTracker:this._toolUseTracker.toJSON(),maxTurns:this._maxTurns,currentAgentSpan:this._currentAgentSpan?.toJSON(),noActiveAgentRun:this._noActiveAgentRun,inputGuardrailResults:this._inputGuardrailResults,outputGuardrailResults:this._outputGuardrailResults.map(e=>({...e,agent:e.agent.toJSON()})),currentStep:this._currentStep,lastModelResponse:this._lastTurnResponse,generatedItems:this._generatedItems.map(e=>e.toJSON()),lastProcessedResponse:this._lastProcessedResponse,trace:this._trace?this._trace.toJSON():null},t=rf.safeParse(e);if(!t.success)throw new to(`Failed to serialize run state. ${t.error.message}`);return t.data}toString(){return JSON.stringify(this.toJSON())}static async fromString(e,t){let[n,r]=await u(()=>JSON.parse(t));if(n)throw new td(`Failed to parse run state. ${n instanceof Error?n.message:String(n)}`);let a=r.$schemaVersion;if(!a)throw new td("Run state is missing schema version");if("1.0"!==a)throw new td(`Run state schema version ${a} is not supported. Please use version 1.0`);let s=rf.parse(JSON.parse(t)),i=function(e){let t=new Map,n=[e];for(;n.length>0;){let e=n.shift();if(!t.has(e.name))for(let r of(t.set(e.name,e),e.handoffs))r instanceof t9?t.has(r.name)||n.push(r):r.agent&&!t.has(r.agent.name)&&n.push(r.agent)}return t}(e),o=new nR(s.context.context);o._rebuildApprovals(s.context.approvals);let l=i.get(s.currentAgent.name);if(!l)throw new td(`Agent ${s.currentAgent.name} not found`);let d=new rg(o,"",l,s.maxTurns);for(let[e,t]of(d._currentTurn=s.currentTurn,d._toolUseTracker=new rr,Object.entries(s.toolUseTracker)))d._toolUseTracker.addToolUse(i.get(e),t);if(s.currentAgentSpan){s.trace||tN.warn("Trace is not set, skipping tracing setup");let e=r1().createTrace({traceId:s.trace?.id,name:s.trace?.workflow_name,groupId:s.trace?.group_id??void 0,metadata:s.trace?.metadata});d._currentAgentSpan=function e(t,n){let r=n.span_data,a=n.previous_span?e(t,n.previous_span):void 0,s=r1().createSpan({spanId:n.id,traceId:n.trace_id,parentId:n.parent_id??void 0,startedAt:n.started_at??void 0,endedAt:n.ended_at??void 0,data:r},t);return s.previousSpan=a,s}(e,s.currentAgentSpan),d._trace=e}return d._noActiveAgentRun=s.noActiveAgentRun,d._inputGuardrailResults=s.inputGuardrailResults,d._outputGuardrailResults=s.outputGuardrailResults.map(e=>({...e,agent:i.get(e.agent.name)})),d._currentStep=s.currentStep,d._originalInput=s.originalInput,d._modelResponses=s.modelResponses.map(ry),d._lastTurnResponse=s.lastModelResponse?ry(s.lastModelResponse):void 0,d._generatedItems=s.generatedItems.map(e=>r_(e,i)),d._lastProcessedResponse=s.lastProcessedResponse?await rv(i,d._currentAgent,d._context,s.lastProcessedResponse):void 0,s.currentStep?.type==="next_step_handoff"&&(d._currentStep={type:"next_step_handoff",newAgent:i.get(s.currentStep.newAgent.name)}),d}}function ry(e){let t=new nN;return t.requests=e.usage.requests,t.inputTokens=e.usage.inputTokens,t.outputTokens=e.usage.outputTokens,t.totalTokens=e.usage.totalTokens,{usage:t,output:e.output.map(e=>nk.parse(e)),responseId:e.responseId,providerData:e.providerData}}function r_(e,t){switch(e.type){case"message_output_item":return new nD(e.rawItem,t.get(e.agent.name));case"tool_call_item":return new n$(e.rawItem,t.get(e.agent.name));case"tool_call_output_item":return new nF(e.rawItem,t.get(e.agent.name),e.output);case"reasoning_item":return new nL(e.rawItem,t.get(e.agent.name));case"handoff_call_item":return new nZ(e.rawItem,t.get(e.agent.name));case"handoff_output_item":return new nz(e.rawItem,t.get(e.sourceAgent.name),t.get(e.targetAgent.name));case"tool_approval_item":return new nU(e.rawItem,t.get(e.agent.name))}}async function rv(e,t,n,r){let a=await t.getAllTools(n),s=new Map(a.filter(e=>"function"===e.type).map(e=>[e.name,e])),i=new Map(a.filter(e=>"computer"===e.type).map(e=>[e.name,e])),o=new Map(t.handoffs.map(e=>e instanceof t9?[e.name,t0(e)]:[e.toolName,e])),l={newItems:r.newItems.map(t=>r_(t,e)),toolsUsed:r.toolsUsed,handoffs:r.handoffs.map(e=>{if(!o.has(e.handoff.toolName))throw new td(`Handoff ${e.handoff.toolName} not found`);return{toolCall:e.toolCall,handoff:o.get(e.handoff.toolName)}}),functions:await Promise.all(r.functions.map(async e=>{if(!s.has(e.tool.name))throw new td(`Tool ${e.tool.name} not found`);return{toolCall:e.toolCall,tool:s.get(e.tool.name)}})),computerActions:r.computerActions.map(e=>{let t=e.computer.name;if(!i.has(t))throw new td(`Computer tool ${t} not found`);return{toolCall:e.toolCall,computer:i.get(t)}}),mcpApprovalRequests:(r.mcpApprovalRequests??[]).map(e=>({requestItem:new nU(e.requestItem.rawItem,t),mcpTool:e.mcpTool}))};return{...l,hasToolsOrApprovalsToRun:()=>l.handoffs.length>0||l.functions.length>0||l.mcpApprovalRequests.length>0||l.computerActions.length>0}}function rb(e,t){return!e&&(!!t||"enabled_without_data")}function rw(e){return"string"==typeof e?[{type:"message",role:"user",content:e}]:[...e]}class rx{conversationId;previousResponseId;sentInitialInput=!1;sentItems=new WeakSet;serverItems=new WeakSet;constructor({conversationId:e,previousResponseId:t}){this.conversationId=e??void 0,this.previousResponseId=t??void 0}primeFromState({originalInput:e,generatedItems:t,modelResponses:n}){if(this.sentInitialInput)return;for(let t of rw(e))t&&"object"==typeof t&&this.sentItems.add(t);this.sentInitialInput=!0;let r=n[n.length-1];for(let e of n)for(let t of e.output)t&&"object"==typeof t&&this.serverItems.add(t);for(let e of(!this.conversationId&&r?.responseId&&(this.previousResponseId=r.responseId),t)){let t=e.rawItem;t&&"object"==typeof t&&this.serverItems.has(t)&&this.sentItems.add(t)}}trackServerItems(e){if(e){for(let t of e.output)t&&"object"==typeof t&&this.serverItems.add(t);!this.conversationId&&void 0!==this.previousResponseId&&e.responseId&&(this.previousResponseId=e.responseId)}}prepareInput(e,t){let n=[];if(!this.sentInitialInput){for(let t of rw(e))n.push(t),t&&"object"==typeof t&&this.sentItems.add(t);this.sentInitialInput=!0}for(let e of t){if("tool_approval_item"===e.type)continue;let t=e.rawItem;t&&"object"==typeof t&&(this.sentItems.has(t)||this.serverItems.has(t)||(n.push(t),this.sentItems.add(t)))}return n}}function rS(e,t){let n=t.filter(e=>"tool_approval_item"!==e.type).map(e=>e.rawItem);return[...rw(e),...n]}class rI extends tV{config;inputGuardrailDefs;outputGuardrailDefs;constructor(e={}){super(),this.config={modelProvider:e.modelProvider??function(){if(void 0===s)throw Error("No default model provider set. Make sure to set a provider using setDefaultModelProvider before calling getDefaultModelProvider or pass an explicit provider.");return s}(),model:e.model,modelSettings:e.modelSettings,handoffInputFilter:e.handoffInputFilter,inputGuardrails:e.inputGuardrails,outputGuardrails:e.outputGuardrails,tracingDisabled:e.tracingDisabled??!1,traceIncludeSensitiveData:e.traceIncludeSensitiveData??!0,workflowName:e.workflowName??"Agent workflow",traceId:e.traceId,groupId:e.groupId,traceMetadata:e.traceMetadata},this.inputGuardrailDefs=(e.inputGuardrails??[]).map(t4),this.outputGuardrailDefs=(e.outputGuardrails??[]).map(t6)}async #a(e,t,n){return rL(async()=>{let r=t instanceof rg,a=r?t:new rg(n.context instanceof nR?n.context:new nR(n.context),t,e,n.maxTurns??10),s=n.conversationId||n.previousResponseId?new rx({conversationId:n.conversationId,previousResponseId:n.previousResponseId}):void 0;s&&r&&s.primeFromState({originalInput:a._originalInput,generatedItems:a._generatedItems,modelResponses:a._modelResponses});try{for(;;){let e=void 0!==a._currentAgent.model&&""!==a._currentAgent.model||void 0!==this.config.model&&""!==this.config.model,t=rk(a._currentAgent.model,this.config.model);if("string"==typeof t&&(t=await this.config.modelProvider.getModel(t)),a._currentStep=a._currentStep??{type:"next_step_run_again"},"next_step_interruption"===a._currentStep.type){if(tN.debug("Continuing from interruption"),!a._lastTurnResponse||!a._lastProcessedResponse)throw new td("No model response found in previous state",a);let e=await n2(a._currentAgent,a._originalInput,a._generatedItems,a._lastTurnResponse,a._lastProcessedResponse,this,a);if(a._toolUseTracker.addToolUse(a._currentAgent,a._lastProcessedResponse.toolsUsed),a._originalInput=e.originalInput,a._generatedItems=e.generatedItems,a._currentStep=e.nextStep,"next_step_interruption"===e.nextStep.type)return new rC(a);continue}if("next_step_run_again"===a._currentStep.type){let r=await a._currentAgent.getEnabledHandoffs(a._context);if(!a._currentAgentSpan){let e=r.map(e=>e.agentName);a._currentAgentSpan=nW({data:{name:a._currentAgent.name,handoffs:e,output_type:a._currentAgent.outputSchemaName}}),a._currentAgentSpan.start(),rD(a._currentAgentSpan)}let i=await a._currentAgent.getAllTools(a._context),o=i.map(e=>nP(e)),l=r.map(e=>nj(e));if(a._currentAgentSpan&&(a._currentAgentSpan.spanData.tools=i.map(e=>e.name)),a._currentTurn++,a._currentTurn>a._maxTurns)throw a._currentAgentSpan?.setError({message:"Max turns exceeded",data:{max_turns:a._maxTurns}}),new tl(`Max turns (${a._maxTurns}) exceeded`,a);tN.debug(`Running agent ${a._currentAgent.name} (turn ${a._currentTurn})`),1===a._currentTurn&&await this.#s(a);let u=s?s.prepareInput(a._originalInput,a._generatedItems):rS(a._originalInput,a._generatedItems);a._noActiveAgentRun&&(a._currentAgent.emit("agent_start",a._context,a._currentAgent),this.emit("agent_start",a._context,a._currentAgent));let d={...this.config.modelSettings,...a._currentAgent.modelSettings},c=a._currentAgent.modelSettings;d=rA(e,c,t,d),d=n1(a._currentAgent,a._toolUseTracker,d);let p=s?.previousResponseId??n.previousResponseId,m=s?.conversationId??n.conversationId;a._lastTurnResponse=await t.getResponse({systemInstructions:await a._currentAgent.getSystemPrompt(a._context),prompt:await a._currentAgent.getPrompt(a._context),...e?{overridePromptModel:!0}:{},input:u,previousResponseId:p,conversationId:m,modelSettings:d,tools:o,outputType:t_(a._currentAgent.outputType),handoffs:l,tracing:rb(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:n.signal}),a._modelResponses.push(a._lastTurnResponse),a._context.usage.add(a._lastTurnResponse.usage),a._noActiveAgentRun=!1,s?.trackServerItems(a._lastTurnResponse);let h=nX(a._lastTurnResponse,a._currentAgent,i,r);a._lastProcessedResponse=h;let f=await n3(a._currentAgent,a._originalInput,a._generatedItems,a._lastTurnResponse,a._lastProcessedResponse,this,a);a._toolUseTracker.addToolUse(a._currentAgent,a._lastProcessedResponse.toolsUsed),a._originalInput=f.originalInput,a._generatedItems=f.generatedItems,a._currentStep=f.nextStep}if(a._currentStep&&"next_step_final_output"===a._currentStep.type)return await this.#i(a,a._currentStep.output),this.emit("agent_end",a._context,a._currentAgent,a._currentStep.output),a._currentAgent.emit("agent_end",a._context,a._currentStep.output),new rC(a);if(a._currentStep&&"next_step_handoff"===a._currentStep.type)a._currentAgent=a._currentStep.newAgent,a._currentAgentSpan&&(a._currentAgentSpan.end(),r$(),a._currentAgentSpan=void 0),a._noActiveAgentRun=!0,a._currentStep={type:"next_step_run_again"};else{if(a._currentStep&&"next_step_interruption"===a._currentStep.type)return new rC(a);tN.debug("Running next loop")}}}catch(e){throw a._currentAgentSpan&&a._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(e)}}),e}finally{a._currentAgentSpan&&(a._currentStep?.type!=="next_step_interruption"&&a._currentAgentSpan.end(),r$())}})}async #s(e){let t=this.inputGuardrailDefs.concat(e._currentAgent.inputGuardrails.map(t4));if(t.length>0){let n={agent:e._currentAgent,input:e._originalInput,context:e._context};try{for(let r of(await Promise.all(t.map(async t=>nB(async e=>{let r=await t.run(n);return e.spanData.triggered=r.output.tripwireTriggered,r},{data:{name:t.name}},e._currentAgentSpan)))))if(r.output.tripwireTriggered)throw e._currentAgentSpan&&e._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:r.guardrail.name}}),new tm(`Input guardrail triggered: ${JSON.stringify(r.output.outputInfo)}`,r,e)}catch(t){if(t instanceof tm)throw t;throw e._currentTurn--,new tc(`Input guardrail failed to complete: ${t}`,t,e)}}}async #i(e,t){let n=this.outputGuardrailDefs.concat(e._currentAgent.outputGuardrails.map(t6));if(n.length>0){let r=e._currentAgent.processFinalOutput(t),a={agent:e._currentAgent,agentOutput:r,context:e._context,details:{modelResponse:e._lastTurnResponse}};try{for(let t of(await Promise.all(n.map(async t=>nB(async e=>{let n=await t.run(a);return e.spanData.triggered=n.output.tripwireTriggered,n},{data:{name:t.name}},e._currentAgentSpan)))))if(t.output.tripwireTriggered)throw e._currentAgentSpan&&e._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:t.guardrail.name}}),new th(`Output guardrail triggered: ${JSON.stringify(t.output.outputInfo)}`,t,e)}catch(t){if(t instanceof th)throw t;throw new tc(`Output guardrail failed to complete: ${t}`,t,e)}}}async #o(e,t,n){let r=t.conversationId||t.previousResponseId?new rx({conversationId:t.conversationId,previousResponseId:t.previousResponseId}):void 0;r&&n&&r.primeFromState({originalInput:e.state._originalInput,generatedItems:e.state._generatedItems,modelResponses:e.state._modelResponses});try{for(;;){let n=e.state._currentAgent,a=await n.getEnabledHandoffs(e.state._context),s=await n.getAllTools(e.state._context),i=s.map(e=>nP(e)),o=a.map(e=>nj(e));if(e.state._currentStep=e.state._currentStep??{type:"next_step_run_again"},"next_step_interruption"===e.state._currentStep.type){if(tN.debug("Continuing from interruption"),!e.state._lastTurnResponse||!e.state._lastProcessedResponse)throw new td("No model response found in previous state",e.state);let t=await n2(e.state._currentAgent,e.state._originalInput,e.state._generatedItems,e.state._lastTurnResponse,e.state._lastProcessedResponse,this,e.state);if(rn(e,t),e.state._toolUseTracker.addToolUse(e.state._currentAgent,e.state._lastProcessedResponse.toolsUsed),e.state._originalInput=t.originalInput,e.state._generatedItems=t.generatedItems,e.state._currentStep=t.nextStep,"next_step_interruption"===t.nextStep.type)return;continue}if("next_step_run_again"===e.state._currentStep.type){let l;if(!e.state._currentAgentSpan){let t=a.map(e=>e.agentName);e.state._currentAgentSpan=nW({data:{name:n.name,handoffs:t,tools:s.map(e=>e.name),output_type:n.outputSchemaName}}),e.state._currentAgentSpan.start(),rD(e.state._currentAgentSpan)}if(e.state._currentTurn++,e.state._currentTurn>e.state._maxTurns)throw e.state._currentAgentSpan?.setError({message:"Max turns exceeded",data:{max_turns:e.state._maxTurns}}),new tl(`Max turns (${e.state._maxTurns}) exceeded`,e.state);tN.debug(`Running agent ${n.name} (turn ${e.state._currentTurn})`);let u=void 0!==n.model&&""!==n.model||void 0!==this.config.model&&""!==this.config.model,d=rk(n.model,this.config.model);"string"==typeof d&&(d=await this.config.modelProvider.getModel(d)),1===e.state._currentTurn&&await this.#s(e.state);let c={...this.config.modelSettings,...n.modelSettings},p=n.modelSettings;c=rA(u,p,d,c),c=n1(n,e.state._toolUseTracker,c);let m=r?r.prepareInput(e.input,e.newItems):rS(e.input,e.newItems);e.state._noActiveAgentRun&&(n.emit("agent_start",e.state._context,n),this.emit("agent_start",e.state._context,n));let h=r?.previousResponseId??t.previousResponseId,f=r?.conversationId??t.conversationId;for await(let r of d.getStreamedResponse({systemInstructions:await n.getSystemPrompt(e.state._context),prompt:await n.getPrompt(e.state._context),...u?{overridePromptModel:!0}:{},input:m,previousResponseId:h,conversationId:f,modelSettings:c,tools:i,handoffs:o,outputType:t_(n.outputType),tracing:rb(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:t.signal})){if("response_done"===r.type){let e=nO.parse(r);l={usage:new nN(e.response.usage),output:e.response.output,responseId:e.response.id}}if(e.cancelled)return;e._addItem(new nV(r))}if(e.state._noActiveAgentRun=!1,!l)throw new tu("Model did not produce a final response!",e.state);e.state._lastTurnResponse=l,r?.trackServerItems(l),e.state._modelResponses.push(e.state._lastTurnResponse);let g=nX(e.state._lastTurnResponse,n,s,a);e.state._lastProcessedResponse=g;let y=new Set(g.newItems);y.size>0&&function(e,t){for(let n of t)rt(e,n)}(e,g.newItems);let _=await n3(n,e.state._originalInput,e.state._generatedItems,e.state._lastTurnResponse,e.state._lastProcessedResponse,this,e.state);rn(e,_,{skipItems:y}),e.state._toolUseTracker.addToolUse(n,g.toolsUsed),e.state._originalInput=_.originalInput,e.state._generatedItems=_.generatedItems,e.state._currentStep=_.nextStep}if("next_step_final_output"===e.state._currentStep.type){await this.#i(e.state,e.state._currentStep.output),this.emit("agent_end",e.state._context,n,e.state._currentStep.output),n.emit("agent_end",e.state._context,e.state._currentStep.output);return}if("next_step_interruption"===e.state._currentStep.type)return;"next_step_handoff"===e.state._currentStep.type?(e.state._currentAgent=e.state._currentStep?.newAgent,e.state._currentAgentSpan&&(e.state._currentAgentSpan.end(),r$()),e.state._currentAgentSpan=void 0,e._addItem(new nY(e.state._currentAgent)),e.state._noActiveAgentRun=!0,e.state._currentStep={type:"next_step_run_again"}):tN.debug("Running next loop")}}catch(t){throw e.state._currentAgentSpan&&e.state._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(t)}}),t}finally{e.state._currentAgentSpan&&(e.state._currentStep?.type!=="next_step_interruption"&&e.state._currentAgentSpan.end(),r$())}}async #l(e,t,n){return n=n??{},rL(async()=>{let r=t instanceof rg,a=r?t:new rg(n.context instanceof nR?n.context:new nR(n.context),t,e,n.maxTurns??10),s=new rE({signal:n.signal,state:a});s.maxTurns=n.maxTurns??a._maxTurns;let i=this.#o(s,n,r).then(()=>{s._done()},e=>{s._raiseError(e)});return s._setStreamLoopPromise(i),s})}run(e,t,n={stream:!1,context:void 0}){return t instanceof rg&&t._trace?rj(t._trace,async()=>(t._currentAgentSpan&&rD(t._currentAgentSpan),n?.stream)?this.#l(e,t,n):this.#a(e,t,n)):rM(async()=>n?.stream?this.#l(e,t,n):this.#a(e,t,n),{traceId:this.config.traceId,name:this.config.workflowName,groupId:this.config.groupId,metadata:this.config.traceMetadata})}}function rk(e,t){return"string"==typeof e&&e!==t9.DEFAULT_MODEL_PLACEHOLDER||e?e:t??e??t9.DEFAULT_MODEL_PLACEHOLDER}function rA(e,t,n,r){if(tH(tY())&&e&&("string"!=typeof n||!tH(n))&&(t.providerData?.reasoning||t.providerData?.text?.verbosity||t.providerData?.reasoning_effort)){let e={...r};return delete e.providerData?.reasoning,delete e.providerData?.text?.verbosity,delete e.providerData?.reasoning_effort,e.reasoning&&(delete e.reasoning.effort,delete e.reasoning.summary),e.text&&delete e.text.verbosity,e}return r}class rT{state;constructor(e){this.state=e}get history(){return rS(this.input,this.newItems)}get output(){return rS([],this.newItems)}get input(){return this.state._originalInput}get newItems(){return this.state._generatedItems}get rawResponses(){return this.state._modelResponses}get lastResponseId(){let e=this.rawResponses;return e&&e.length>0?e[e.length-1].responseId:void 0}get lastAgent(){return this.state._currentAgent}get inputGuardrailResults(){return this.state._inputGuardrailResults}get outputGuardrailResults(){return this.state._outputGuardrailResults}get interruptions(){return this.state._currentStep?.type==="next_step_interruption"?this.state._currentStep.data.interruptions:[]}get finalOutput(){if(this.state._currentStep?.type==="next_step_final_output")return this.state._currentAgent.processFinalOutput(this.state._currentStep.output);tN.warn("Accessed finalOutput before agent run is completed.")}}class rC extends rT{constructor(e){super(e)}}class rE extends rT{get currentAgent(){return this.lastAgent}currentTurn=0;maxTurns;#u=null;#d;#c;#p;#m;#h;#f;#g=!1;#y;constructor(e={}){if(super(e.state),this.#d=e.signal,this.#p=new tU({start:e=>{this.#c=e},cancel:()=>{this.#g=!0}}),this.#m=new Promise((e,t)=>{this.#h=e,this.#f=t}),this.#d){let e=()=>{if(this.#g)return;this.#g=!0;let e=this.#c;if(this.#c=void 0,this.#p.locked){if(e)try{e.close()}catch(e){tN.debug(`Failed to close readable stream on abort: ${e}`)}}else this.#p.cancel(this.#d?.reason).catch(e=>{tN.debug(`Failed to cancel readable stream on abort: ${e}`)});this.#h?.()};this.#d.aborted?e():this.#d.addEventListener("abort",e,{once:!0})}}_addItem(e){this.cancelled||this.#c?.enqueue(e)}_done(){!this.cancelled&&this.#c&&(this.#c.close(),this.#c=void 0,this.#h?.())}_raiseError(e){!this.cancelled&&this.#c&&(this.#c.error(e),this.#c=void 0),this.#u=e,this.#f?.(e),this.#m.catch(e=>{tN.debug(`Resulted in an error: ${e}`)})}get cancelled(){return this.#g}toStream(){return this.#p}get completed(){return this.#m}get error(){return this.#u}toTextStream(e={}){let t=this.#p.pipeThrough(new tJ({transform(e,t){if("raw_model_stream_event"===e.type&&"output_text_delta"===e.data.type){let n=nC.parse(e.data);t.enqueue(n.delta)}}}));return e.compatibleWithNodeStreams?tz.fromWeb(t):t}[Symbol.asyncIterator](){return this.#p[Symbol.asyncIterator]()}_setStreamLoopPromise(e){this.#y=e}_getStreamLoopPromise(){return this.#y}}function rO(){return i??=new tW}function rN(){let e=rO().getStore();return e?.trace?e.trace:null}function rR(){let e=rO().getStore();return e?.span?e.span:null}function rP(e){return async()=>{let t=rN();if(!t)throw Error("No trace found");await t.start();let n=await e(t);if(n instanceof rE){let e=n._getStreamLoopPromise();if(e)return e.finally(()=>t.end()),n}return await t.end(),n}}async function rj(e,t,n={}){let r="string"==typeof e?r1().createTrace({...n,name:e}):e;return rO().run({trace:r},rP(t))}async function rM(e,t={}){if(rN())return await e();let n=r1().createTrace(t);return rO().run({trace:n},rP(e))}function rD(e){let t=rO().getStore();if(!t)throw Error("No existing trace found");t.span&&(t.span.previousSpan=t.previousSpan,t.previousSpan=t.span),t.span=e,rO().enterWith(t)}function r$(){let e=rO().getStore();e&&(e.span=e.previousSpan,e.previousSpan=e.previousSpan?.previousSpan,rO().enterWith(e))}function rF(e){let t=rR();t&&t.setError(e)}function rL(e){let t=rO().getStore();if(!t)throw Error("No existing trace found");let n={trace:t.trace?.clone(),span:t.span?.clone(),previousSpan:t.previousSpan?.clone()};return rO().run(n,e)}class rZ{async export(e){if(tA.disabled)return void tN.debug("Tracing is disabled. Skipping export");for(let t of e)"trace"===t.type?console.log(`[Exporter] Export trace traceId=${t.traceId} name=${t.name}${t.groupId?` groupId=${t.groupId}`:""}`):console.log(`[Exporter] Export span: ${JSON.stringify(t)}`)}}class rz{#_;#v;#b;#w;#x;#S=[];#I;#k=null;#A=!1;#T=null;constructor(e,{maxQueueSize:t=1e3,maxBatchSize:n=100,scheduleDelay:r=5e3,exportTriggerRatio:a=.8}={}){this.#_=t,this.#v=n,this.#b=r,this.#w=t*a,this.#x=e,this.#I=tG,tN.debug("Automatic trace export loop is not supported in this environment. You need to manually call `getGlobalTraceProvider().forceFlush()` to export traces.")}start(){this.#T=new AbortController,this.#C()}async #E(e){if(this.#S.length+1>this.#_)return void tN.error("Dropping trace because buffer is full");this.#S.push(e),this.#S.length>this.#w&&await this.#O()}#C(){this.#k=this.#I.setTimeout(async()=>{await this.#O(),this.#C()},this.#b),"function"==typeof this.#k.unref&&this.#k.unref()}async #O(e=!1){if(0!==this.#S.length){if(tN.debug(`Exporting batches. Force: ${e}. Buffer size: ${this.#S.length}`),e||this.#S.length<this.#v){let e=[...this.#S];this.#S=[],this.#A=!0,await this.#x.export(e),this.#A=!1}else if(this.#S.length>0){let e=this.#S.splice(0,this.#v);this.#A=!0,await this.#x.export(e),this.#A=!1}}}async onTraceStart(e){await this.#E(e)}async onTraceEnd(e){}async onSpanStart(e){}async onSpanEnd(e){await this.#E(e)}async shutdown(e){for(e&&this.#I.setTimeout(()=>{this.#T?.abort()},e),tN.debug("Shutting down gracefully");this.#S.length>0;){if(tN.debug(`Waiting for buffer to empty. Items left: ${this.#S.length}`),this.#A||await this.#O(!0),this.#T?.signal.aborted){tN.debug("Timeout reached, force flushing"),await this.#O(!0);break}await new Promise(e=>this.#I.setTimeout(e,500))}tN.debug("Buffer empty. Exiting"),this.#I&&this.#k&&this.#I.clearTimeout(this.#k)}async forceFlush(){this.#S.length>0&&await this.#O(!0)}}class rU{#N=[];start(){for(let e of this.#N)e.start&&e.start()}addTraceProcessor(e){this.#N.push(e)}setProcessors(e){for(let e of(tN.debug("Shutting down old processors"),this.#N))e.shutdown();this.#N=e}async onTraceStart(e){for(let t of this.#N)await t.onTraceStart(e)}async onTraceEnd(e){for(let t of this.#N)await t.onTraceEnd(e)}async onSpanStart(e){for(let t of this.#N)await t.onSpanStart(e)}async onSpanEnd(e){for(let t of this.#N)await t.onSpanEnd(e)}async shutdown(e){for(let t of this.#N)await t.shutdown(e)}async forceFlush(){for(let e of this.#N)await e.forceFlush()}}let rJ=null,rW=null;function rq(){return rW||(rW=new rz((!rJ&&(rJ=new rZ),rJ))),rW}function rG(){return new Date().toISOString()}function rB(){return`trace_${tZ().replace(/-/g,"")}`}class rK{type="trace.span";#R;#P;#j;#M;#D;#$;#F;#u;#L;constructor(e,t){this.#P=e.traceId,this.#j=e.spanId??`span_${tZ().replace(/-/g,"").slice(0,24)}`,this.#R=e.data,this.#D=t,this.#M=e.parentId??null,this.#u=e.error??null,this.#$=e.startedAt??null,this.#F=e.endedAt??null}get traceId(){return this.#P}get spanData(){return this.#R}get spanId(){return this.#j}get parentId(){return this.#M}get previousSpan(){return this.#L}set previousSpan(e){this.#L=e}start(){if(this.#$)return void tN.warn("Span already started");this.#$=rG(),this.#D.onSpanStart(this)}end(){if(this.#F)return void tN.debug("Span already finished",this.spanData);this.#F=rG(),this.#D.onSpanEnd(this)}setError(e){this.#u=e}get error(){return this.#u}get startedAt(){return this.#$}get endedAt(){return this.#F}clone(){let e=new rK({traceId:this.traceId,spanId:this.spanId,parentId:this.parentId??void 0,data:this.spanData,startedAt:this.#$??void 0,endedAt:this.#F??void 0,error:this.#u??void 0},this.#D);return e.previousSpan=this.previousSpan?.clone(),e}toJSON(){return{object:this.type,id:this.spanId,trace_id:this.traceId,parent_id:this.parentId,started_at:this.startedAt,ended_at:this.endedAt,span_data:Object.fromEntries(Object.entries(this.spanData).filter(([e])=>!e.startsWith("_"))),error:this.error}}}class rV extends rK{constructor(e,t){super({traceId:"no-op",spanId:"no-op",data:e},t)}start(){}end(){}setError(){}toJSON(){return null}}class rH{type="trace";traceId;name;groupId=null;metadata;#D;#Z;constructor(e,t){this.traceId=e.traceId??rB(),this.name=e.name??"Agent workflow",this.groupId=e.groupId??null,this.metadata=e.metadata??{},this.#D=t??rq(),this.#Z=e.started??!1}async start(){this.#Z||(this.#Z=!0,await this.#D.onTraceStart(this))}async end(){this.#Z&&(this.#Z=!1,await this.#D.onTraceEnd(this))}clone(){return new rH({traceId:this.traceId,name:this.name,groupId:this.groupId??void 0,metadata:this.metadata,started:this.#Z})}toJSON(){return{object:this.type,id:this.traceId,workflow_name:this.name,group_id:this.groupId,metadata:this.metadata}}}class rY extends rH{constructor(){super({})}async start(){}async end(){}toJSON(){return null}}var rX=n(5704);class rQ{#z;#U;constructor(){this.#z=new rU,this.#U=tA.disabled,this.#J()}registerProcessor(e){this.#z.addTraceProcessor(e)}setProcessors(e){this.#z.setProcessors(e)}getCurrentTrace(){return rN()}getCurrentSpan(){return rR()}setDisabled(e){this.#U=e}startExportLoop(){this.#z.start()}createTrace(e){if(this.#U)return tN.debug("Tracing is disabled, Not creating trace %o",e),new rY;let t=e.traceId??rB(),n=e.name??"Agent workflow";return tN.debug("Creating trace %s with name %s",t,n),new rH({...e,name:n,traceId:t},this.#z)}createSpan(e,t){let n,r;if(this.#U||e.disabled)return tN.debug("Tracing is disabled, Not creating span %o",e),new rV(e.data,this.#z);if(t){if(t instanceof rH){if(t instanceof rY)return tN.debug("Parent trace is no-op, returning NoopSpan"),new rV(e.data,this.#z);r=t.traceId}else if(t instanceof rK){if(t instanceof rV)return tN.debug("Parent span is no-op, returning NoopSpan"),new rV(e.data,this.#z);n=t.spanId,r=t.traceId}}else{let t=rN(),a=rR();if(!t)return tN.error("No active trace. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new rV(e.data,this.#z);if(a instanceof rV||t instanceof rY)return tN.debug(`Parent ${a} or ${t} is no-op, returning NoopSpan`),new rV(e.data,this.#z);r=t.traceId,a?(tN.debug("Using parent span %s",a.spanId),n=a.spanId):tN.debug("No parent span, using current trace %s",t.traceId)}return r?(tN.debug(`Creating span ${JSON.stringify(e.data)} with id ${e.spanId??r}`),new rK({...e,traceId:r,parentId:n},this.#z)):(tN.error("No traceId found. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new rV(e.data,this.#z))}async shutdown(e){try{tN.debug("Shutting down tracing provider"),await this.#z.shutdown(e)}catch(e){tN.error("Error shutting down tracing provider %o",e)}}#J(){if(void 0!==rX&&"function"==typeof rX.on){let e=async()=>{let e=setTimeout(()=>{console.warn("Cleanup timeout, forcing exit"),rX.exit(1)},5e3);try{await this.shutdown()}finally{clearTimeout(e)}};rX.on("beforeExit",e),rX.on("SIGINT",async()=>{await e(),r0("SIGINT")||rX.exit(130)}),rX.on("SIGTERM",async()=>{await e(),r0("SIGTERM")||rX.exit(0)}),rX.on("unhandledRejection",async(t,n)=>{var r;tN.error("Unhandled rejection",t,n),await e(),r="unhandledRejection",rX.listeners(r).length>1||rX.exit(1)})}}async forceFlush(){await this.#z.forceFlush()}}function r0(e){return rX.listeners(e).length>1}function r1(){return o||(o=new rQ),o}function r2(e){return"system"===e.role?e:"assistant"===e.role?{...e,content:e.content.map(e=>"output_audio"===e.type?{...e,audio:null}:e)}:"user"===e.role?{...e,content:e.content.map(e=>"input_audio"===e.type?{...e,audio:null}:e)}:e}function r3(e,t,n){if("conversation.item.input_audio_transcription.completed"===t.type)return e.map(e=>{if(e.itemId===t.item_id&&"message"===e.type&&"role"in e&&"user"===e.role){let n=e.content.map(e=>"input_audio"===e.type?{...e,transcript:t.transcript}:e);return{...e,content:n,status:"completed"}}return e});let r=n||"message"!==t.type?t:r2(t),a=e.findIndex(e=>e.itemId===t.itemId);if(-1!==a)return e.map((e,t)=>t===a?r:n||"message"!==e.type?e:r2(e));if(!t.previousItemId)return[...e,r];{let n=e.findIndex(e=>e.itemId===t.previousItemId);return -1!==n?[...e.slice(0,n+1),r,...e.slice(n+1)]:[...e,r]}}tv=rq(),r1().registerProcessor(tv);let r9={"User-Agent":`Agents/JavaScript ${l.version}`,"X-OpenAI-Agents-SDK":`openai-agents-sdk.${l.version}`},r4=`openai-agents-sdk.${l.version}`;function r6(e){let{name:t,arguments:n,providerData:r}=e.rawItem,{itemId:a,serverLabel:s,...i}=r??{};if(!a||!s)throw Error("Invalid approval item for Realtime MCP approval request");return{type:"mcp_approval_request",itemId:a,serverLabel:s,...i,name:t,arguments:n?JSON.parse(n):{},approved:null}}class r5 extends t9{voice;constructor(e){super(e),this.voice=e.voice}}function r7({policyHint:e,...t}){let n=t6(t),r=e??n.name;return{...n,policyHint:r,run:async e=>{let t=await n.run(e);return{...t,guardrail:{...t.guardrail,policyHint:r}}}}}function r8(e,t){return e in t&&void 0!==t[e]}function ae(e){if(!e)return;if("object"==typeof e)return e;let t=String(e);return"pcm16"===t?{type:"audio/pcm",rate:24e3}:"g711_ulaw"===t?{type:"audio/pcmu"}:"g711_alaw"===t?{type:"audio/pcma"}:{type:"audio/pcm",rate:24e3}}eG({itemId:ez()});let at=eK("role",[eG({itemId:ez(),previousItemId:ez().nullable().optional(),type:eY("message"),role:eY("system"),content:eq(eG({type:eY("input_text"),text:ez()}))}),eG({itemId:ez(),previousItemId:ez().nullable().optional(),type:eY("message"),role:eY("user"),status:eX(["in_progress","completed"]),content:eq(eG({type:eY("input_text"),text:ez()}).or(eG({type:eY("input_audio"),audio:ez().nullable().optional(),transcript:ez().nullable()})))}),eG({itemId:ez(),previousItemId:ez().nullable().optional(),type:eY("message"),role:eY("assistant"),status:eX(["in_progress","completed","incomplete"]),content:eq(eG({type:eY("output_text"),text:ez()}).or(eG({type:eY("output_audio"),audio:ez().nullable().optional(),transcript:ez().nullable().optional()})))})]),an=eG({itemId:ez(),previousItemId:ez().nullable().optional(),type:eY("function_call"),status:eX(["in_progress","completed","incomplete"]),arguments:ez(),name:ez(),output:ez().nullable()}),ar=eG({itemId:ez(),previousItemId:ez().nullable().optional(),type:eX(["mcp_call","mcp_tool_call"]),status:eX(["in_progress","completed","incomplete"]),arguments:ez(),name:ez(),output:ez().nullable()}),aa=eG({itemId:ez(),type:eY("mcp_approval_request"),serverLabel:ez(),name:ez(),arguments:eV(ez(),eW()),approved:eJ().optional().nullable()}),as=tO("openai-agents:realtime"),ai=eG({id:ez().optional().nullable(),conversation_id:ez().optional().nullable(),max_output_tokens:eU().or(eY("inf")).optional().nullable(),metadata:eV(ez(),eW()).optional().nullable(),output_modalities:eq(ez()).optional().nullable(),object:eY("realtime.response").optional().nullable(),output:eq(eW()).optional().nullable(),audio:eG({output:eG({format:eW().optional().nullable(),voice:ez().optional().nullable()}).optional().nullable()}).optional().nullable(),status:eX(["completed","incomplete","failed","cancelled","in_progress"]).optional().nullable(),status_details:eV(ez(),eW()).optional().nullable(),usage:eG({input_tokens:eU().optional(),input_token_details:eV(ez(),eW()).optional().nullable(),output_tokens:eU().optional(),output_token_details:eV(ez(),eW()).optional().nullable()}).optional().nullable()}),ao=eG({id:ez().optional(),audio:ez().nullable().optional(),text:ez().nullable().optional(),transcript:ez().nullable().optional(),type:eB([eY("input_text"),eY("input_audio"),eY("item_reference"),eY("output_text"),eY("output_audio")])}),al=eG({id:ez().optional(),arguments:ez().optional(),call_id:ez().optional(),content:eq(ao).optional(),name:ez().optional(),output:ez().nullable().optional(),role:eX(["user","assistant","system"]).optional(),status:eX(["completed","incomplete","in_progress"]).optional(),type:eX(["message","function_call","function_call_output","mcp_list_tools","mcp_tool_call","mcp_call","mcp_approval_request","mcp_approval_response"]).optional(),approval_request_id:ez().nullable().optional(),approve:eJ().nullable().optional(),reason:ez().nullable().optional(),server_label:ez().optional(),error:eW().nullable().optional(),tools:eq(eG({name:ez(),description:ez(),input_schema:eV(eW()).optional()}).passthrough()).optional()}).passthrough(),au=eG({type:eY("conversation.created"),event_id:ez(),conversation:eG({id:ez().optional(),object:eY("realtime.conversation").optional()})}),ad=eG({type:eY("conversation.item.added"),event_id:ez(),item:al,previous_item_id:ez().nullable().optional()}),ac=eG({type:eY("conversation.item.done"),event_id:ez(),item:al,previous_item_id:ez().nullable().optional()}),ap=eG({type:eY("conversation.item.deleted"),event_id:ez(),item_id:ez()}),am=eG({type:eY("conversation.item.input_audio_transcription.completed"),event_id:ez(),item_id:ez(),content_index:eU(),transcript:ez(),logprobs:eq(eW()).nullable().optional()}),ah=eG({type:eY("conversation.item.input_audio_transcription.delta"),event_id:ez(),item_id:ez(),content_index:eU().optional(),delta:ez().optional(),logprobs:eq(eW()).nullable().optional()}),af=eG({type:eY("conversation.item.input_audio_transcription.failed"),event_id:ez(),item_id:ez(),content_index:eU(),error:eG({code:ez().optional(),message:ez().optional(),param:ez().optional(),type:ez().optional()})}),ag=eG({type:eY("conversation.item.retrieved"),event_id:ez(),item:al}),ay=eG({type:eY("conversation.item.truncated"),event_id:ez(),item_id:ez(),audio_end_ms:eU(),content_index:eU()}),a_=eG({type:eY("conversation.item.create"),item:al,event_id:ez().optional(),previous_item_id:ez().nullable().optional()}),av=eG({type:eY("conversation.item.delete"),item_id:ez(),event_id:ez().optional()}),ab=eG({type:eY("conversation.item.retrieve"),item_id:ez(),event_id:ez().optional()}),aw=eG({type:eY("conversation.item.truncate"),item_id:ez(),audio_end_ms:eU(),content_index:eU(),event_id:ez().optional()}),ax=eG({type:eY("error"),event_id:ez().optional(),error:eW().optional()}),aS=eG({type:eY("input_audio_buffer.cleared"),event_id:ez()}),aI=eG({type:eY("input_audio_buffer.append"),audio:ez(),event_id:ez().optional()}),ak=eG({type:eY("input_audio_buffer.clear"),event_id:ez().optional()}),aA=eG({type:eY("input_audio_buffer.commit"),event_id:ez().optional()}),aT=eG({type:eY("input_audio_buffer.committed"),event_id:ez(),item_id:ez(),previous_item_id:ez().nullable().optional()}),aC=eG({type:eY("input_audio_buffer.speech_started"),event_id:ez(),item_id:ez(),audio_start_ms:eU()}),aE=eG({type:eY("input_audio_buffer.speech_stopped"),event_id:ez(),item_id:ez(),audio_end_ms:eU()}),aO=eG({type:eY("output_audio_buffer.started"),event_id:ez()}).passthrough(),aN=eG({type:eY("output_audio_buffer.stopped"),event_id:ez()}).passthrough(),aR=eG({type:eY("output_audio_buffer.cleared"),event_id:ez()}),aP=eG({type:eY("rate_limits.updated"),event_id:ez(),rate_limits:eq(eG({limit:eU().optional(),name:eX(["requests","tokens"]).optional(),remaining:eU().optional(),reset_seconds:eU().optional()}))}),aj=eG({type:eY("response.output_audio.delta"),event_id:ez(),item_id:ez(),content_index:eU(),delta:ez(),output_index:eU(),response_id:ez()}),aM=eG({type:eY("response.output_audio.done"),event_id:ez(),item_id:ez(),content_index:eU(),output_index:eU(),response_id:ez()}),aD=eG({type:eY("response.output_audio_transcript.delta"),event_id:ez(),item_id:ez(),content_index:eU(),delta:ez(),output_index:eU(),response_id:ez()}),a$=eG({type:eY("response.output_audio_transcript.done"),event_id:ez(),item_id:ez(),content_index:eU(),transcript:ez(),output_index:eU(),response_id:ez()}),aF=eG({type:eY("response.content_part.added"),event_id:ez(),item_id:ez(),content_index:eU(),output_index:eU(),response_id:ez(),part:eG({audio:ez().optional(),text:ez().optional(),transcript:ez().optional(),type:eX(["text","audio"]).optional()})}),aL=eG({type:eY("response.content_part.done"),event_id:ez(),item_id:ez(),content_index:eU(),output_index:eU(),response_id:ez(),part:eG({audio:ez().optional(),text:ez().optional(),transcript:ez().optional(),type:eX(["text","audio"]).optional()})}),aZ=eG({type:eY("response.created"),event_id:ez(),response:ai}),az=eG({type:eY("response.done"),event_id:ez(),response:ai}),aU=eG({type:eY("response.function_call_arguments.delta"),event_id:ez(),item_id:ez(),call_id:ez(),delta:ez(),output_index:eU(),response_id:ez()}),aJ=eG({type:eY("response.function_call_arguments.done"),event_id:ez(),item_id:ez(),call_id:ez(),arguments:ez(),output_index:eU(),response_id:ez()}),aW=eG({type:eY("response.output_item.added"),event_id:ez(),item:al,output_index:eU(),response_id:ez()}),aq=eG({type:eY("response.output_item.done"),event_id:ez(),item:al,output_index:eU(),response_id:ez()}),aG=eG({type:eY("response.output_text.delta"),event_id:ez(),item_id:ez(),content_index:eU(),delta:ez(),output_index:eU(),response_id:ez()}),aB=eG({type:eY("response.output_text.done"),event_id:ez(),item_id:ez(),content_index:eU(),text:ez(),output_index:eU(),response_id:ez()}),aK=eG({type:eY("session.created"),event_id:ez(),session:eW()}),aV=eG({type:eY("session.updated"),event_id:ez(),session:eW()}),aH=eG({type:eY("response.cancel"),event_id:ez().optional(),response_id:ez().optional()}),aY=eG({type:eY("response.create"),event_id:ez().optional(),response:eW().optional()}),aX=eG({type:eY("session.update"),event_id:ez().optional(),session:eW()}),aQ=eG({type:eY("mcp_list_tools.in_progress"),event_id:ez().optional(),item_id:ez().optional()}),a0=eG({type:eY("mcp_list_tools.completed"),event_id:ez().optional(),item_id:ez().optional()}),a1=eG({type:eY("response.mcp_call_arguments.delta"),event_id:ez(),response_id:ez(),item_id:ez(),output_index:eU(),delta:ez(),obfuscation:ez()}),a2=eG({type:eY("response.mcp_call_arguments.done"),event_id:ez(),response_id:ez(),item_id:ez(),output_index:eU(),arguments:ez()}),a3=eG({type:eY("response.mcp_call.in_progress"),event_id:ez(),output_index:eU(),item_id:ez()}),a9=eG({type:eY("response.mcp_call.completed"),event_id:ez(),output_index:eU(),item_id:ez()}),a4=eG({type:eY("mcp_list_tools.failed"),event_id:ez().optional(),item_id:ez().optional()}),a6=eG({type:ez(),event_id:ez().optional().nullable()}).passthrough(),a5=eK("type",[au,ad,ac,ap,am,ah,af,ag,ay,ax,aS,aT,aC,aE,aO,aN,aR,aP,aj,aM,aD,a$,aF,aL,aZ,az,aU,aJ,aW,aq,aG,aB,aK,aV,aQ,a0,a4,a1,a2,a3,a9]);function a7(e){let t=JSON.parse(e.data.toString()),n=a5.safeParse(t);if(!n.success){let e=a6.safeParse(t);return e.success?{data:e.data,isGeneric:!0}:{data:null,isGeneric:!0}}return{data:n.data,isGeneric:!1}}eK("type",[a_,av,ab,aw,aI,ak,aA,aH,aY,aX]);let a8={outputModalities:["audio"],audio:{input:{format:{type:"audio/pcm",rate:24e3},transcription:{model:"gpt-4o-mini-transcribe"},turnDetection:{type:"semantic_vad"},noiseReduction:null},output:{format:{type:"audio/pcm",rate:24e3},speed:1}}};class se extends tB{#W;#q;#G=null;#B=null;eventEmitter=new tL;constructor(e={}){super(),this.#W=e.model??"gpt-realtime",this.#q=e.apiKey}get currentModel(){return this.#W}set currentModel(e){this.#W=e}get _rawSessionConfig(){return this.#B??null}async _getApiKey(e){let t=e.apiKey??this.#q;return"function"==typeof t?await t():t}_onMessage(e){let{data:t,isGeneric:n}=a7(e);if(null!==t&&(this.emit("*",t),!n)){if("error"===t.type?this.emit("error",{type:"error",error:t}):this.emit(t.type,t),"response.created"===t.type)return void this.emit("turn_started",{type:"response_started",providerData:{...t}});if("session.updated"===t.type&&(this.#B=t.session),"response.done"===t.type){let e=az.safeParse(t);if(!e.success)return void as.error("Error parsing response done event",e.error);let n=e.data.response.usage?.input_tokens??0,r=e.data.response.usage?.output_tokens??0,a=n+r,s=new nN({inputTokens:n,inputTokensDetails:e.data.response.usage?.input_token_details??{},outputTokens:r,outputTokensDetails:e.data.response.usage?.output_token_details??{},totalTokens:a});return this.emit("usage_update",s),void this.emit("turn_done",{type:"response_done",response:{id:e.data.response.id??"",output:e.data.response.output??[],usage:{inputTokens:n,inputTokensDetails:e.data.response.usage?.input_token_details??{},outputTokens:r,outputTokensDetails:e.data.response.usage?.output_token_details??{},totalTokens:a}}})}if("response.output_audio.done"===t.type)return void this.emit("audio_done");if("conversation.item.deleted"===t.type)return void this.emit("item_deleted",{itemId:t.item_id});if("conversation.item.input_audio_transcription.completed"===t.type||"conversation.item.truncated"===t.type)return void this.sendEvent({type:"conversation.item.retrieve",item_id:t.item_id});if("conversation.item.input_audio_transcription.delta"===t.type||"response.output_text.delta"===t.type||"response.output_audio_transcript.delta"===t.type||"response.function_call_arguments.delta"===t.type){"response.output_audio_transcript.delta"===t.type&&this.emit("audio_transcript_delta",{type:"transcript_delta",delta:t.delta,itemId:t.item_id,responseId:t.response_id});return}if("conversation.item.added"===t.type||"conversation.item.done"===t.type||"conversation.item.retrieved"===t.type){if("mcp_list_tools"===t.item.type&&"conversation.item.done"===t.type){let e=t.item.server_label??"",n=t.item.tools??[];try{this.emit("mcp_tools_listed",{serverLabel:e,tools:n})}catch(e){as.error("Error emitting mcp_tools_listed",e,t.item)}return}if("message"===t.item.type){let e="conversation.item.added"===t.type||"conversation.item.done"===t.type?t.previous_item_id:null,n=at.parse({itemId:t.item.id,previousItemId:e,type:t.item.type,role:t.item.role,content:t.item.content,status:t.item.status});this.emit("item_update",n);return}if("mcp_approval_request"===t.item.type&&"conversation.item.done"===t.type){let e=t.item,n=aa.parse({itemId:e.id,type:e.type,serverLabel:e.server_label,name:e.name,arguments:JSON.parse(e.arguments||"{}"),approved:e.approved});this.emit("item_update",n),this.emit("mcp_approval_request",n);return}if("mcp_tool_call"===t.item.type||"mcp_call"===t.item.type){let e="conversation.item.done"===t.type?"completed":"in_progress",n=ar.parse({itemId:t.item.id,type:t.item.type,status:e,arguments:t.item.arguments,name:t.item.name,output:t.item.output});this.emit("item_update",n),"conversation.item.done"===t.type&&this.emit("mcp_tool_call_completed",n);return}}if("response.mcp_call.in_progress"===t.type)return void this.sendEvent({type:"conversation.item.retrieve",item_id:t.item_id});if("mcp_list_tools.in_progress"===t.type){t.item_id&&this.sendEvent({type:"conversation.item.retrieve",item_id:t.item_id});return}if("response.output_item.done"===t.type||"response.output_item.added"===t.type){let e=t.item;if("function_call"===e.type&&"completed"===e.status){let t=an.parse({itemId:e.id,type:e.type,status:"in_progress",arguments:e.arguments,name:e.name,output:null});this.emit("item_update",t),this.emit("function_call",{id:e.id,type:"function_call",callId:e.call_id??"",arguments:e.arguments??"",name:e.name??""});return}if("mcp_tool_call"===e.type||"mcp_call"===e.type){let n=ar.parse({itemId:e.id,type:e.type,status:"response.output_item.done"===t.type?"completed":"in_progress",arguments:e.arguments,name:e.name,output:e.output});this.emit("item_update",n);return}if("message"===e.type){let n=at.parse({itemId:t.item.id,type:t.item.type,role:t.item.role,content:t.item.content,status:"response.output_item.done"===t.type?e.status??"completed":e.status??"in_progress"});this.emit("item_update",n);return}}}}_onError(e){this.emit("error",{type:"error",error:e})}_onOpen(){this.emit("connected")}_onClose(){this.emit("disconnected")}sendMessage(e,t,{triggerResponse:n=!0}={}){let r="string"==typeof e?[{type:"input_text",text:e}]:e.content.map(e=>"input_image"===e.type?{type:"input_image",image_url:e.image,...e.providerData??{}}:e);this.sendEvent({type:"conversation.item.create",item:{type:"message",role:"user",content:r},...t}),n&&this.sendEvent({type:"response.create"})}addImage(e,{triggerResponse:t=!0}={}){this.sendMessage({type:"message",role:"user",content:[{type:"input_image",image:e}]},{},{triggerResponse:t})}_getMergedSessionConfig(e){let t=function(e){if(!(r8("modalities",e)||r8("inputAudioFormat",e)||r8("outputAudioFormat",e)||r8("inputAudioTranscription",e)||r8("turnDetection",e)||r8("inputAudioNoiseReduction",e)||r8("speed",e))){let t=e.audio?.input?{format:ae(e.audio.input.format),noiseReduction:e.audio.input.noiseReduction??null,transcription:e.audio.input.transcription,turnDetection:e.audio.input.turnDetection}:void 0,n=e.audio?.output?.voice??e.voice,r=e.audio?.output||void 0!==n?{format:ae(e.audio?.output?.format),voice:n,speed:e.audio?.output?.speed}:void 0;return{model:e.model,instructions:e.instructions,toolChoice:e.toolChoice,tools:e.tools,tracing:e.tracing,providerData:e.providerData,prompt:e.prompt,outputModalities:e.outputModalities,audio:t||r?{input:t,output:r}:void 0}}return{model:e.model,instructions:e.instructions,toolChoice:e.toolChoice,tools:e.tools,tracing:e.tracing,providerData:e.providerData,prompt:e.prompt,outputModalities:e.modalities,audio:{input:{format:ae(e.inputAudioFormat),noiseReduction:e.inputAudioNoiseReduction??null,transcription:e.inputAudioTranscription,turnDetection:e.turnDetection},output:{format:ae(e.outputAudioFormat),voice:e.voice,speed:e.speed}}}}(e),n={type:"realtime",instructions:t.instructions,model:t.model??this.#W,output_modalities:t.outputModalities??a8.outputModalities,audio:{input:{format:t.audio?.input?.format??a8.audio?.input?.format,noise_reduction:t.audio?.input?.noiseReduction??a8.audio?.input?.noiseReduction,transcription:t.audio?.input?.transcription??a8.audio?.input?.transcription,turn_detection:se.buildTurnDetectionConfig(t.audio?.input?.turnDetection)??a8.audio?.input?.turnDetection},output:{format:t.audio?.output?.format??a8.audio?.output?.format,voice:t.audio?.output?.voice??a8.audio?.output?.voice,speed:t.audio?.output?.speed??a8.audio?.output?.speed}},tool_choice:t.toolChoice??a8.toolChoice,...t.providerData??{}};return t.prompt&&(n.prompt={id:t.prompt.promptId,version:t.prompt.version,variables:t.prompt.variables}),t.tools&&t.tools.length>0&&(n.tools=t.tools.map(e=>({...e,strict:void 0}))),n}static buildTurnDetectionConfig(e){if(void 0===e)return;let{type:t,createResponse:n,create_response:r,eagerness:a,interruptResponse:s,interrupt_response:i,prefixPaddingMs:o,prefix_padding_ms:l,silenceDurationMs:u,silence_duration_ms:d,threshold:c,idleTimeoutMs:p,idle_timeout_ms:m,...h}=e,f={type:t,create_response:n||r,eagerness:a,interrupt_response:s||i,prefix_padding_ms:o||l,silence_duration_ms:u||d,idle_timeout_ms:p||m,threshold:c,...h};return Object.keys(f).forEach(e=>{void 0===f[e]&&delete f[e]}),Object.keys(f).length>0?f:void 0}set _tracingConfig(e){this.#G=e}_updateTracingConfig(e){if(void 0===this.#G&&(this.#G=null),"auto"===e)return void this.sendEvent({type:"session.update",session:{type:"realtime",tracing:"auto"}});if(null!==this.#G&&"string"!=typeof this.#G&&"string"!=typeof e)return void as.warn("Tracing config is already set, skipping setting it again. This likely happens when you already set a tracing config on session creation.");if(null===e){as.debug("Disabling tracing for this session. It cannot be turned on for this session from this point on."),this.sendEvent({type:"session.update",session:{type:"realtime",tracing:null}});return}return null===this.#G||"string"==typeof this.#G?void this.sendEvent({type:"session.update",session:{type:"realtime",tracing:e}}):e?.group_id!==this.#G?.group_id||e?.metadata!==this.#G?.metadata||e?.workflow_name!==this.#G?.workflow_name?void as.warn("Mismatch in tracing config. Ignoring the new tracing config. This likely happens when you already set a tracing config on session creation. Current tracing config: %s, new tracing config: %s",JSON.stringify(this.#G),JSON.stringify(e)):void this.sendEvent({type:"session.update",session:{type:"realtime",tracing:e}})}updateSessionConfig(e){let t=this._getMergedSessionConfig(e);this.sendEvent({type:"session.update",session:t})}sendFunctionCallOutput(e,t,n=!0){this.sendEvent({type:"conversation.item.create",item:{type:"function_call_output",output:t,call_id:e.callId}});try{let n=an.parse({itemId:e.id,previousItemId:e.previousItemId,type:"function_call",status:"completed",arguments:e.arguments,name:e.name,output:t});this.emit("item_update",n)}catch(t){as.error("Error parsing tool call item",t,e)}n&&this.sendEvent({type:"response.create"})}sendAudio(e,{commit:t=!1}={}){this.sendEvent({type:"input_audio_buffer.append",audio:btoa(String.fromCharCode(...new Uint8Array(e)))}),t&&this.sendEvent({type:"input_audio_buffer.commit"})}resetHistory(e,t){let{removals:n,additions:r,updates:a}=function(e,t){let n=e.filter(e=>!t.some(t=>t.itemId===e.itemId));return{removals:n,additions:t.filter(t=>!e.some(e=>e.itemId===t.itemId)),updates:t.filter(t=>e.some(e=>e.itemId===t.itemId&&JSON.stringify(e)!==JSON.stringify(t)))}}(e,t),s=new Set(n.map(e=>e.itemId));for(let e of a)s.add(e.itemId);if(s.size>0)for(let e of s)this.sendEvent({type:"conversation.item.delete",item_id:e});for(let e of[...r,...a])if("message"===e.type){let t={type:"message",role:e.role,content:e.content,id:e.itemId};"system"!==e.role&&e.status&&(t.status=e.status),this.sendEvent({type:"conversation.item.create",item:t})}else"function_call"===e.type&&as.warn("Function calls cannot be manually added or updated at the moment. Ignoring.")}sendMcpResponse(e,t){this.sendEvent({type:"conversation.item.create",previous_item_id:e.itemId,item:{type:"mcp_approval_response",approval_request_id:e.itemId,approve:t}})}}class st extends se{options;#K;#V={status:"disconnected",peerConnection:void 0,dataChannel:void 0,callId:void 0};#H;#Y=!1;#X=!1;constructor(e={}){if("undefined"==typeof RTCPeerConnection)throw Error("WebRTC is not supported in this environment");super(e),this.options=e,this.#K=e.baseUrl??"https://api.openai.com/v1/realtime/calls",this.#H=e.useInsecureApiKey??!1}get callId(){return this.#V.callId}get status(){return this.#V.status}get connectionState(){return this.#V}get muted(){return this.#X}async connect(e){if("connected"===this.#V.status)return;"connecting"===this.#V.status&&as.warn("Realtime connection already in progress. Please await original promise");let t=e.model??this.currentModel;this.currentModel=t;let n=e.url??this.#K,r=await this._getApiKey(e),a="string"==typeof r&&r.startsWith("ek_");if(!this.#H&&!a)throw new td("Using the WebRTC connection in a browser environment requires an ephemeral client key. If you need to use a regular API key, use the WebSocket transport or set the `useInsecureApiKey` option to true.");return new Promise(async(t,a)=>{try{let s,i={...e.initialSessionConfig||{},model:this.currentModel},o=new URL(n),l=new RTCPeerConnection,u=l.createDataChannel("oai-events");this.#V={status:"connecting",peerConnection:l,dataChannel:u,callId:s},this.emit("connection_change",this.#V.status),u.addEventListener("open",()=>{this.#V={status:"connected",peerConnection:l,dataChannel:u,callId:s},this.updateSessionConfig(i),this.emit("connection_change",this.#V.status),this._onOpen(),t()}),u.addEventListener("error",e=>{this.close(),this._onError(e),a(e)}),u.addEventListener("message",e=>{this._onMessage(e);let{data:t,isGeneric:n}=a7(e);t&&!n&&("response.created"===t.type?this.#Y=!0:"response.done"===t.type&&(this.#Y=!1),"session.created"===t.type&&(this._tracingConfig=t.session.tracing,this._updateTracingConfig(i.tracing??"auto")))});let d=this.options.audioElement??document.createElement("audio");d.autoplay=!0,l.ontrack=e=>{d.srcObject=e.streams[0]};let c=this.options.mediaStream??await navigator.mediaDevices.getUserMedia({audio:!0});l.addTrack(c.getAudioTracks()[0]),this.options.changePeerConnection&&(l=await this.options.changePeerConnection(l),this.#V={...this.#V,peerConnection:l});let p=await l.createOffer();if(await l.setLocalDescription(p),!p.sdp)throw Error("Failed to create offer");let m=await fetch(o,{method:"POST",body:p.sdp,headers:{"Content-Type":"application/sdp",Authorization:`Bearer ${r}`,"X-OpenAI-Agents-SDK":r9["X-OpenAI-Agents-SDK"]}});s=m.headers?.get("Location")?.split("/").pop(),this.#V={...this.#V,callId:s};let h={type:"answer",sdp:await m.text()};await l.setRemoteDescription(h)}catch(e){this.close(),this._onError(e),a(e)}})}sendEvent(e){if(!this.#V.dataChannel||"open"!==this.#V.dataChannel.readyState)throw Error("WebRTC data channel is not connected. Make sure you call `connect()` before sending events.");this.#V.dataChannel.send(JSON.stringify(e))}mute(e){this.#X=e,this.#V.peerConnection&&this.#V.peerConnection.getSenders().forEach(t=>{t.track&&(t.track.enabled=!e)})}close(){if(this.#V.dataChannel&&this.#V.dataChannel.close(),this.#V.peerConnection){let e=this.#V.peerConnection;e.getSenders().forEach(e=>{e.track?.stop()}),e.close()}"disconnected"!==this.#V.status&&(this.#V={status:"disconnected",peerConnection:void 0,dataChannel:void 0,callId:void 0},this.emit("connection_change",this.#V.status),this._onClose())}interrupt(){this.#Y&&(this.sendEvent({type:"response.cancel"}),this.#Y=!1),this.sendEvent({type:"output_audio_buffer.clear"})}}let sn=globalThis.WebSocket;class sr extends se{#q;#K;#V={status:"disconnected",websocket:void 0};#H;#Q;#ee;_firstAudioTimestamp;_audioLengthMs=0;#Y=!1;#et;#en;constructor(e={}){super(e),this.#K=e.url,this.#H=e.useInsecureApiKey??!1,this.#et=e.createWebSocket,this.#en=e.skipOpenEventListeners??!1}getCommonRequestHeaders(){return r9}get status(){return this.#V.status}get connectionState(){return this.#V}get muted(){return null}get currentItemId(){return this.#Q}_onAudio(e){this.emit("audio",e)}async #er(e,t,n){if(this.#V.websocket)return void e();if(!this.#q)throw new td("API key is not set. Please call `connect()` with an API key first.");if(!this.#q.startsWith("ek_")&&!this.#H)throw new td("Using the WebSocket connection in a browser environment requires an ephemeral client key. If you have to use a regular API key, set the `useInsecureApiKey` option to true.");let r=null;if(this.#et)r=await this.#et({url:this.#K,apiKey:this.#q});else{let e=["realtime","openai-insecure-api-key."+this.#q,r4];r=new sn(this.#K,e)}this.#V={status:"connecting",websocket:r},this.emit("connection_change",this.#V.status);let a=()=>{this.#V={status:"connected",websocket:r},this.emit("connection_change",this.#V.status),this._onOpen(),e()};!0===this.#en?a():r.addEventListener("open",a),r.addEventListener("error",e=>{this._onError(e),this.#V={status:"disconnected",websocket:void 0},this.emit("connection_change",this.#V.status),t(e)}),r.addEventListener("message",e=>{this._onMessage(e);let{data:t,isGeneric:r}=a7(e);if(t&&!r)if("response.output_audio.delta"===t.type){this.#ee=t.content_index,this.#Q=t.item_id,void 0===this._firstAudioTimestamp&&(this._firstAudioTimestamp=Date.now(),this._audioLengthMs=0);let e=function(e){let t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return r.buffer}(t.delta),n=this._rawSessionConfig?.audio?.output?.format;if(n&&"object"==typeof n){let t=n.type;if("audio/pcmu"===t||"audio/pcma"===t)this._audioLengthMs+=e.byteLength/8;else if("audio/pcm"===t){let t=n.rate??24e3;this._audioLengthMs+=e.byteLength/2/t*1e3}else this._audioLengthMs+=e.byteLength/24/2}else"string"==typeof n&&n.startsWith("g711_")?this._audioLengthMs+=e.byteLength/8:this._audioLengthMs+=e.byteLength/24/2;let r={type:"audio",data:e,responseId:t.response_id};this._onAudio(r)}else if("input_audio_buffer.speech_started"===t.type){let e=this._rawSessionConfig?.audio?.input?.turn_detection?.interrupt_response??!1;this.interrupt(!e)}else"response.created"===t.type?this.#Y=!0:"response.done"===t.type?this.#Y=!1:"session.created"===t.type&&(this._tracingConfig=t.session.tracing,this._updateTracingConfig(n.tracing??"auto"))}),r.addEventListener("close",()=>{this.#V={status:"disconnected",websocket:void 0},this.emit("connection_change",this.#V.status),this._onClose()})}async connect(e){let t=e.model??this.currentModel;this.currentModel=t,this.#q=await this._getApiKey(e);let n=e.url??this.#K??`wss://api.openai.com/v1/realtime?model=${this.currentModel}`;this.#K=n;let r={...e.initialSessionConfig||{},model:this.currentModel};await new Promise((e,t)=>{this.#er(e,t,r).catch(t)}),await this.updateSessionConfig(r)}sendEvent(e){if(!this.#V.websocket)throw Error("WebSocket is not connected. Make sure you call `connect()` before sending events.");this.#V.websocket.send(JSON.stringify(e))}close(){this.#V.websocket?.close(),this.#Q=void 0,this._firstAudioTimestamp=void 0,this._audioLengthMs=0,this.#ee=void 0}mute(e){throw Error("Mute is not supported for the WebSocket transport. You have to mute the audio input yourself.")}sendAudio(e,t={}){"connected"===this.#V.status&&super.sendAudio(e,t)}_cancelResponse(){this.#Y&&(this.sendEvent({type:"response.cancel"}),this.#Y=!1)}_interrupt(e,t=!0){if(e<0)return;t&&this._cancelResponse();let n=Math.max(0,Math.floor(Math.min(e,this._audioLengthMs??1/0)));this.emit("audio_interrupted"),this.sendEvent({type:"conversation.item.truncate",item_id:this.#Q,content_index:this.#ee,audio_end_ms:n})}interrupt(e=!0){if(!this.#Q||"number"!=typeof this._firstAudioTimestamp)return;let t=Date.now()-this._firstAudioTimestamp;t>=0&&this._interrupt(t,e),this.#Q=void 0,this._firstAudioTimestamp=void 0,this._audioLengthMs=0,this.#ee=void 0}}let sa=Symbol("backgroundResult");function ss(e){return"function"===e.type||"hosted_tool"===e.type&&"hosted_mcp"===e.name}function si(e){if("function"===e.type)return e;if("hosted_tool"===e.type&&"hosted_mcp"===e.name){let t=e.providerData.server_url&&e.providerData.server_url.length>0?e.providerData.server_url:void 0;return{type:"mcp",server_label:e.providerData.server_label,server_url:t,headers:e.providerData.headers,allowed_tools:e.providerData.allowed_tools,require_approval:e.providerData.require_approval}}throw new td(`Invalid tool type: ${e}`)}class so extends tL{initialAgent;options;#ea;#es;#ei;#eo;#el=[];#eu;#ed={};#ec=[];#ep;#em={};#eh=!1;#ef=new Map;#eg=[];#ey=JSON.parse(JSON.stringify(a8));#e_=!0;constructor(e,t={}){super(),this.initialAgent=e,this.options=t,(void 0!==t.transport||("undefined"==typeof window?1:void 0===window.RTCPeerConnection))&&"webrtc"!==t.transport?"websocket"===t.transport||void 0===t.transport?this.#ea=new sr:this.#ea=t.transport:this.#ea=new st,this.#es=e,this.#eo=new nR({...t.context??{},history:this.#ec}),this.#el=(t.outputGuardrails??[]).map(r7),this.#eu={debounceTextLength:(t.outputGuardrailSettings??{}).debounceTextLength??100},this.#ep=t.historyStoreAudio??!1,this.#e_=t.automaticallyTriggerResponseForMcpToolCalls??!0}get transport(){return this.#ea}get currentAgent(){return this.#es}get usage(){return this.#eo.usage}get context(){return this.#eo}get muted(){return this.#ea.muted}get history(){return this.#ec}get availableMcpTools(){return this.#eg}async #ev(e){this.#es=e;let t=await this.#es.getEnabledHandoffs(this.#eo),n=t.map(e=>e.getHandoffAsFunctionTool()),r=(await this.#es.getAllTools(this.#eo)).filter(ss).map(si),a=void 0!==this.#es.tools||void 0!==this.#es.mcpServers,s=t.length>0;this.#ei=a||s?[...r,...n]:void 0,this.#eb()}async #ew(e={}){let t=await this.#es.getSystemPrompt(this.#eo),n=this.options.tracingDisabled?null:this.options.workflowName?{workflow_name:this.options.workflowName}:"auto";null!==n&&"auto"!==n?(this.options.groupId&&(n.group_id=this.options.groupId),this.options.traceMetadata&&(n.metadata=this.options.traceMetadata)):(this.options.groupId||this.options.traceMetadata)&&as.warn("In order to set traceMetadata or a groupId you need to specify a workflowName.");let r={...{...this.#ey??{},...this.options.config??{},...e??{}},instructions:t,voice:this.#es.voice,model:this.options.model,tools:this.#ei,tracing:n,prompt:"function"==typeof this.#es.prompt?await this.#es.prompt(this.#eo,this.#es):this.#es.prompt};return this.#ey=r,r}async updateAgent(e){return this.#es.emit("agent_handoff",this.#eo,e),this.emit("agent_handoff",this.#eo,this.#es,e),await this.#ev(e),await this.#ea.updateSessionConfig(await this.#ew()),e}async #ex(e,t){let n=await t.onInvokeHandoff(this.#eo,e.arguments);this.#es.emit("agent_handoff",this.#eo,n),this.emit("agent_handoff",this.#eo,this.#es,n),await this.#ev(n),await this.#ea.updateSessionConfig(await this.#ew());let r=tX(n);return this.#ea.sendFunctionCallOutput(e,r,!0),n}async #eS(e,t){let n;this.#eo.context.history=JSON.parse(JSON.stringify(this.#ec));let r=e.arguments;if(t.parameters&&(r=tf(t.parameters)?t.parameters.parse(r):JSON.parse(r)),await t.needsApproval(this.#eo,r,e.callId)){let n=this.context.isToolApproved({toolName:t.name,callId:e.callId});if(!1===n){this.emit("agent_tool_start",this.#eo,this.#es,t,{toolCall:e}),this.#es.emit("agent_tool_start",this.#eo,t,{toolCall:e});let n="Tool execution was not approved.";this.#ea.sendFunctionCallOutput(e,n,!0),this.emit("agent_tool_end",this.#eo,this.#es,t,n,{toolCall:e}),this.#es.emit("agent_tool_end",this.#eo,t,n,{toolCall:e});return}if(void 0===n)return void this.emit("tool_approval_requested",this.#eo,this.#es,{type:"function_approval",tool:t,approvalItem:new nU(e,this.#es)})}this.emit("agent_tool_start",this.#eo,this.#es,t,{toolCall:e}),this.#es.emit("agent_tool_start",this.#eo,t,{toolCall:e}),this.#eo.context.history=JSON.parse(JSON.stringify(this.#ec));let a=await t.invoke(this.#eo,e.arguments,{toolCall:e});"object"==typeof a&&null!==a&&sa in a?(n=tR(a.content),this.#ea.sendFunctionCallOutput(e,n,!1)):(n=tR(a),this.#ea.sendFunctionCallOutput(e,n,!0)),this.emit("agent_tool_end",this.#eo,this.#es,t,n,{toolCall:e}),this.#es.emit("agent_tool_end",this.#eo,t,n,{toolCall:e})}async #eI(e){let t=new Map((await this.#es.getEnabledHandoffs(this.#eo)).map(e=>[e.toolName,e])),n=new Map((await this.#es.getAllTools(this.#eo)).map(e=>[e.name,e])),r=t.get(e.name);if(r)await this.#ex(e,r);else{let t=n.get(e.name);if(t&&"function"===t.type)await this.#eS(e,t);else throw new tu(`Tool ${e.name} not found`)}}async #i(e,t,n){if(0===this.#el.length)return;let r={agent:this.#es,agentOutput:e,context:this.#eo},a=(await Promise.all(this.#el.map(e=>e.run(r)))).find(e=>e.output.tripwireTriggered);if(a){if(this.#em[t])return;this.#em[t]=!0;let e=new th(`Output guardrail triggered: ${JSON.stringify(a.output.outputInfo)}`,a);this.emit("guardrail_tripped",this.#eo,this.#es,e,{itemId:n}),this.interrupt();let r=`
 Your last answer was blocked. 
Failed Guardrail Reason: ${a.guardrail.policyHint}. 
Failure Details: ${JSON.stringify(a.output.outputInfo??{})}. 
Please respond again following policy. Apologize for not being able to answer the question (while avoiding the specific reason) and divert discussion back to an approved topic immediately and not invite more discussion.
`.trim();this.sendMessage(r);return}}#ek(){let e;this.#ea.on("*",e=>{if(this.emit("transport_event",e),"conversation.item.input_audio_transcription.completed"===e.type)try{this.#ec=r3(this.#ec,e,this.#ep),this.#eo.context.history=this.#ec,this.emit("history_updated",this.#ec)}catch(e){this.emit("error",{type:"error",error:e})}}),this.#ea.on("mcp_tools_listed",({serverLabel:e,tools:t})=>{try{this.#ef.set(e,t??[]),this.#eb()}catch(e){this.emit("error",{type:"error",error:e})}}),this.#ea.on("audio",e=>{this.#eh||(this.#eh=!0,this.emit("audio_start",this.#eo,this.#es)),this.emit("audio",e)}),this.#ea.on("turn_started",()=>{this.#eh=!1,this.emit("agent_start",this.#eo,this.#es),this.#es.emit("agent_start",this.#eo,this.#es)}),this.#ea.on("turn_done",e=>{let t=e.response.output[e.response.output.length-1],n=function(e){if(null==e||"object"!=typeof e||!("type"in e)||"string"!=typeof e.type||!e.type||"message"!==e.type||!("content"in e)||!Array.isArray(e.content)||e.content.length<1)return;let t=e.content[e.content.length-1];if("type"in t&&"string"==typeof t.type){if("output_text"===t.type)return"string"==typeof t.text?t.text:void 0;if("output_audio"===t.type)return"string"==typeof t.transcript?t.transcript:void 0}}(t)??"",r=t?.id??"";this.emit("agent_end",this.#eo,this.#es,n),this.#es.emit("agent_end",this.#eo,n),this.#i(n,e.response.id,r)}),this.#ea.on("audio_done",()=>{this.#eh&&(this.#eh=!1),this.emit("audio_stopped",this.#eo,this.#es)});let t=0;this.#ea.on("audio_transcript_delta",n=>{try{let r=n.delta,a=n.itemId,s=n.responseId;e!==a&&(e=a,t=0);let i=(this.#ed[a]??"")+r;if(this.#ed[a]=i,this.#eu.debounceTextLength<0)return;let o=Math.floor(i.length/this.#eu.debounceTextLength);o>t&&(t=o,this.#i(i,s,a))}catch(e){this.emit("error",{type:"error",error:e})}}),this.#ea.on("item_update",e=>{try{let t=!this.#ec.some(t=>t.itemId===e.itemId);if(this.#ec=r3(this.#ec,e,this.#ep),this.#eo.context.history=this.#ec,t){let t=this.#ec.find(t=>t.itemId===e.itemId);t&&this.emit("history_added",t)}this.emit("history_updated",this.#ec)}catch(e){this.emit("error",{type:"error",error:e})}}),this.#ea.on("item_deleted",e=>{try{this.#ec=this.#ec.filter(t=>t.itemId!==e.itemId),this.#eo.context.history=this.#ec,this.emit("history_updated",this.#ec)}catch(e){this.emit("error",{type:"error",error:e})}}),this.#ea.on("function_call",async e=>{try{await this.#eI(e)}catch(e){as.error("Error handling function call",e),this.emit("error",{type:"error",error:e})}}),this.#ea.on("usage_update",e=>{this.#eo.usage.add(e)}),this.#ea.on("audio_interrupted",()=>{this.#eh&&(this.#eh=!1),this.emit("audio_interrupted",this.#eo,this.#es)}),this.#ea.on("error",e=>{this.emit("error",e)}),this.#ea.on("mcp_tool_call_completed",e=>{this.emit("mcp_tool_call_completed",this.#eo,this.#es,e),this.#e_&&this.#ea.sendEvent({type:"response.create"})}),this.#ea.on("mcp_approval_request",e=>{this.emit("tool_approval_requested",this.#eo,this.#es,{type:"mcp_approval_request",approvalItem:function(e,t){let{name:n,arguments:r,...a}=t;return new nU({type:"hosted_tool_call",name:n,arguments:JSON.stringify(r),status:"in_progress",providerData:{...a}},e)}(this.#es,e)})})}#eb(){let e=this.#ei?.filter(e=>"mcp"===e.type),t=e=>{let t=e.allowed_tools;if(t){if(Array.isArray(t))return t;if(t&&Array.isArray(t.tool_names))return t.tool_names}},n=new Map;for(let r of e){let e=this.#ef.get(r.server_label)??[],a=t(r);for(let t of e)(!a||a.includes(t.name))&&(n.has(t.name)||n.set(t.name,t))}let r=Array.from(n.values()),a=this.#eg;(a.length!==r.length||JSON.stringify(a.map(e=>e.name).sort())!==JSON.stringify(r.map(e=>e.name).sort()))&&(this.#eg=r,this.emit("mcp_tools_changed",this.#eg))}async connect(e){await this.#ev(this.initialAgent),this.#ek(),await this.#ea.connect({apiKey:e.apiKey??this.options.apiKey,model:this.options.model,url:e.url,initialSessionConfig:await this.#ew(this.options.config)}),this.#ec=[],this.emit("history_updated",this.#ec)}updateHistory(e){let t;t="function"==typeof e?e(this.#ec):e,this.#ea.resetHistory(this.#ec,t)}sendMessage(e,t={}){this.#ea.sendMessage(e,t)}addImage(e,{triggerResponse:t=!0}={}){this.#ea.addImage(e,{triggerResponse:t})}mute(e){this.#ea.mute(e)}close(){this.#em={},this.#ea.close()}sendAudio(e,t={}){this.#ea.sendAudio(e,t)}interrupt(){this.#ea.interrupt()}async approve(e,t={alwaysApprove:!1}){this.#eo.approveTool(e,t);let n=this.#es.tools.find(t=>t.name===e.rawItem.name);if(n&&"function"===n.type&&"function_call"===e.rawItem.type)await this.#eS(e.rawItem,n);else if("hosted_tool_call"===e.rawItem.type){t.alwaysApprove&&as.warn("Always approving MCP tools is not supported. Use the allowed tools configuration instead.");let n=r6(e);this.#ea.sendMcpResponse(n,!0)}else throw new tu(`Tool ${e.rawItem.name} not found`)}async reject(e,t={alwaysReject:!1}){this.#eo.rejectTool(e,t);let n=this.#es.tools.find(t=>t.name===e.rawItem.name);if(n&&"function"===n.type&&"function_call"===e.rawItem.type)await this.#eS(e.rawItem,n);else if("hosted_tool_call"===e.rawItem.type){t.alwaysReject&&as.warn("Always rejecting MCP tools is not supported. Use the allowed tools configuration instead.");let n=r6(e);this.#ea.sendMcpResponse(n,!1)}else throw new tu(`Tool ${e.rawItem.name} not found`)}}},5229:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(1847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5870:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(1847).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5889:(e,t,n)=>{"use strict";n.d(t,{QP:()=>U});let r=(e,t)=>{if(0===e.length)return t.classGroupId;let n=e[0],a=t.nextPart.get(n),s=a?r(e.slice(1),a):void 0;if(s)return s;if(0===t.validators.length)return;let i=e.join("-");return t.validators.find(({validator:e})=>e(i))?.classGroupId},a=/^\[(.+)\]$/,s=(e,t,n,r)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:i(t,e)).classGroupId=n;return}if("function"==typeof e)return o(e)?void s(e(r),t,n,r):void t.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach(([e,a])=>{s(a,i(t,e),n,r)})})},i=(e,t)=>{let n=e;return t.split("-").forEach(e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)}),n},o=e=>e.isThemeGetter,l=(e,t)=>t?e.map(([e,n])=>[e,n.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,n])=>[t+e,n])):e)]):e,u=e=>{if(e.length<=1)return e;let t=[],n=[];return e.forEach(e=>{"["===e[0]?(t.push(...n.sort(),e),n=[]):n.push(e)}),t.push(...n.sort()),t},d=/\s+/;function c(){let e,t,n=0,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=p(e))&&(r&&(r+=" "),r+=t);return r}let p=e=>{let t;if("string"==typeof e)return e;let n="";for(let r=0;r<e.length;r++)e[r]&&(t=p(e[r]))&&(n&&(n+=" "),n+=t);return n},m=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},h=/^\[(?:([a-z-]+):)?(.+)\]$/i,f=/^\d+\/\d+$/,g=new Set(["px","full","screen"]),y=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,_=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,v=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,b=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,w=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,x=e=>I(e)||g.has(e)||f.test(e),S=e=>$(e,"length",F),I=e=>!!e&&!Number.isNaN(Number(e)),k=e=>$(e,"number",I),A=e=>!!e&&Number.isInteger(Number(e)),T=e=>e.endsWith("%")&&I(e.slice(0,-1)),C=e=>h.test(e),E=e=>y.test(e),O=new Set(["length","size","percentage"]),N=e=>$(e,O,L),R=e=>$(e,"position",L),P=new Set(["image","url"]),j=e=>$(e,P,z),M=e=>$(e,"",Z),D=()=>!0,$=(e,t,n)=>{let r=h.exec(e);return!!r&&(r[1]?"string"==typeof t?r[1]===t:t.has(r[1]):n(r[2]))},F=e=>_.test(e)&&!v.test(e),L=()=>!1,Z=e=>b.test(e),z=e=>w.test(e);Symbol.toStringTag;let U=function(e,...t){let n,i,o,p=function(u){let d;return i=(n={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,n=new Map,r=new Map,a=(a,s)=>{n.set(a,s),++t>e&&(t=0,r=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(a(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):a(e,t)}}})((d=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{separator:t,experimentalParseClassName:n}=e,r=1===t.length,a=t[0],s=t.length,i=e=>{let n,i=[],o=0,l=0;for(let u=0;u<e.length;u++){let d=e[u];if(0===o){if(d===a&&(r||e.slice(u,u+s)===t)){i.push(e.slice(l,u)),l=u+s;continue}if("/"===d){n=u;continue}}"["===d?o++:"]"===d&&o--}let u=0===i.length?e:e.substring(l),d=u.startsWith("!"),c=d?u.substring(1):u;return{modifiers:i,hasImportantModifier:d,baseClassName:c,maybePostfixModifierPosition:n&&n>l?n-l:void 0}};return n?e=>n({className:e,parseClassName:i}):i})(d),...(e=>{let t=(e=>{let{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return l(Object.entries(e.classGroups),n).forEach(([e,n])=>{s(n,r,e,t)}),r})(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:e=>{let n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),r(n,t)||(e=>{if(a.test(e)){let t=a.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}})(e)},getConflictingClassGroupIds:(e,t)=>{let r=n[e]||[];return t&&i[e]?[...r,...i[e]]:r}}})(d)}).cache.get,o=n.cache.set,p=m,m(u)};function m(e){let t=i(e);if(t)return t;let r=((e,t)=>{let{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split(d),o="";for(let e=i.length-1;e>=0;e-=1){let t=i[e],{modifiers:l,hasImportantModifier:d,baseClassName:c,maybePostfixModifierPosition:p}=n(t),m=!!p,h=r(m?c.substring(0,p):c);if(!h){if(!m||!(h=r(c))){o=t+(o.length>0?" "+o:o);continue}m=!1}let f=u(l).join(":"),g=d?f+"!":f,y=g+h;if(s.includes(y))continue;s.push(y);let _=a(h,m);for(let e=0;e<_.length;++e){let t=_[e];s.push(g+t)}o=t+(o.length>0?" "+o:o)}return o})(e,n);return o(e,r),r}return function(){return p(c.apply(null,arguments))}}(()=>{let e=m("colors"),t=m("spacing"),n=m("blur"),r=m("brightness"),a=m("borderColor"),s=m("borderRadius"),i=m("borderSpacing"),o=m("borderWidth"),l=m("contrast"),u=m("grayscale"),d=m("hueRotate"),c=m("invert"),p=m("gap"),h=m("gradientColorStops"),f=m("gradientColorStopPositions"),g=m("inset"),y=m("margin"),_=m("opacity"),v=m("padding"),b=m("saturate"),w=m("scale"),O=m("sepia"),P=m("skew"),$=m("space"),F=m("translate"),L=()=>["auto","contain","none"],Z=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",C,t],U=()=>[C,t],J=()=>["",x,S],W=()=>["auto",I,C],q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],B=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",C],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Y=()=>[I,C];return{cacheSize:500,separator:":",theme:{colors:[D],spacing:[x,S],blur:["none","",E,C],brightness:Y(),borderColor:[e],borderRadius:["none","","full",E,C],borderSpacing:U(),borderWidth:J(),contrast:Y(),grayscale:V(),hueRotate:Y(),invert:V(),gap:U(),gradientColorStops:[e],gradientColorStopPositions:[T,S],inset:z(),margin:z(),opacity:Y(),padding:U(),saturate:Y(),scale:Y(),sepia:V(),skew:Y(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",C]}],container:["container"],columns:[{columns:[E]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...q(),C]}],overflow:[{overflow:Z()}],"overflow-x":[{"overflow-x":Z()}],"overflow-y":[{"overflow-y":Z()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",A,C]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",C]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",A,C]}],"grid-cols":[{"grid-cols":[D]}],"col-start-end":[{col:["auto",{span:["full",A,C]},C]}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":[D]}],"row-start-end":[{row:["auto",{span:[A,C]},C]}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",C]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",C]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[$]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[$]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",C,t]}],"min-w":[{"min-w":[C,t,"min","max","fit"]}],"max-w":[{"max-w":[C,t,"none","full","min","max","fit","prose",{screen:[E]},E]}],h:[{h:[C,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[C,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[C,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[C,t,"auto","min","max","fit"]}],"font-size":[{text:["base",E,S]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",k]}],"font-family":[{font:[D]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",C]}],"line-clamp":[{"line-clamp":["none",I,k]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",x,C]}],"list-image":[{"list-image":["none",C]}],"list-style-type":[{list:["none","disc","decimal",C]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",x,S]}],"underline-offset":[{"underline-offset":["auto",x,C]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",C]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",C]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...q(),R]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",N]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},j]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:G()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[x,C]}],"outline-w":[{outline:[x,S]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:J()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[x,S]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",E,M]}],"shadow-color":[{shadow:[D]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...B(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":B()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",E,C]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[c]}],saturate:[{saturate:[b]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[c]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",C]}],duration:[{duration:Y()}],ease:[{ease:["linear","in","out","in-out",C]}],delay:[{delay:Y()}],animate:[{animate:["none","spin","ping","pulse","bounce",C]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[A,C]}],"translate-x":[{"translate-x":[F]}],"translate-y":[{"translate-y":[F]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",C]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",C]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",C]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[x,S,k]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}})},5921:(e,t,n)=>{e.exports=function(e){function t(e){let n,a,s,i=null;function o(...e){if(!o.enabled)return;let r=Number(new Date);o.diff=r-(n||r),o.prev=n,o.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";a++;let s=t.formatters[r];if("function"==typeof s){let t=e[a];n=s.call(o,t),e.splice(a,1),a--}return n}),t.formatArgs.call(o,e),(o.log||t.log).apply(o,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==i?i:(a!==t.namespaces&&(a=t.namespaces,s=t.enabled(e)),s),set:e=>{i=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,n){let r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function a(e,t){let n=0,r=0,a=-1,s=0;for(;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(a=r,s=n):n++,r++;else{if(-1===a)return!1;r=a+1,n=++s}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){for(let n of(t.save(e),t.namespaces=e,t.names=[],t.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===n[0]?t.skips.push(n.slice(1)):t.names.push(n)},t.enabled=function(e){for(let n of t.skips)if(a(e,n))return!1;for(let n of t.names)if(a(e,n))return!0;return!1},t.humanize=n(9135),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},6046:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(0,n(1847).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},7062:(e,t,n)=>{var r=n(5704);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,a=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(a=r))}),t.splice(a,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){let e;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(5921)(t);let{formatters:a}=e.exports;a.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},7129:(e,t,n)=>{"use strict";n.d(t,{DX:()=>i});var r=n(2115);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var s=n(5155),i=r.forwardRef((e,t)=>{let{children:n,...a}=e,i=r.Children.toArray(n),l=i.find(u);if(l){let e=l.props.children,n=i.map(t=>t!==l?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,s.jsx)(o,{...a,ref:t,children:r.isValidElement(e)?r.cloneElement(e,void 0,n):null})}return(0,s.jsx)(o,{...a,ref:t,children:n})});i.displayName="Slot";var o=r.forwardRef((e,t)=>{let{children:n,...s}=e;if(r.isValidElement(n)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(n=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(n);return r.cloneElement(n,{...function(e,t){let n={...t};for(let r in t){let a=e[r],s=t[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...e)=>{s(...e),a(...e)}:a&&(n[r]=a):"style"===r?n[r]={...a,...s}:"className"===r&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...e,...n}}(s,n.props),ref:t?function(...e){return t=>{let n=!1,r=e.map(e=>{let r=a(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():a(e[t],null)}}}}(t,e):e})}return r.Children.count(n)>1?r.Children.only(null):null});o.displayName="SlotClone";var l=({children:e})=>(0,s.jsx)(s.Fragment,{children:e});function u(e){return r.isValidElement(e)&&e.type===l}},7229:(e,t,n)=>{"use strict";n.d(t,{bm:()=>tm,UC:()=>td,VY:()=>tp,hJ:()=>tu,ZL:()=>tl,bL:()=>ti,hE:()=>tc,l9:()=>to});var r,a,s,i=n(2115),o=n.t(i,2);function l(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(e?.(r),!1===n||!r.defaultPrevented)return t?.(r)}}function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function d(...e){return t=>{let n=!1,r=e.map(e=>{let r=u(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():u(e[t],null)}}}}function c(...e){return i.useCallback(d(...e),e)}"undefined"!=typeof window&&window.document&&window.document.createElement;var p=n(5155),m=globalThis?.document?i.useLayoutEffect:()=>{},h=o[" useId ".trim().toString()]||(()=>void 0),f=0;function g(e){let[t,n]=i.useState(h());return m(()=>{e||n(e=>e??String(f++))},[e]),e||(t?`radix-${t}`:"")}var y=o[" useInsertionEffect ".trim().toString()]||m;Symbol("RADIX:SYNC_STATE");var _=n(7650),v=Symbol("radix.slottable");function b(e){return i.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===v}var w=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let n=function(e){let t=function(e){let t=i.forwardRef((e,t)=>{let{children:n,...r}=e;if(i.isValidElement(n)){var a;let e,s,o=(a=n,(s=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(s=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),l=function(e,t){let n={...t};for(let r in t){let a=e[r],s=t[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...e)=>{let t=s(...e);return a(...e),t}:a&&(n[r]=a):"style"===r?n[r]={...a,...s}:"className"===r&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==i.Fragment&&(l.ref=t?d(t,o):o),i.cloneElement(n,l)}return i.Children.count(n)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=i.forwardRef((e,n)=>{let{children:r,...a}=e,s=i.Children.toArray(r),o=s.find(b);if(o){let e=o.props.children,r=s.map(t=>t!==o?t:i.Children.count(e)>1?i.Children.only(null):i.isValidElement(e)?e.props.children:null);return(0,p.jsx)(t,{...a,ref:n,children:i.isValidElement(e)?i.cloneElement(e,void 0,r):null})}return(0,p.jsx)(t,{...a,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}(`Primitive.${t}`),r=i.forwardRef((e,r)=>{let{asChild:a,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,p.jsx)(a?n:t,{...s,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function x(e){let t=i.useRef(e);return i.useEffect(()=>{t.current=e}),i.useMemo(()=>(...e)=>t.current?.(...e),[])}var S="dismissableLayer.update",I=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),k=i.forwardRef((e,t)=>{var n,r;let{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:o,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:m,onDismiss:h,...f}=e,g=i.useContext(I),[y,_]=i.useState(null),v=null!=(r=null==y?void 0:y.ownerDocument)?r:null==(n=globalThis)?void 0:n.document,[,b]=i.useState({}),k=c(t,e=>_(e)),C=Array.from(g.layers),[E]=[...g.layersWithOutsidePointerEventsDisabled].slice(-1),O=C.indexOf(E),N=y?C.indexOf(y):-1,R=g.layersWithOutsidePointerEventsDisabled.size>0,P=N>=O,j=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null==(t=globalThis)?void 0:t.document,r=x(e),a=i.useRef(!1),s=i.useRef(()=>{});return i.useEffect(()=>{let e=e=>{if(e.target&&!a.current){let t=function(){T("dismissableLayer.pointerDownOutside",r,a,{discrete:!0})},a={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",s.current),s.current=t,n.addEventListener("click",s.current,{once:!0})):t()}else n.removeEventListener("click",s.current);a.current=!1},t=window.setTimeout(()=>{n.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",s.current)}},[n,r]),{onPointerDownCapture:()=>a.current=!0}}(e=>{let t=e.target,n=[...g.branches].some(e=>e.contains(t));P&&!n&&(null==u||u(e),null==m||m(e),e.defaultPrevented||null==h||h())},v),M=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null==(t=globalThis)?void 0:t.document,r=x(e),a=i.useRef(!1);return i.useEffect(()=>{let e=e=>{e.target&&!a.current&&T("dismissableLayer.focusOutside",r,{originalEvent:e},{discrete:!1})};return n.addEventListener("focusin",e),()=>n.removeEventListener("focusin",e)},[n,r]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}(e=>{let t=e.target;![...g.branches].some(e=>e.contains(t))&&(null==d||d(e),null==m||m(e),e.defaultPrevented||null==h||h())},v);return!function(e,t=globalThis?.document){let n=x(e);i.useEffect(()=>{let e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[n,t])}(e=>{N===g.layers.size-1&&(null==o||o(e),!e.defaultPrevented&&h&&(e.preventDefault(),h()))},v),i.useEffect(()=>{if(y)return s&&(0===g.layersWithOutsidePointerEventsDisabled.size&&(a=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),g.layersWithOutsidePointerEventsDisabled.add(y)),g.layers.add(y),A(),()=>{s&&1===g.layersWithOutsidePointerEventsDisabled.size&&(v.body.style.pointerEvents=a)}},[y,v,s,g]),i.useEffect(()=>()=>{y&&(g.layers.delete(y),g.layersWithOutsidePointerEventsDisabled.delete(y),A())},[y,g]),i.useEffect(()=>{let e=()=>b({});return document.addEventListener(S,e),()=>document.removeEventListener(S,e)},[]),(0,p.jsx)(w.div,{...f,ref:k,style:{pointerEvents:R?P?"auto":"none":void 0,...e.style},onFocusCapture:l(e.onFocusCapture,M.onFocusCapture),onBlurCapture:l(e.onBlurCapture,M.onBlurCapture),onPointerDownCapture:l(e.onPointerDownCapture,j.onPointerDownCapture)})});function A(){let e=new CustomEvent(S);document.dispatchEvent(e)}function T(e,t,n,r){let{discrete:a}=r,s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});if(t&&s.addEventListener(e,t,{once:!0}),a)s&&_.flushSync(()=>s.dispatchEvent(i));else s.dispatchEvent(i)}k.displayName="DismissableLayer",i.forwardRef((e,t)=>{let n=i.useContext(I),r=i.useRef(null),a=c(t,r);return i.useEffect(()=>{let e=r.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}},[n.branches]),(0,p.jsx)(w.div,{...e,ref:a})}).displayName="DismissableLayerBranch";var C="focusScope.autoFocusOnMount",E="focusScope.autoFocusOnUnmount",O={bubbles:!1,cancelable:!0},N=i.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...o}=e,[l,u]=i.useState(null),d=x(a),m=x(s),h=i.useRef(null),f=c(t,e=>u(e)),g=i.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;i.useEffect(()=>{if(r){let e=function(e){if(g.paused||!l)return;let t=e.target;l.contains(t)?h.current=t:j(h.current,{select:!0})},t=function(e){if(g.paused||!l)return;let t=e.relatedTarget;null!==t&&(l.contains(t)||j(h.current,{select:!0}))};document.addEventListener("focusin",e),document.addEventListener("focusout",t);let n=new MutationObserver(function(e){if(document.activeElement===document.body)for(let t of e)t.removedNodes.length>0&&j(l)});return l&&n.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),n.disconnect()}}},[r,l,g.paused]),i.useEffect(()=>{if(l){M.add(g);let e=document.activeElement;if(!l.contains(e)){let t=new CustomEvent(C,O);l.addEventListener(C,d),l.dispatchEvent(t),t.defaultPrevented||(function(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.activeElement;for(let r of e)if(j(r,{select:t}),document.activeElement!==n)return}(R(l).filter(e=>"A"!==e.tagName),{select:!0}),document.activeElement===e&&j(l))}return()=>{l.removeEventListener(C,d),setTimeout(()=>{let t=new CustomEvent(E,O);l.addEventListener(E,m),l.dispatchEvent(t),t.defaultPrevented||j(null!=e?e:document.body,{select:!0}),l.removeEventListener(E,m),M.remove(g)},0)}}},[l,d,m,g]);let y=i.useCallback(e=>{if(!n&&!r||g.paused)return;let t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,a=document.activeElement;if(t&&a){let t=e.currentTarget,[r,s]=function(e){let t=R(e);return[P(t,e),P(t.reverse(),e)]}(t);r&&s?e.shiftKey||a!==s?e.shiftKey&&a===r&&(e.preventDefault(),n&&j(s,{select:!0})):(e.preventDefault(),n&&j(r,{select:!0})):a===t&&e.preventDefault()}},[n,r,g.paused]);return(0,p.jsx)(w.div,{tabIndex:-1,...o,ref:f,onKeyDown:y})});function R(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function P(e,t){for(let n of e)if(!function(e,t){let{upTo:n}=t;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e&&(void 0===n||e!==n);){if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}(n,{upTo:t}))return n}function j(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.focus){var n;let r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&(n=e)instanceof HTMLInputElement&&"select"in n&&t&&e.select()}}N.displayName="FocusScope";var M=function(){let e=[];return{add(t){let n=e[0];t!==n&&(null==n||n.pause()),(e=D(e,t)).unshift(t)},remove(t){var n;null==(n=(e=D(e,t))[0])||n.resume()}}}();function D(e,t){let n=[...e],r=n.indexOf(t);return -1!==r&&n.splice(r,1),n}var $=i.forwardRef((e,t)=>{var n,r;let{container:a,...s}=e,[o,l]=i.useState(!1);m(()=>l(!0),[]);let u=a||o&&(null==(r=globalThis)||null==(n=r.document)?void 0:n.body);return u?_.createPortal((0,p.jsx)(w.div,{...s,ref:t}),u):null});$.displayName="Portal";var F=e=>{let{present:t,children:n}=e,r=function(e){var t,n;let[r,a]=i.useState(),s=i.useRef(null),o=i.useRef(e),l=i.useRef("none"),[u,d]=(t=e?"mounted":"unmounted",n={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},i.useReducer((e,t)=>{let r=n[e][t];return null!=r?r:e},t));return i.useEffect(()=>{let e=L(s.current);l.current="mounted"===u?e:"none"},[u]),m(()=>{let t=s.current,n=o.current;if(n!==e){let r=l.current,a=L(t);e?d("MOUNT"):"none"===a||(null==t?void 0:t.display)==="none"?d("UNMOUNT"):n&&r!==a?d("ANIMATION_OUT"):d("UNMOUNT"),o.current=e}},[e,d]),m(()=>{if(r){var e;let t,n=null!=(e=r.ownerDocument.defaultView)?e:window,a=e=>{let a=L(s.current).includes(CSS.escape(e.animationName));if(e.target===r&&a&&(d("ANIMATION_END"),!o.current)){let e=r.style.animationFillMode;r.style.animationFillMode="forwards",t=n.setTimeout(()=>{"forwards"===r.style.animationFillMode&&(r.style.animationFillMode=e)})}},i=e=>{e.target===r&&(l.current=L(s.current))};return r.addEventListener("animationstart",i),r.addEventListener("animationcancel",a),r.addEventListener("animationend",a),()=>{n.clearTimeout(t),r.removeEventListener("animationstart",i),r.removeEventListener("animationcancel",a),r.removeEventListener("animationend",a)}}d("ANIMATION_END")},[r,d]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(e=>{s.current=e?getComputedStyle(e):null,a(e)},[])}}(t),a="function"==typeof n?n({present:r.isPresent}):i.Children.only(n),s=c(r.ref,function(e){var t,n;let r=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?e.ref:(a=(r=null==(n=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:n.get)&&"isReactWarning"in r&&r.isReactWarning)?e.props.ref:e.props.ref||e.ref}(a));return"function"==typeof n||r.isPresent?i.cloneElement(a,{ref:s}):null};function L(e){return(null==e?void 0:e.animationName)||"none"}F.displayName="Presence";var Z=0;function z(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var U=function(){return(U=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function J(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)0>t.indexOf(r[a])&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}Object.create;Object.create;var W=("function"==typeof SuppressedError&&SuppressedError,"right-scroll-bar-position"),q="width-before-scroll-bar";function G(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var B="undefined"!=typeof window?i.useLayoutEffect:i.useEffect,K=new WeakMap;function V(e){return e}var H=function(e){void 0===e&&(e={});var t,n,r,a=(void 0===t&&(t=V),n=[],r=!1,{read:function(){if(r)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:null},useMedium:function(e){var a=t(e,r);return n.push(a),function(){n=n.filter(function(e){return e!==a})}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var a=n;n=[],a.forEach(e),t=n}var s=function(){var n=t;t=[],n.forEach(e)},i=function(){return Promise.resolve().then(s)};i(),n={push:function(e){t.push(e),i()},filter:function(e){return t=t.filter(e),n}}}});return a.options=U({async:!0,ssr:!1},e),a}(),Y=function(){},X=i.forwardRef(function(e,t){var n,r,a,s,o=i.useRef(null),l=i.useState({onScrollCapture:Y,onWheelCapture:Y,onTouchMoveCapture:Y}),u=l[0],d=l[1],c=e.forwardProps,p=e.children,m=e.className,h=e.removeScrollBar,f=e.enabled,g=e.shards,y=e.sideCar,_=e.noRelative,v=e.noIsolation,b=e.inert,w=e.allowPinchZoom,x=e.as,S=e.gapMode,I=J(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=(n=[o,t],r=function(e){return n.forEach(function(t){return G(t,e)})},(a=(0,i.useState)(function(){return{value:null,callback:r,facade:{get current(){return a.value},set current(value){var e=a.value;e!==value&&(a.value=value,a.callback(value,e))}}}})[0]).callback=r,s=a.facade,B(function(){var e=K.get(s);if(e){var t=new Set(e),r=new Set(n),a=s.current;t.forEach(function(e){r.has(e)||G(e,null)}),r.forEach(function(e){t.has(e)||G(e,a)})}K.set(s,n)},[n]),s),A=U(U({},I),u);return i.createElement(i.Fragment,null,f&&i.createElement(y,{sideCar:H,removeScrollBar:h,shards:g,noRelative:_,noIsolation:v,inert:b,setCallbacks:d,allowPinchZoom:!!w,lockRef:o,gapMode:S}),c?i.cloneElement(i.Children.only(p),U(U({},A),{ref:k})):i.createElement(void 0===x?"div":x,U({},A,{className:m,ref:k}),p))});X.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},X.classNames={fullWidth:q,zeroRight:W};var Q=function(e){var t=e.sideCar,n=J(e,["sideCar"]);if(!t)throw Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw Error("Sidecar medium not found");return i.createElement(r,U({},n))};Q.isSideCarExport=!0;var ee=function(){var e=0,t=null;return{add:function(r){if(0==e&&(t=function(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=s||n.nc;return t&&e.setAttribute("nonce",t),e}())){var a,i;(a=t).styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r)),i=t,(document.head||document.getElementsByTagName("head")[0]).appendChild(i)}e++},remove:function(){--e||!t||(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},et=function(){var e=ee();return function(t,n){i.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},en=function(){var e=et();return function(t){return e(t.styles,t.dynamic),null}},er={left:0,top:0,right:0,gap:0},ea=function(e){return parseInt(e||"",10)||0},es=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],a=t["padding"===e?"paddingRight":"marginRight"];return[ea(n),ea(r),ea(a)]},ei=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return er;var t=es(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},eo=en(),el="data-scroll-locked",eu=function(e,t,n,r){var a=e.left,s=e.top,i=e.right,o=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(o,"px ").concat(r,";\n  }\n  body[").concat(el,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(a,"px;\n    padding-top: ").concat(s,"px;\n    padding-right: ").concat(i,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(W," {\n    right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(q," {\n    margin-right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(W," .").concat(W," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(q," .").concat(q," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(el,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},ed=function(){var e=parseInt(document.body.getAttribute(el)||"0",10);return isFinite(e)?e:0},ec=function(){i.useEffect(function(){return document.body.setAttribute(el,(ed()+1).toString()),function(){var e=ed()-1;e<=0?document.body.removeAttribute(el):document.body.setAttribute(el,e.toString())}},[])},ep=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=void 0===r?"margin":r;ec();var s=i.useMemo(function(){return ei(a)},[a]);return i.createElement(eo,{styles:eu(s,!t,a,n?"":"!important")})},em=!1;if("undefined"!=typeof window)try{var eh=Object.defineProperty({},"passive",{get:function(){return em=!0,!0}});window.addEventListener("test",eh,eh),window.removeEventListener("test",eh,eh)}catch(e){em=!1}var ef=!!em&&{passive:!1},eg=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&(n.overflowY!==n.overflowX||"TEXTAREA"===e.tagName||"visible"!==n[t])},ey=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),e_(e,r)){var a=ev(e,r);if(a[1]>a[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},e_=function(e,t){return"v"===e?eg(t,"overflowY"):eg(t,"overflowX")},ev=function(e,t){return"v"===e?[t.scrollTop,t.scrollHeight,t.clientHeight]:[t.scrollLeft,t.scrollWidth,t.clientWidth]},eb=function(e,t,n,r,a){var s,i=(s=window.getComputedStyle(t).direction,"h"===e&&"rtl"===s?-1:1),o=i*r,l=n.target,u=t.contains(l),d=!1,c=o>0,p=0,m=0;do{if(!l)break;var h=ev(e,l),f=h[0],g=h[1]-h[2]-i*f;(f||g)&&e_(e,l)&&(p+=g,m+=f);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&l!==document.body||u&&(t.contains(l)||t===l));return c&&(a&&1>Math.abs(p)||!a&&o>p)?d=!0:!c&&(a&&1>Math.abs(m)||!a&&-o>m)&&(d=!0),d},ew=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ex=function(e){return[e.deltaX,e.deltaY]},eS=function(e){return e&&"current"in e?e.current:e},eI=0,ek=[];let eA=(r=function(e){var t=i.useRef([]),n=i.useRef([0,0]),r=i.useRef(),a=i.useState(eI++)[0],s=i.useState(en)[0],o=i.useRef(e);i.useEffect(function(){o.current=e},[e]),i.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var t=(function(e,t,n){if(n||2==arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))})([e.lockRef.current],(e.shards||[]).map(eS),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=i.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var a,s=ew(e),i=n.current,l="deltaX"in e?e.deltaX:i[0]-s[0],u="deltaY"in e?e.deltaY:i[1]-s[1],d=e.target,c=Math.abs(l)>Math.abs(u)?"h":"v";if("touches"in e&&"h"===c&&"range"===d.type)return!1;var p=ey(c,d);if(!p)return!0;if(p?a=c:(a="v"===c?"h":"v",p=ey(c,d)),!p)return!1;if(!r.current&&"changedTouches"in e&&(l||u)&&(r.current=a),!a)return!0;var m=r.current||a;return eb(m,t,e,"h"===m?l:u,!0)},[]),u=i.useCallback(function(e){if(ek.length&&ek[ek.length-1]===s){var n="deltaY"in e?ex(e):ew(e),r=t.current.filter(function(t){var r;return t.name===e.type&&(t.target===e.target||e.target===t.shadowParent)&&(r=t.delta,r[0]===n[0]&&r[1]===n[1])})[0];if(r&&r.should){e.cancelable&&e.preventDefault();return}if(!r){var a=(o.current.shards||[]).map(eS).filter(Boolean).filter(function(t){return t.contains(e.target)});(a.length>0?l(e,a[0]):!o.current.noIsolation)&&e.cancelable&&e.preventDefault()}}},[]),d=i.useCallback(function(e,n,r,a){var s={name:e,delta:n,target:r,should:a,shadowParent:function(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}(r)};t.current.push(s),setTimeout(function(){t.current=t.current.filter(function(e){return e!==s})},1)},[]),c=i.useCallback(function(e){n.current=ew(e),r.current=void 0},[]),p=i.useCallback(function(t){d(t.type,ex(t),t.target,l(t,e.lockRef.current))},[]),m=i.useCallback(function(t){d(t.type,ew(t),t.target,l(t,e.lockRef.current))},[]);i.useEffect(function(){return ek.push(s),e.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:m}),document.addEventListener("wheel",u,ef),document.addEventListener("touchmove",u,ef),document.addEventListener("touchstart",c,ef),function(){ek=ek.filter(function(e){return e!==s}),document.removeEventListener("wheel",u,ef),document.removeEventListener("touchmove",u,ef),document.removeEventListener("touchstart",c,ef)}},[]);var h=e.removeScrollBar,f=e.inert;return i.createElement(i.Fragment,null,f?i.createElement(s,{styles:"\n  .block-interactivity-".concat(a," {pointer-events: none;}\n  .allow-interactivity-").concat(a," {pointer-events: all;}\n")}):null,h?i.createElement(ep,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},H.useMedium(r),Q);var eT=i.forwardRef(function(e,t){return i.createElement(X,U({},e,{ref:t,sideCar:eA}))});eT.classNames=X.classNames;var eC=new WeakMap,eE=new WeakMap,eO={},eN=0,eR=function(e){return e&&(e.host||eR(e.parentNode))},eP=function(e,t,n,r){var a=(Array.isArray(e)?e:[e]).map(function(e){if(t.contains(e))return e;var n=eR(e);return n&&t.contains(n)?n:(console.error("aria-hidden",e,"in not contained inside",t,". Doing nothing"),null)}).filter(function(e){return!!e});eO[n]||(eO[n]=new WeakMap);var s=eO[n],i=[],o=new Set,l=new Set(a),u=function(e){!e||o.has(e)||(o.add(e),u(e.parentNode))};a.forEach(u);var d=function(e){!e||l.has(e)||Array.prototype.forEach.call(e.children,function(e){if(o.has(e))d(e);else try{var t=e.getAttribute(r),a=null!==t&&"false"!==t,l=(eC.get(e)||0)+1,u=(s.get(e)||0)+1;eC.set(e,l),s.set(e,u),i.push(e),1===l&&a&&eE.set(e,!0),1===u&&e.setAttribute(n,"true"),a||e.setAttribute(r,"true")}catch(t){console.error("aria-hidden: cannot operate on ",e,t)}})};return d(t),o.clear(),eN++,function(){i.forEach(function(e){var t=eC.get(e)-1,a=s.get(e)-1;eC.set(e,t),s.set(e,a),t||(eE.has(e)||e.removeAttribute(r),eE.delete(e)),a||e.removeAttribute(n)}),--eN||(eC=new WeakMap,eC=new WeakMap,eE=new WeakMap,eO={})}},ej=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=t||("undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),eP(r,a,n,"aria-hidden")):function(){return null}},eM=Symbol("radix.slottable");function eD(e){return i.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===eM}var e$="Dialog",[eF,eL]=function(e,t=[]){let n=[],r=()=>{let t=n.map(e=>i.createContext(e));return function(n){let r=n?.[e]||t;return i.useMemo(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return r.scopeName=e,[function(t,r){let a=i.createContext(r),s=n.length;n=[...n,r];let o=t=>{let{scope:n,children:r,...o}=t,l=n?.[e]?.[s]||a,u=i.useMemo(()=>o,Object.values(o));return(0,p.jsx)(l.Provider,{value:u,children:r})};return o.displayName=t+"Provider",[o,function(n,o){let l=o?.[e]?.[s]||a,u=i.useContext(l);if(u)return u;if(void 0!==r)return r;throw Error(`\`${n}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let n=()=>{let n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=n.reduce((t,{useScope:n,scopeName:r})=>{let a=n(e)[`__scope${r}`];return{...t,...a}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}(r,...t)]}(e$),[eZ,ez]=eF(e$),eU=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:s,modal:o=!0}=e,l=i.useRef(null),u=i.useRef(null),[d,c]=function({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){let[a,s,o]=function({defaultProp:e,onChange:t}){let[n,r]=i.useState(e),a=i.useRef(n),s=i.useRef(t);return y(()=>{s.current=t},[t]),i.useEffect(()=>{a.current!==n&&(s.current?.(n),a.current=n)},[n,a]),[n,r,s]}({defaultProp:t,onChange:n}),l=void 0!==e,u=l?e:a;{let t=i.useRef(void 0!==e);i.useEffect(()=>{let e=t.current;if(e!==l){let t=l?"controlled":"uncontrolled";console.warn(`${r} is changing from ${e?"controlled":"uncontrolled"} to ${t}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=l},[l,r])}return[u,i.useCallback(t=>{if(l){let n="function"==typeof t?t(e):t;n!==e&&o.current?.(n)}else s(t)},[l,e,s,o])]}({prop:r,defaultProp:null!=a&&a,onChange:s,caller:e$});return(0,p.jsx)(eZ,{scope:t,triggerRef:l,contentRef:u,contentId:g(),titleId:g(),descriptionId:g(),open:d,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(e=>!e),[c]),modal:o,children:n})};eU.displayName=e$;var eJ="DialogTrigger",eW=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=ez(eJ,n),s=c(t,a.triggerRef);return(0,p.jsx)(w.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":te(a.open),...r,ref:s,onClick:l(e.onClick,a.onOpenToggle)})});eW.displayName=eJ;var eq="DialogPortal",[eG,eB]=eF(eq,{forceMount:void 0}),eK=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:a}=e,s=ez(eq,t);return(0,p.jsx)(eG,{scope:t,forceMount:n,children:i.Children.map(r,e=>(0,p.jsx)(F,{present:n||s.open,children:(0,p.jsx)($,{asChild:!0,container:a,children:e})}))})};eK.displayName=eq;var eV="DialogOverlay",eH=i.forwardRef((e,t)=>{let n=eB(eV,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,s=ez(eV,e.__scopeDialog);return s.modal?(0,p.jsx)(F,{present:r||s.open,children:(0,p.jsx)(eX,{...a,ref:t})}):null});eH.displayName=eV;var eY=function(e){let t=function(e){let t=i.forwardRef((e,t)=>{let{children:n,...r}=e;if(i.isValidElement(n)){var a;let e,s,o=(a=n,(s=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(s=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),l=function(e,t){let n={...t};for(let r in t){let a=e[r],s=t[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...e)=>{let t=s(...e);return a(...e),t}:a&&(n[r]=a):"style"===r?n[r]={...a,...s}:"className"===r&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==i.Fragment&&(l.ref=t?d(t,o):o),i.cloneElement(n,l)}return i.Children.count(n)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=i.forwardRef((e,n)=>{let{children:r,...a}=e,s=i.Children.toArray(r),o=s.find(eD);if(o){let e=o.props.children,r=s.map(t=>t!==o?t:i.Children.count(e)>1?i.Children.only(null):i.isValidElement(e)?e.props.children:null);return(0,p.jsx)(t,{...a,ref:n,children:i.isValidElement(e)?i.cloneElement(e,void 0,r):null})}return(0,p.jsx)(t,{...a,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}("DialogOverlay.RemoveScroll"),eX=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=ez(eV,n);return(0,p.jsx)(eT,{as:eY,allowPinchZoom:!0,shards:[a.contentRef],children:(0,p.jsx)(w.div,{"data-state":te(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),eQ="DialogContent",e0=i.forwardRef((e,t)=>{let n=eB(eQ,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,s=ez(eQ,e.__scopeDialog);return(0,p.jsx)(F,{present:r||s.open,children:s.modal?(0,p.jsx)(e1,{...a,ref:t}):(0,p.jsx)(e2,{...a,ref:t})})});e0.displayName=eQ;var e1=i.forwardRef((e,t)=>{let n=ez(eQ,e.__scopeDialog),r=i.useRef(null),a=c(t,n.contentRef,r);return i.useEffect(()=>{let e=r.current;if(e)return ej(e)},[]),(0,p.jsx)(e3,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:l(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null==(t=n.triggerRef.current)||t.focus()}),onPointerDownOutside:l(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:l(e.onFocusOutside,e=>e.preventDefault())})}),e2=i.forwardRef((e,t)=>{let n=ez(eQ,e.__scopeDialog),r=i.useRef(!1),a=i.useRef(!1);return(0,p.jsx)(e3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var s,i;null==(s=e.onCloseAutoFocus)||s.call(e,t),t.defaultPrevented||(r.current||null==(i=n.triggerRef.current)||i.focus(),t.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:t=>{var s,i;null==(s=e.onInteractOutside)||s.call(e,t),t.defaultPrevented||(r.current=!0,"pointerdown"===t.detail.originalEvent.type&&(a.current=!0));let o=t.target;(null==(i=n.triggerRef.current)?void 0:i.contains(o))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),e3=i.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:s,...o}=e,l=ez(eQ,n),u=i.useRef(null),d=c(t,u);return i.useEffect(()=>{var e,t;let n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!=(e=n[0])?e:z()),document.body.insertAdjacentElement("beforeend",null!=(t=n[1])?t:z()),Z++,()=>{1===Z&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Z--}},[]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(N,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:s,children:(0,p.jsx)(k,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":te(l.open),...o,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ta,{titleId:l.titleId}),(0,p.jsx)(ts,{contentRef:u,descriptionId:l.descriptionId})]})]})}),e9="DialogTitle",e4=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=ez(e9,n);return(0,p.jsx)(w.h2,{id:a.titleId,...r,ref:t})});e4.displayName=e9;var e6="DialogDescription",e5=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=ez(e6,n);return(0,p.jsx)(w.p,{id:a.descriptionId,...r,ref:t})});e5.displayName=e6;var e7="DialogClose",e8=i.forwardRef((e,t)=>{let{__scopeDialog:n,...r}=e,a=ez(e7,n);return(0,p.jsx)(w.button,{type:"button",...r,ref:t,onClick:l(e.onClick,()=>a.onOpenChange(!1))})});function te(e){return e?"open":"closed"}e8.displayName=e7;var tt="DialogTitleWarning",[tn,tr]=function(e,t){let n=i.createContext(t),r=e=>{let{children:t,...r}=e,a=i.useMemo(()=>r,Object.values(r));return(0,p.jsx)(n.Provider,{value:a,children:t})};return r.displayName=e+"Provider",[r,function(r){let a=i.useContext(n);if(a)return a;if(void 0!==t)return t;throw Error(`\`${r}\` must be used within \`${e}\``)}]}(tt,{contentName:eQ,titleName:e9,docsSlug:"dialog"}),ta=e=>{let{titleId:t}=e,n=tr(tt),r="`".concat(n.contentName,"` requires a `").concat(n.titleName,"` for the component to be accessible for screen reader users.\n\nIf you want to hide the `").concat(n.titleName,"`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/").concat(n.docsSlug);return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},ts=e=>{let{contentRef:t,descriptionId:n}=e,r=tr("DialogDescriptionWarning"),a="Warning: Missing `Description` or `aria-describedby={undefined}` for {".concat(r.contentName,"}.");return i.useEffect(()=>{var e;let r=null==(e=t.current)?void 0:e.getAttribute("aria-describedby");n&&r&&(document.getElementById(n)||console.warn(a))},[a,t,n]),null},ti=eU,to=eW,tl=eK,tu=eH,td=e0,tc=e4,tp=e5,tm=e8},9135:e=>{function t(e,t,n,r){return Math.round(e/n)+" "+r+(t>=1.5*n?"s":"")}e.exports=function(e,n){n=n||{};var r,a,s,i,o=typeof e;if("string"===o&&e.length>0){var l=e;if(!((l=String(l)).length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(u){var d=parseFloat(u[1]);switch((u[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*d;case"weeks":case"week":case"w":return 6048e5*d;case"days":case"day":case"d":return 864e5*d;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*d;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*d;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:break}}}return}if("number"===o&&isFinite(e)){return n.long?(a=Math.abs(r=e))>=864e5?t(r,a,864e5,"day"):a>=36e5?t(r,a,36e5,"hour"):a>=6e4?t(r,a,6e4,"minute"):a>=1e3?t(r,a,1e3,"second"):r+" ms":(i=Math.abs(s=e))>=864e5?Math.round(s/864e5)+"d":i>=36e5?Math.round(s/36e5)+"h":i>=6e4?Math.round(s/6e4)+"m":i>=1e3?Math.round(s/1e3)+"s":s+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}]);